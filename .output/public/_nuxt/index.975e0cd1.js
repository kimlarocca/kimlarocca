import{_ as nn,o as Ke,c as st,l as Ko,a as Te,s as kn,q as Gn,t as Bs,f as vt,x as Qh,y as zu,d as ef,j as uo,z as ho,A as Qt,g as pt,T as ks,F as Dr,p as Uu,h as rc}from"./entry.1354bbce.js";Number.EPSILON===void 0&&(Number.EPSILON=Math.pow(2,-52));Number.isInteger===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e});Math.sign===void 0&&(Math.sign=function(e){return e<0?-1:e>0?1:+e});"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}});Object.assign===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!=null)for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}return t});var tf="113",nf=0,ac=1,rf=2,Gu=1,af=2,Pr=3,wa=0,mt=1,Qo=2,Vu=1,Hu=0,of=1,ba=2,Hn=0,Or=1,oc=2,sc=3,lc=4,sf=5,Hi=100,lf=101,cf=102,cc=103,uc=104,uf=200,hf=201,ff=202,df=203,Wu=204,ju=205,pf=206,mf=207,vf=208,gf=209,yf=210,xf=0,_f=1,wf=2,zs=3,bf=4,Mf=5,Sf=6,Ef=7,es=0,Tf=1,Af=2,lo=0,Bl=1,Lf=2,Cf=3,Rf=4,Pf=5,kl=300,zl=301,Ul=302,qu=303,Gl=304,Xu=305,Ma=306,Vl=307,fo=1e3,Ct=1001,po=1002,ht=1003,Us=1004,Gs=1005,gt=1006,Yu=1007,ts=1008,ns=1009,If=1010,Df=1011,mo=1012,Of=1013,Zu=1014,kr=1015,Hl=1016,Nf=1017,Ff=1018,Bf=1019,vo=1020,kf=1021,mi=1022,hn=1023,zf=1024,Uf=1025,Gf=hn,Ji=1026,zr=1027,Vf=1028,Hf=1029,Wf=1030,jf=1031,qf=1032,Xf=1033,hc=33776,fc=33777,dc=33778,pc=33779,mc=35840,vc=35841,gc=35842,yc=35843,Yf=36196,Zf=37808,Jf=37809,$f=37810,Kf=37811,Qf=37812,ed=37813,td=37814,nd=37815,id=37816,rd=37817,ad=37818,od=37819,sd=37820,ld=37821,cd=2200,ud=2201,hd=2202,go=2300,co=2301,ss=2302,Ki=2400,ji=2401,yo=2402,fd=0,Ft=3e3,Wl=3001,Ju=3007,jl=3002,dd=3003,$u=3004,Ku=3005,Qu=3006,pd=3200,md=3201,gr=0,vd=1,ls=7680,gd=519,is=35044,Ur=35048;function In(){}Object.assign(In.prototype,{addEventListener:function(e,t){this._listeners===void 0&&(this._listeners={});var n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)},hasEventListener:function(e,t){if(this._listeners===void 0)return!1;var n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1},removeEventListener:function(e,t){if(this._listeners!==void 0){var n=this._listeners,i=n[e];if(i!==void 0){var r=i.indexOf(t);r!==-1&&i.splice(r,1)}}},dispatchEvent:function(e){if(this._listeners!==void 0){var t=this._listeners,n=t[e.type];if(n!==void 0){e.target=this;for(var i=n.slice(0),r=0,a=i.length;r<a;r++)i[r].call(this,e)}}}});var yt=[];for(var wr=0;wr<256;wr++)yt[wr]=(wr<16?"0":"")+wr.toString(16);var Le={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0,r=yt[e&255]+yt[e>>8&255]+yt[e>>16&255]+yt[e>>24&255]+"-"+yt[t&255]+yt[t>>8&255]+"-"+yt[t>>16&15|64]+yt[t>>24&255]+"-"+yt[n&63|128]+yt[n>>8&255]+"-"+yt[n>>16&255]+yt[n>>24&255]+yt[i&255]+yt[i>>8&255]+yt[i>>16&255]+yt[i>>24&255];return r.toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,i,r){return i+(e-t)*(r-i)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*(3-2*e))},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t),e*e*e*(e*(e*6-15)+10))},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Le.DEG2RAD},radToDeg:function(e){return e*Le.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,i,r){var a=Math.cos,o=Math.sin,s=a(n/2),l=o(n/2),c=a((t+i)/2),u=o((t+i)/2),h=a((t-i)/2),f=o((t-i)/2),d=a((i-t)/2),p=o((i-t)/2);r==="XYX"?e.set(s*u,l*h,l*f,s*c):r==="YZY"?e.set(l*f,s*u,l*h,s*c):r==="ZXZ"?e.set(l*h,l*f,s*u,s*c):r==="XZX"?e.set(s*u,l*p,l*d,s*c):r==="YXY"?e.set(l*d,s*u,l*p,s*c):r==="ZYZ"?e.set(l*p,l*d,s*u,s*c):console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function U(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(U.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}});Object.assign(U.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=this.x-e.x,a=this.y-e.y;return this.x=r*n-a*i+e.x,this.y=r*i+a*n+e.y,this}});function bt(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.assign(bt.prototype,{isMatrix3:!0,set:function(e,t,n,i,r,a,o,s,l){var c=this.elements;return c[0]=e,c[1]=i,c[2]=o,c[3]=t,c[4]=r,c[5]=s,c[6]=n,c[7]=a,c[8]=l,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[3],s=n[6],l=n[1],c=n[4],u=n[7],h=n[2],f=n[5],d=n[8],p=i[0],m=i[3],v=i[6],y=i[1],x=i[4],w=i[7],S=i[2],b=i[5],A=i[8];return r[0]=a*p+o*y+s*S,r[3]=a*m+o*x+s*b,r[6]=a*v+o*w+s*A,r[1]=l*p+c*y+u*S,r[4]=l*m+c*x+u*b,r[7]=l*v+c*w+u*A,r[2]=h*p+f*y+d*S,r[5]=h*m+f*x+d*b,r[8]=h*v+f*w+d*A,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*a*c-t*o*l-n*r*c+n*o*s+i*r*l-i*a*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,i=this.elements,r=n[0],a=n[1],o=n[2],s=n[3],l=n[4],c=n[5],u=n[6],h=n[7],f=n[8],d=f*l-c*h,p=c*u-f*s,m=h*s-l*u,v=r*d+a*p+o*m;if(v===0){var y="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(y);return console.warn(y),this.identity()}var x=1/v;return i[0]=d*x,i[1]=(o*h-f*a)*x,i[2]=(c*a-o*l)*x,i[3]=p*x,i[4]=(f*r-o*u)*x,i[5]=(o*s-c*r)*x,i[6]=m*x,i[7]=(a*u-h*r)*x,i[8]=(l*r-a*s)*x,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,i,r,a,o){var s=Math.cos(r),l=Math.sin(r);this.set(n*s,n*l,-n*(s*a+l*o)+a+e,-i*l,i*s,-i*(-l*a+s*o)+o+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),i=this.elements,r=i[0],a=i[3],o=i[6],s=i[1],l=i[4],c=i[7];return i[0]=t*r+n*s,i[3]=t*a+n*l,i[6]=t*o+n*c,i[1]=-n*r+t*s,i[4]=-n*a+t*l,i[7]=-n*o+t*c,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var Ei,Xn={getDataURL:function(e){var t;if(typeof HTMLCanvasElement>"u")return e.src;if(e instanceof HTMLCanvasElement)t=e;else{Ei===void 0&&(Ei=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ei.width=e.width,Ei.height=e.height;var n=Ei.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=Ei}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},yd=0;function Je(e,t,n,i,r,a,o,s,l,c){Object.defineProperty(this,"id",{value:yd++}),this.uuid=Le.generateUUID(),this.name="",this.image=e!==void 0?e:Je.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=t!==void 0?t:Je.DEFAULT_MAPPING,this.wrapS=n!==void 0?n:Ct,this.wrapT=i!==void 0?i:Ct,this.magFilter=r!==void 0?r:gt,this.minFilter=a!==void 0?a:ts,this.anisotropy=l!==void 0?l:1,this.format=o!==void 0?o:hn,this.internalFormat=null,this.type=s!==void 0?s:ns,this.offset=new U(0,0),this.repeat=new U(1,1),this.center=new U(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new bt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=c!==void 0?c:Ft,this.version=0,this.onUpdate=null}Je.DEFAULT_IMAGE=void 0;Je.DEFAULT_MAPPING=kl;Je.prototype=Object.assign(Object.create(In.prototype),{constructor:Je,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var i=this.image;if(i.uuid===void 0&&(i.uuid=Le.generateUUID()),!t&&e.images[i.uuid]===void 0){var r;if(Array.isArray(i)){r=[];for(var a=0,o=i.length;a<o;a++)r.push(Xn.getDataURL(i[a]))}else r=Xn.getDataURL(i);e.images[i.uuid]={uuid:i.uuid,url:r}}n.image=i.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==kl)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case fo:e.x=e.x-Math.floor(e.x);break;case Ct:e.x=e.x<0?0:1;break;case po:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case fo:e.y=e.y-Math.floor(e.y);break;case Ct:e.y=e.y<0?0:1;break;case po:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}});Object.defineProperty(Je.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function Ze(e,t,n,i){this.x=e||0,this.y=t||0,this.z=n||0,this.w=i!==void 0?i:1}Object.defineProperties(Ze.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}});Object.assign(Ze.prototype,{isVector4:!0,set:function(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*r,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*r,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*r,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*r,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,i,r,a=.01,o=.1,s=e.elements,l=s[0],c=s[4],u=s[8],h=s[1],f=s[5],d=s[9],p=s[2],m=s[6],v=s[10];if(Math.abs(c-h)<a&&Math.abs(u-p)<a&&Math.abs(d-m)<a){if(Math.abs(c+h)<o&&Math.abs(u+p)<o&&Math.abs(d+m)<o&&Math.abs(l+f+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var y=(l+1)/2,x=(f+1)/2,w=(v+1)/2,S=(c+h)/4,b=(u+p)/4,A=(d+m)/4;return y>x&&y>w?y<a?(n=0,i=.707106781,r=.707106781):(n=Math.sqrt(y),i=S/n,r=b/n):x>w?x<a?(n=.707106781,i=0,r=.707106781):(i=Math.sqrt(x),n=S/i,r=A/i):w<a?(n=.707106781,i=.707106781,r=0):(r=Math.sqrt(w),n=b/r,i=A/r),this.set(n,i,r,t),this}var C=Math.sqrt((m-d)*(m-d)+(u-p)*(u-p)+(h-c)*(h-c));return Math.abs(C)<.001&&(C=1),this.x=(m-d)/C,this.y=(u-p)/C,this.z=(h-c)/C,this.w=Math.acos((l+f+v-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}});function At(e,t,n){this.width=e,this.height=t,this.scissor=new Ze(0,0,e,t),this.scissorTest=!1,this.viewport=new Ze(0,0,e,t),n=n||{},this.texture=new Je(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:gt,this.depthBuffer=n.depthBuffer!==void 0?n.depthBuffer:!0,this.stencilBuffer=n.stencilBuffer!==void 0?n.stencilBuffer:!0,this.depthTexture=n.depthTexture!==void 0?n.depthTexture:null}At.prototype=Object.assign(Object.create(In.prototype),{constructor:At,isWebGLRenderTarget:!0,setSize:function(e,t){(this.width!==e||this.height!==t)&&(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});function xc(e,t,n){At.call(this,e,t,n),this.samples=4}xc.prototype=Object.assign(Object.create(At.prototype),{constructor:xc,isWebGLMultisampleRenderTarget:!0,copy:function(e){return At.prototype.copy.call(this,e),this.samples=e.samples,this}});function Pt(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._w=i!==void 0?i:1}Object.assign(Pt,{slerp:function(e,t,n,i){return n.copy(e).slerp(t,i)},slerpFlat:function(e,t,n,i,r,a,o){var s=n[i+0],l=n[i+1],c=n[i+2],u=n[i+3],h=r[a+0],f=r[a+1],d=r[a+2],p=r[a+3];if(u!==p||s!==h||l!==f||c!==d){var m=1-o,v=s*h+l*f+c*d+u*p,y=v>=0?1:-1,x=1-v*v;if(x>Number.EPSILON){var w=Math.sqrt(x),S=Math.atan2(w,v*y);m=Math.sin(m*S)/w,o=Math.sin(o*S)/w}var b=o*y;if(s=s*m+h*b,l=l*m+f*b,c=c*m+d*b,u=u*m+p*b,m===1-o){var A=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=A,l*=A,c*=A,u*=A}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}});Object.defineProperties(Pt.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}});Object.assign(Pt.prototype,{isQuaternion:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!(e&&e.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,i=e._y,r=e._z,a=e.order,o=Math.cos,s=Math.sin,l=o(n/2),c=o(i/2),u=o(r/2),h=s(n/2),f=s(i/2),d=s(r/2);return a==="XYZ"?(this._x=h*c*u+l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u-h*f*d):a==="YXZ"?(this._x=h*c*u+l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u+h*f*d):a==="ZXY"?(this._x=h*c*u-l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u-h*f*d):a==="ZYX"?(this._x=h*c*u-l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u+h*f*d):a==="YZX"?(this._x=h*c*u+l*f*d,this._y=l*f*u+h*c*d,this._z=l*c*d-h*f*u,this._w=l*c*u-h*f*d):a==="XZY"&&(this._x=h*c*u-l*f*d,this._y=l*f*u-h*c*d,this._z=l*c*d+h*f*u,this._w=l*c*u+h*f*d),t!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t=e.elements,n=t[0],i=t[4],r=t[8],a=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],h=n+o+u,f;return h>0?(f=.5/Math.sqrt(h+1),this._w=.25/f,this._x=(c-s)*f,this._y=(r-l)*f,this._z=(a-i)*f):n>o&&n>u?(f=2*Math.sqrt(1+n-o-u),this._w=(c-s)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(r+l)/f):o>u?(f=2*Math.sqrt(1+o-n-u),this._w=(r-l)/f,this._x=(i+a)/f,this._y=.25*f,this._z=(s+c)/f):(f=2*Math.sqrt(1+u-n-o),this._w=(a-i)/f,this._x=(r+l)/f,this._y=(s+c)/f,this._z=.25*f),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=1e-6,i=e.dot(t)+1;return i<n?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Le.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(n===0)return this;var i=Math.min(1,t/n);return this.slerp(e,i),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,i=e._y,r=e._z,a=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+a*o+i*l-r*s,this._y=i*c+a*s+r*o-n*l,this._z=r*c+a*l+n*s-i*o,this._w=a*c-n*o-i*s-r*l,this._onChangeCallback(),this},slerp:function(e,t){if(t===0)return this;if(t===1)return this.copy(e);var n=this._x,i=this._y,r=this._z,a=this._w,o=a*e._w+n*e._x+i*e._y+r*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=n,this._y=i,this._z=r,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*a+t*this._w,this._x=l*n+t*this._x,this._y=l*i+t*this._y,this._z=l*r+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),u=Math.atan2(c,o),h=Math.sin((1-t)*u)/c,f=Math.sin(t*u)/c;return this._w=a*h+this._w*f,this._x=n*h+this._x*f,this._y=i*h+this._y*f,this._z=r*h+this._z*f,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return t===void 0&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var cs=new M,_c=new Pt;function M(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(M.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_c.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(_c.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6]*i,this.y=r[1]*t+r[4]*n+r[7]*i,this.z=r[2]*t+r[5]*n+r[8]*i,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements,a=1/(r[3]*t+r[7]*n+r[11]*i+r[15]);return this.x=(r[0]*t+r[4]*n+r[8]*i+r[12])*a,this.y=(r[1]*t+r[5]*n+r[9]*i+r[13])*a,this.z=(r[2]*t+r[6]*n+r[10]*i+r[14])*a,this},applyQuaternion:function(e){var t=this.x,n=this.y,i=this.z,r=e.x,a=e.y,o=e.z,s=e.w,l=s*t+a*i-o*n,c=s*n+o*t-r*i,u=s*i+r*n-a*t,h=-r*t-a*n-o*i;return this.x=l*s+h*-r+c*-o-u*-a,this.y=c*s+h*-a+u*-r-l*-o,this.z=u*s+h*-o+l*-a-c*-r,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,i=this.z,r=e.elements;return this.x=r[0]*t+r[4]*n+r[8]*i,this.y=r[1]*t+r[5]*n+r[9]*i,this.z=r[2]*t+r[6]*n+r[10]*i,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return t!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,i=e.y,r=e.z,a=t.x,o=t.y,s=t.z;return this.x=i*s-r*o,this.y=r*a-n*s,this.z=n*o-i*a,this},projectOnVector:function(e){var t=e.lengthSq();if(t===0)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return cs.copy(this).projectOnVector(e),this.sub(cs)},reflect:function(e){return this.sub(cs.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Le.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,t*4)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,t*3)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return t===void 0&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return n!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var Ti=new M,Zt=new Re,xd=new M(0,0,0),_d=new M(1,1,1),Dn=new M,La=new M,Ot=new M;function Re(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Re.prototype,{isMatrix4:!0,set:function(e,t,n,i,r,a,o,s,l,c,u,h,f,d,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=i,v[1]=r,v[5]=a,v[9]=o,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=h,v[3]=f,v[7]=d,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Re().fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,i=1/Ti.setFromMatrixColumn(e,0).length(),r=1/Ti.setFromMatrixColumn(e,1).length(),a=1/Ti.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,i=e.y,r=e.z,a=Math.cos(n),o=Math.sin(n),s=Math.cos(i),l=Math.sin(i),c=Math.cos(r),u=Math.sin(r);if(e.order==="XYZ"){var h=a*c,f=a*u,d=o*c,p=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=f+d*l,t[5]=h-p*l,t[9]=-o*s,t[2]=p-h*l,t[6]=d+f*l,t[10]=a*s}else if(e.order==="YXZ"){var m=s*c,v=s*u,y=l*c,x=l*u;t[0]=m+x*o,t[4]=y*o-v,t[8]=a*l,t[1]=a*u,t[5]=a*c,t[9]=-o,t[2]=v*o-y,t[6]=x+m*o,t[10]=a*s}else if(e.order==="ZXY"){var m=s*c,v=s*u,y=l*c,x=l*u;t[0]=m-x*o,t[4]=-a*u,t[8]=y+v*o,t[1]=v+y*o,t[5]=a*c,t[9]=x-m*o,t[2]=-a*l,t[6]=o,t[10]=a*s}else if(e.order==="ZYX"){var h=a*c,f=a*u,d=o*c,p=o*u;t[0]=s*c,t[4]=d*l-f,t[8]=h*l+p,t[1]=s*u,t[5]=p*l+h,t[9]=f*l-d,t[2]=-l,t[6]=o*s,t[10]=a*s}else if(e.order==="YZX"){var w=a*s,S=a*l,b=o*s,A=o*l;t[0]=s*c,t[4]=A-w*u,t[8]=b*u+S,t[1]=u,t[5]=a*c,t[9]=-o*c,t[2]=-l*c,t[6]=S*u+b,t[10]=w-A*u}else if(e.order==="XZY"){var w=a*s,S=a*l,b=o*s,A=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=w*u+A,t[5]=a*c,t[9]=S*u-b,t[2]=b*u-S,t[6]=o*c,t[10]=A*u+w}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(xd,e,_d)},lookAt:function(e,t,n){var i=this.elements;return Ot.subVectors(e,t),Ot.lengthSq()===0&&(Ot.z=1),Ot.normalize(),Dn.crossVectors(n,Ot),Dn.lengthSq()===0&&(Math.abs(n.z)===1?Ot.x+=1e-4:Ot.z+=1e-4,Ot.normalize(),Dn.crossVectors(n,Ot)),Dn.normalize(),La.crossVectors(Ot,Dn),i[0]=Dn.x,i[4]=La.x,i[8]=Ot.x,i[1]=Dn.y,i[5]=La.y,i[9]=Ot.y,i[2]=Dn.z,i[6]=La.z,i[10]=Ot.z,this},multiply:function(e,t){return t!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,i=t.elements,r=this.elements,a=n[0],o=n[4],s=n[8],l=n[12],c=n[1],u=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],v=n[14],y=n[3],x=n[7],w=n[11],S=n[15],b=i[0],A=i[4],C=i[8],T=i[12],I=i[1],D=i[5],B=i[9],O=i[13],F=i[2],N=i[6],k=i[10],V=i[14],te=i[3],$=i[7],X=i[11],Y=i[15];return r[0]=a*b+o*I+s*F+l*te,r[4]=a*A+o*D+s*N+l*$,r[8]=a*C+o*B+s*k+l*X,r[12]=a*T+o*O+s*V+l*Y,r[1]=c*b+u*I+h*F+f*te,r[5]=c*A+u*D+h*N+f*$,r[9]=c*C+u*B+h*k+f*X,r[13]=c*T+u*O+h*V+f*Y,r[2]=d*b+p*I+m*F+v*te,r[6]=d*A+p*D+m*N+v*$,r[10]=d*C+p*B+m*k+v*X,r[14]=d*T+p*O+m*V+v*Y,r[3]=y*b+x*I+w*F+S*te,r[7]=y*A+x*D+w*N+S*$,r[11]=y*C+x*B+w*k+S*X,r[15]=y*T+x*O+w*V+S*Y,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],i=e[8],r=e[12],a=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],h=e[10],f=e[14],d=e[3],p=e[7],m=e[11],v=e[15];return d*(+r*s*u-i*l*u-r*o*h+n*l*h+i*o*f-n*s*f)+p*(+t*s*f-t*l*h+r*a*h-i*a*f+i*l*c-r*s*c)+m*(+t*l*u-t*o*f-r*a*u+n*a*f+r*o*c-n*l*c)+v*(-i*o*c-t*s*u+t*o*h+i*a*u-n*a*h+n*s*c)},transpose:function(){var e=this.elements,t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(e,t,n){var i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this},getInverse:function(e,t){var n=this.elements,i=e.elements,r=i[0],a=i[1],o=i[2],s=i[3],l=i[4],c=i[5],u=i[6],h=i[7],f=i[8],d=i[9],p=i[10],m=i[11],v=i[12],y=i[13],x=i[14],w=i[15],S=d*x*h-y*p*h+y*u*m-c*x*m-d*u*w+c*p*w,b=v*p*h-f*x*h-v*u*m+l*x*m+f*u*w-l*p*w,A=f*y*h-v*d*h+v*c*m-l*y*m-f*c*w+l*d*w,C=v*d*u-f*y*u-v*c*p+l*y*p+f*c*x-l*d*x,T=r*S+a*b+o*A+s*C;if(T===0){var I="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(t===!0)throw new Error(I);return console.warn(I),this.identity()}var D=1/T;return n[0]=S*D,n[1]=(y*p*s-d*x*s-y*o*m+a*x*m+d*o*w-a*p*w)*D,n[2]=(c*x*s-y*u*s+y*o*h-a*x*h-c*o*w+a*u*w)*D,n[3]=(d*u*s-c*p*s-d*o*h+a*p*h+c*o*m-a*u*m)*D,n[4]=b*D,n[5]=(f*x*s-v*p*s+v*o*m-r*x*m-f*o*w+r*p*w)*D,n[6]=(v*u*s-l*x*s-v*o*h+r*x*h+l*o*w-r*u*w)*D,n[7]=(l*p*s-f*u*s+f*o*h-r*p*h-l*o*m+r*u*m)*D,n[8]=A*D,n[9]=(v*d*s-f*y*s-v*a*m+r*y*m+f*a*w-r*d*w)*D,n[10]=(l*y*s-v*c*s+v*a*h-r*y*h-l*a*w+r*c*w)*D,n[11]=(f*c*s-l*d*s-f*a*h+r*d*h+l*a*m-r*c*m)*D,n[12]=C*D,n[13]=(f*y*o-v*d*o+v*a*p-r*y*p-f*a*x+r*d*x)*D,n[14]=(v*c*o-l*y*o-v*a*u+r*y*u+l*a*x-r*c*x)*D,n[15]=(l*d*o-f*c*o+f*a*u-r*d*u-l*a*p+r*c*p)*D,this},scale:function(e){var t=this.elements,n=e.x,i=e.y,r=e.z;return t[0]*=n,t[4]*=i,t[8]*=r,t[1]*=n,t[5]*=i,t[9]*=r,t[2]*=n,t[6]*=i,t[10]*=r,t[3]*=n,t[7]*=i,t[11]*=r,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),i=Math.sin(t),r=1-n,a=e.x,o=e.y,s=e.z,l=r*a,c=r*o;return this.set(l*a+n,l*o-i*s,l*s+i*o,0,l*o+i*s,c*o+n,c*s-i*a,0,l*s-i*o,c*s+i*a,r*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var i=this.elements,r=t._x,a=t._y,o=t._z,s=t._w,l=r+r,c=a+a,u=o+o,h=r*l,f=r*c,d=r*u,p=a*c,m=a*u,v=o*u,y=s*l,x=s*c,w=s*u,S=n.x,b=n.y,A=n.z;return i[0]=(1-(p+v))*S,i[1]=(f+w)*S,i[2]=(d-x)*S,i[3]=0,i[4]=(f-w)*b,i[5]=(1-(h+v))*b,i[6]=(m+y)*b,i[7]=0,i[8]=(d+x)*A,i[9]=(m-y)*A,i[10]=(1-(h+p))*A,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this},decompose:function(e,t,n){var i=this.elements,r=Ti.set(i[0],i[1],i[2]).length(),a=Ti.set(i[4],i[5],i[6]).length(),o=Ti.set(i[8],i[9],i[10]).length(),s=this.determinant();s<0&&(r=-r),e.x=i[12],e.y=i[13],e.z=i[14],Zt.copy(this);var l=1/r,c=1/a,u=1/o;return Zt.elements[0]*=l,Zt.elements[1]*=l,Zt.elements[2]*=l,Zt.elements[4]*=c,Zt.elements[5]*=c,Zt.elements[6]*=c,Zt.elements[8]*=u,Zt.elements[9]*=u,Zt.elements[10]*=u,t.setFromRotationMatrix(Zt),n.x=r,n.y=a,n.z=o,this},makePerspective:function(e,t,n,i,r,a){a===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(t-e),l=2*r/(n-i),c=(t+e)/(t-e),u=(n+i)/(n-i),h=-(a+r)/(a-r),f=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=c,o[12]=0,o[1]=0,o[5]=l,o[9]=u,o[13]=0,o[2]=0,o[6]=0,o[10]=h,o[14]=f,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(e,t,n,i,r,a){var o=this.elements,s=1/(t-e),l=1/(n-i),c=1/(a-r),u=(t+e)*s,h=(n+i)*l,f=(a+r)*c;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-u,o[1]=0,o[5]=2*l,o[9]=0,o[13]=-h,o[2]=0,o[6]=0,o[10]=-2*c,o[14]=-f,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0},fromArray:function(e,t){t===void 0&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}});var wc=new Re,bc=new Pt;function yr(e,t,n,i){this._x=e||0,this._y=t||0,this._z=n||0,this._order=i||yr.DefaultOrder}yr.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];yr.DefaultOrder="XYZ";Object.defineProperties(yr.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}});Object.assign(yr.prototype,{isEuler:!0,set:function(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._order=i||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var i=Le.clamp,r=e.elements,a=r[0],o=r[4],s=r[8],l=r[1],c=r[5],u=r[9],h=r[2],f=r[6],d=r[10];return t=t||this._order,t==="XYZ"?(this._y=Math.asin(i(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-u,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(f,c),this._z=0)):t==="YXZ"?(this._x=Math.asin(-i(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-h,a),this._z=0)):t==="ZXY"?(this._x=Math.asin(i(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-o,c)):(this._y=0,this._z=Math.atan2(l,a))):t==="ZYX"?(this._y=Math.asin(-i(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,c))):t==="YZX"?(this._z=Math.asin(i(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-h,a)):(this._x=0,this._y=Math.atan2(s,d))):t==="XZY"?(this._z=Math.asin(-i(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-u,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,n!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return wc.makeRotationFromQuaternion(e),this.setFromRotationMatrix(wc,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return bc.setFromEuler(this),this.setFromQuaternion(bc,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new M(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});function eh(){this.mask=1}Object.assign(eh.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var wd=0,Mc=new M,Ai=new Pt,xn=new Re,Ca=new M,br=new M,bd=new M,Md=new Pt,Sc=new M(1,0,0),Ec=new M(0,1,0),Tc=new M(0,0,1),Sd={type:"added"},Ed={type:"removed"};function Q(){Object.defineProperty(this,"id",{value:wd++}),this.uuid=Le.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Q.DefaultUp.clone();var e=new M,t=new yr,n=new Pt,i=new M(1,1,1);function r(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(r),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new Re},normalMatrix:{value:new bt}}),this.matrix=new Re,this.matrixWorld=new Re,this.matrixAutoUpdate=Q.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new eh,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}Q.DefaultUp=new M(0,1,0);Q.DefaultMatrixAutoUpdate=!0;Q.prototype=Object.assign(Object.create(In.prototype),{constructor:Q,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return Ai.setFromAxisAngle(e,t),this.quaternion.multiply(Ai),this},rotateOnWorldAxis:function(e,t){return Ai.setFromAxisAngle(e,t),this.quaternion.premultiply(Ai),this},rotateX:function(e){return this.rotateOnAxis(Sc,e)},rotateY:function(e){return this.rotateOnAxis(Ec,e)},rotateZ:function(e){return this.rotateOnAxis(Tc,e)},translateOnAxis:function(e,t){return Mc.copy(e).applyQuaternion(this.quaternion),this.position.add(Mc.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Sc,e)},translateY:function(e){return this.translateOnAxis(Ec,e)},translateZ:function(e){return this.translateOnAxis(Tc,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(xn.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?Ca.copy(e):Ca.set(e,t,n);var i=this.parent;this.updateWorldMatrix(!0,!1),br.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?xn.lookAt(br,Ca,this.up):xn.lookAt(Ca,br,this.up),this.quaternion.setFromRotationMatrix(xn),i&&(xn.extractRotation(i.matrixWorld),Ai.setFromRotationMatrix(xn),this.quaternion.premultiply(Ai.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(Sd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(Ed)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),xn.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),xn.multiply(e.parent.matrixWorld)),e.applyMatrix4(xn),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,i=this.children.length;n<i;n++){var r=this.children[n],a=r.getObjectByProperty(e,t);if(a!==void 0)return a}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new M),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Pt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(br,e,bd),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new M),this.updateMatrixWorld(!0),this.matrixWorld.decompose(br,Md,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new M),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0)for(var i=this.children,r=0,a=i.length;r<a;r++)i[r].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON());function r(v,y){return v[y.uuid]===void 0&&(v[y.uuid]=y.toJSON(e)),y.uuid}if(this.isMesh||this.isLine||this.isPoints){i.geometry=r(e.geometries,this.geometry);var a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){var o=a.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var c=o[s];r(e.shapes,c)}else r(e.shapes,o)}}if(this.material!==void 0)if(Array.isArray(this.material)){for(var u=[],s=0,l=this.material.length;s<l;s++)u.push(r(e.materials,this.material[s]));i.material=u}else i.material=r(e.materials,this.material);if(this.children.length>0){i.children=[];for(var s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(e).object)}if(t){var h=m(e.geometries),f=m(e.materials),d=m(e.textures),p=m(e.images),o=m(e.shapes);h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),o.length>0&&(n.shapes=o)}return n.object=i,n;function m(v){var y=[];for(var x in v){var w=v[x];delete w.metadata,y.push(w)}return y}},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,t){if(t===void 0&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(var n=0;n<e.children.length;n++){var i=e.children[n];this.add(i.clone())}return this}});function En(){Q.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}En.prototype=Object.assign(Object.create(Q.prototype),{constructor:En,isScene:!0,copy:function(e,t){return Q.prototype.copy.call(this,e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=Q.prototype.toJSON.call(this,e);return this.background!==null&&(t.object.background=this.background.toJSON(e)),this.environment!==null&&(t.object.environment=this.environment.toJSON(e)),this.fog!==null&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _n=[new M,new M,new M,new M,new M,new M,new M,new M],Mr=new M,Ra=new yn,Li=new M,Ci=new M,Ri=new M,On=new M,Nn=new M,ti=new M,Sr=new M,Pa=new M,Ia=new M,ni=new M;function yn(e,t){this.min=e!==void 0?e:new M(1/0,1/0,1/0),this.max=t!==void 0?t:new M(-1/0,-1/0,-1/0)}Object.assign(yn.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=e.length;s<l;s+=3){var c=e[s],u=e[s+1],h=e[s+2];c<t&&(t=c),u<n&&(n=u),h<i&&(i=h),c>r&&(r=c),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,i=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,l=e.count;s<l;s++){var c=e.getX(s),u=e.getY(s),h=e.getZ(s);c<t&&(t=c),u<n&&(n=u),h<i&&(i=h),c>r&&(r=c),u>a&&(a=u),h>o&&(o=h)}return this.min.set(t,n,i),this.max.set(r,a,o),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=Mr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new M),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new M),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;t!==void 0&&(t.boundingBox===null&&t.computeBoundingBox(),Ra.copy(t.boundingBox),Ra.applyMatrix4(e.matrixWorld),this.expandByPoint(Ra.min),this.expandByPoint(Ra.max));for(var n=e.children,i=0,r=n.length;i<r;i++)this.expandByObject(n[i]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new M),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Mr),Mr.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Sr),Pa.subVectors(this.max,Sr),Li.subVectors(e.a,Sr),Ci.subVectors(e.b,Sr),Ri.subVectors(e.c,Sr),On.subVectors(Ci,Li),Nn.subVectors(Ri,Ci),ti.subVectors(Li,Ri);var t=[0,-On.z,On.y,0,-Nn.z,Nn.y,0,-ti.z,ti.y,On.z,0,-On.x,Nn.z,0,-Nn.x,ti.z,0,-ti.x,-On.y,On.x,0,-Nn.y,Nn.x,0,-ti.y,ti.x,0];return!us(t,Li,Ci,Ri,Pa)||(t=[1,0,0,0,1,0,0,0,1],!us(t,Li,Ci,Ri,Pa))?!1:(Ia.crossVectors(On,Nn),t=[Ia.x,Ia.y,Ia.z],us(t,Li,Ci,Ri,Pa))},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new M),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Mr.copy(e).clamp(this.min,this.max);return t.sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=this.getSize(Mr).length()*.5,e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(_n[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_n[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_n[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_n[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_n[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_n[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_n[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_n[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_n),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});function us(e,t,n,i,r){var a,o;for(a=0,o=e.length-3;a<=o;a+=3){ni.fromArray(e,a);var s=r.x*Math.abs(ni.x)+r.y*Math.abs(ni.y)+r.z*Math.abs(ni.z),l=t.dot(ni),c=n.dot(ni),u=i.dot(ni);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}var Td=new yn;function ei(e,t){this.center=e!==void 0?e:new M,this.radius=t!==void 0?t:0}Object.assign(ei.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;t!==void 0?n.copy(t):Td.setFromPoints(e).getCenter(n);for(var i=0,r=0,a=e.length;r<a;r++)i=Math.max(i,n.distanceToSquared(e[r]));return this.radius=Math.sqrt(i),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return t===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new M),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new yn),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var wn=new M,hs=new M,Da=new M,Fn=new M,fs=new M,Oa=new M,ds=new M;function xr(e,t){this.origin=e!==void 0?e:new M,this.direction=t!==void 0?t:new M(0,0,-1)}Object.assign(xr.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return t===void 0&&(console.warn("THREE.Ray: .at() target is now required"),t=new M),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,wn)),this},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new M),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=wn.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(wn.copy(this.direction).multiplyScalar(t).add(this.origin),wn.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,i){hs.copy(e).add(t).multiplyScalar(.5),Da.copy(t).sub(e).normalize(),Fn.copy(this.origin).sub(hs);var r=e.distanceTo(t)*.5,a=-this.direction.dot(Da),o=Fn.dot(this.direction),s=-Fn.dot(Da),l=Fn.lengthSq(),c=Math.abs(1-a*a),u,h,f,d;if(c>0)if(u=a*s-o,h=a*o-s,d=r*c,u>=0)if(h>=-d)if(h<=d){var p=1/c;u*=p,h*=p,f=u*(u+a*h+2*o)+h*(a*u+h+2*s)+l}else h=r,u=Math.max(0,-(a*h+o)),f=-u*u+h*(h+2*s)+l;else h=-r,u=Math.max(0,-(a*h+o)),f=-u*u+h*(h+2*s)+l;else h<=-d?(u=Math.max(0,-(-a*r+o)),h=u>0?-r:Math.min(Math.max(-r,-s),r),f=-u*u+h*(h+2*s)+l):h<=d?(u=0,h=Math.min(Math.max(-r,-s),r),f=h*(h+2*s)+l):(u=Math.max(0,-(a*r+o)),h=u>0?r:Math.min(Math.max(-r,-s),r),f=-u*u+h*(h+2*s)+l);else h=a>0?-r:r,u=Math.max(0,-(a*h+o)),f=-u*u+h*(h+2*s)+l;return n&&n.copy(this.direction).multiplyScalar(u).add(this.origin),i&&i.copy(Da).multiplyScalar(h).add(hs),f},intersectSphere:function(e,t){wn.subVectors(e.center,this.origin);var n=wn.dot(this.direction),i=wn.dot(wn)-n*n,r=e.radius*e.radius;if(i>r)return null;var a=Math.sqrt(r-i),o=n-a,s=n+a;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return n===null?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);if(t===0)return!0;var n=e.normal.dot(this.direction);return n*t<0},intersectBox:function(e,t){var n,i,r,a,o,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,h=this.origin;return l>=0?(n=(e.min.x-h.x)*l,i=(e.max.x-h.x)*l):(n=(e.max.x-h.x)*l,i=(e.min.x-h.x)*l),c>=0?(r=(e.min.y-h.y)*c,a=(e.max.y-h.y)*c):(r=(e.max.y-h.y)*c,a=(e.min.y-h.y)*c),n>a||r>i||((r>n||n!==n)&&(n=r),(a<i||i!==i)&&(i=a),u>=0?(o=(e.min.z-h.z)*u,s=(e.max.z-h.z)*u):(o=(e.max.z-h.z)*u,s=(e.min.z-h.z)*u),n>s||o>i)||((o>n||n!==n)&&(n=o),(s<i||i!==i)&&(i=s),i<0)?null:this.at(n>=0?n:i,t)},intersectsBox:function(e){return this.intersectBox(e,wn)!==null},intersectTriangle:function(e,t,n,i,r){fs.subVectors(t,e),Oa.subVectors(n,e),ds.crossVectors(fs,Oa);var a=this.direction.dot(ds),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Fn.subVectors(this.origin,e);var s=o*this.direction.dot(Oa.crossVectors(Fn,Oa));if(s<0)return null;var l=o*this.direction.dot(fs.cross(Fn));if(l<0||s+l>a)return null;var c=-o*Fn.dot(ds);return c<0?null:this.at(c/a,r)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var ps=new M,Ad=new M,Ld=new bt;function sn(e,t){this.normal=e!==void 0?e:new M(1,0,0),this.constant=t!==void 0?t:0}Object.assign(sn.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){var i=ps.subVectors(n,t).cross(Ad.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return t===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new M),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){t===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new M);var n=e.delta(ps),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):void 0;var r=-(e.start.dot(this.normal)+this.constant)/i;if(!(r<0||r>1))return t.copy(n).multiplyScalar(r).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new M),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var n=t||Ld.getNormalMatrix(e),i=this.coplanarPoint(ps).applyMatrix4(e),r=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(r),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var Kt=new M,Mn=new M,ms=new M,bn=new M,Pi=new M,Ii=new M,Ac=new M,vs=new M,gs=new M,ys=new M;function xt(e,t,n){this.a=e!==void 0?e:new M,this.b=t!==void 0?t:new M,this.c=n!==void 0?n:new M}Object.assign(xt,{getNormal:function(e,t,n,i){i===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new M),i.subVectors(n,t),Kt.subVectors(e,t),i.cross(Kt);var r=i.lengthSq();return r>0?i.multiplyScalar(1/Math.sqrt(r)):i.set(0,0,0)},getBarycoord:function(e,t,n,i,r){Kt.subVectors(i,t),Mn.subVectors(n,t),ms.subVectors(e,t);var a=Kt.dot(Kt),o=Kt.dot(Mn),s=Kt.dot(ms),l=Mn.dot(Mn),c=Mn.dot(ms),u=a*l-o*o;if(r===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),r=new M),u===0)return r.set(-2,-1,-1);var h=1/u,f=(l*s-o*c)*h,d=(a*c-o*s)*h;return r.set(1-f-d,d,f)},containsPoint:function(e,t,n,i){return xt.getBarycoord(e,t,n,i,bn),bn.x>=0&&bn.y>=0&&bn.x+bn.y<=1},getUV:function(e,t,n,i,r,a,o,s){return this.getBarycoord(e,t,n,i,bn),s.set(0,0),s.addScaledVector(r,bn.x),s.addScaledVector(a,bn.y),s.addScaledVector(o,bn.z),s},isFrontFacing:function(e,t,n,i){return Kt.subVectors(n,t),Mn.subVectors(e,t),Kt.cross(Mn).dot(i)<0}});Object.assign(xt.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return Kt.subVectors(this.c,this.b),Mn.subVectors(this.a,this.b),Kt.cross(Mn).length()*.5},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new M),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return xt.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new sn),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return xt.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,i,r){return xt.getUV(e,this.a,this.b,this.c,t,n,i,r)},containsPoint:function(e){return xt.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return xt.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){t===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new M);var n=this.a,i=this.b,r=this.c,a,o;Pi.subVectors(i,n),Ii.subVectors(r,n),vs.subVectors(e,n);var s=Pi.dot(vs),l=Ii.dot(vs);if(s<=0&&l<=0)return t.copy(n);gs.subVectors(e,i);var c=Pi.dot(gs),u=Ii.dot(gs);if(c>=0&&u<=c)return t.copy(i);var h=s*u-c*l;if(h<=0&&s>=0&&c<=0)return a=s/(s-c),t.copy(n).addScaledVector(Pi,a);ys.subVectors(e,r);var f=Pi.dot(ys),d=Ii.dot(ys);if(d>=0&&f<=d)return t.copy(r);var p=f*l-s*d;if(p<=0&&l>=0&&d<=0)return o=l/(l-d),t.copy(n).addScaledVector(Ii,o);var m=c*d-f*u;if(m<=0&&u-c>=0&&f-d>=0)return Ac.subVectors(r,i),o=(u-c)/(u-c+(f-d)),t.copy(i).addScaledVector(Ac,o);var v=1/(m+p+h);return a=p*v,o=h*v,t.copy(n).addScaledVector(Pi,a).addScaledVector(Ii,o)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var th={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Jt={h:0,s:0,l:0},Na={h:0,s:0,l:0};function ee(e,t,n){return t===void 0&&n===void 0?this.set(e):this.setRGB(e,t,n)}function xs(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*6*(2/3-n):e}function _s(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function ws(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}Object.assign(ee.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Le.euclideanModulo(e,1),t=Le.clamp(t,0,1),n=Le.clamp(n,0,1),t===0)this.r=this.g=this.b=n;else{var i=n<=.5?n*(1+t):n+t-n*t,r=2*n-i;this.r=xs(r,i,e+1/3),this.g=xs(r,i,e),this.b=xs(r,i,e-1/3)}return this},setStyle:function(e){function t(h){h!==void 0&&parseFloat(h)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var i,r=n[1],a=n[2];switch(r){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,t(i[5]),this;if(i=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,t(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(i[1])/360,s=parseInt(i[2],10)/100,l=parseInt(i[3],10)/100;return t(i[5]),this.setHSL(o,s,l)}break}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var c=n[1],u=c.length;if(u===3)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(u===6)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=th[e];return t!==void 0?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return t===void 0&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){t===void 0&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=_s(e.r),this.g=_s(e.g),this.b=_s(e.b),this},copyLinearToSRGB:function(e){return this.r=ws(e.r),this.g=ws(e.g),this.b=ws(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return this.r*255<<16^this.g*255<<8^this.b*255<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t=this.r,n=this.g,i=this.b,r=Math.max(t,n,i),a=Math.min(t,n,i),o,s,l=(a+r)/2;if(a===r)o=0,s=0;else{var c=r-a;switch(s=l<=.5?c/(r+a):c/(2-r-a),r){case t:o=(n-i)/c+(n<i?6:0);break;case n:o=(i-t)/c+2;break;case i:o=(t-n)/c+4;break}o/=6}return e.h=o,e.s=s,e.l=l,e},getStyle:function(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(Jt),Jt.h+=e,Jt.s+=t,Jt.l+=n,this.setHSL(Jt.h,Jt.s,Jt.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(Jt),e.getHSL(Na);var n=Le.lerp(Jt.h,Na.h,t),i=Le.lerp(Jt.s,Na.s,t),r=Le.lerp(Jt.l,Na.l,t);return this.setHSL(n,i,r),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return t===void 0&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return e===void 0&&(e=[]),t===void 0&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}});ee.NAMES=th;function xo(e,t,n,i,r,a){this.a=e,this.b=t,this.c=n,this.normal=i&&i.isVector3?i:new M,this.vertexNormals=Array.isArray(i)?i:[],this.color=r&&r.isColor?r:new ee,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=a!==void 0?a:0}Object.assign(xo.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var Cd=0;function xe(){Object.defineProperty(this,"id",{value:Cd++}),this.uuid=Le.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=Or,this.side=wa,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=Hu,this.opacity=1,this.transparent=!1,this.blendSrc=Wu,this.blendDst=ju,this.blendEquation=Hi,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=zs,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=gd,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ls,this.stencilZFail=ls,this.stencilZPass=ls,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}xe.prototype=Object.assign(Object.create(In.prototype),{constructor:xe,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var t in e){var n=e[t];if(n===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}if(t==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===Vu;continue}var i=this[t];if(i===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}},toJSON:function(e){var t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,this.combine!==void 0&&(n.combine=this.combine),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(n.size=this.size),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Or&&(n.blending=this.blending),this.flatShading===!0&&(n.flatShading=this.flatShading),this.side!==wa&&(n.side=this.side),this.vertexColors!==Hu&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(n.morphTargets=!0),this.morphNormals===!0&&(n.morphNormals=!0),this.skinning===!0&&(n.skinning=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(n.userData=this.userData);function i(o){var s=[];for(var l in o){var c=o[l];delete c.metadata,s.push(c)}return s}if(t){var r=i(e.textures),a=i(e.images);r.length>0&&(n.textures=r),a.length>0&&(n.images=a)}return n},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(t!==null){var i=t.length;n=new Array(i);for(var r=0;r!==i;++r)n[r]=t[r].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}});Object.defineProperty(xe.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});function tn(e){xe.call(this),this.type="MeshBasicMaterial",this.color=new ee(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=es,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}tn.prototype=Object.create(xe.prototype);tn.prototype.constructor=tn;tn.prototype.isMeshBasicMaterial=!0;tn.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var je=new M;function _e(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n===!0,this.usage=is,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(_e.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});Object.assign(_e.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var i=0,r=this.itemSize;i<r;i++)this.array[e+i]=t.array[n+i];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",i),a=new ee),t[n++]=a.r,t[n++]=a.g,t[n++]=a.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",i),a=new U),t[n++]=a.x,t[n++]=a.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",i),a=new M),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,i=0,r=e.length;i<r;i++){var a=e[i];a===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",i),a=new Ze),t[n++]=a.x,t[n++]=a.y,t[n++]=a.z,t[n++]=a.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)je.x=this.getX(t),je.y=this.getY(t),je.z=this.getZ(t),je.applyMatrix3(e),this.setXYZ(t,je.x,je.y,je.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)je.x=this.getX(t),je.y=this.getY(t),je.z=this.getZ(t),je.applyMatrix4(e),this.setXYZ(t,je.x,je.y,je.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)je.x=this.getX(t),je.y=this.getY(t),je.z=this.getZ(t),je.applyNormalMatrix(e),this.setXYZ(t,je.x,je.y,je.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)je.x=this.getX(t),je.y=this.getY(t),je.z=this.getZ(t),je.transformDirection(e),this.setXYZ(t,je.x,je.y,je.z);return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=r,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}});function Vs(e,t,n){_e.call(this,new Int8Array(e),t,n)}Vs.prototype=Object.create(_e.prototype);Vs.prototype.constructor=Vs;function Hs(e,t,n){_e.call(this,new Uint8Array(e),t,n)}Hs.prototype=Object.create(_e.prototype);Hs.prototype.constructor=Hs;function Ws(e,t,n){_e.call(this,new Uint8ClampedArray(e),t,n)}Ws.prototype=Object.create(_e.prototype);Ws.prototype.constructor=Ws;function js(e,t,n){_e.call(this,new Int16Array(e),t,n)}js.prototype=Object.create(_e.prototype);js.prototype.constructor=js;function Gr(e,t,n){_e.call(this,new Uint16Array(e),t,n)}Gr.prototype=Object.create(_e.prototype);Gr.prototype.constructor=Gr;function qs(e,t,n){_e.call(this,new Int32Array(e),t,n)}qs.prototype=Object.create(_e.prototype);qs.prototype.constructor=qs;function Vr(e,t,n){_e.call(this,new Uint32Array(e),t,n)}Vr.prototype=Object.create(_e.prototype);Vr.prototype.constructor=Vr;function K(e,t,n){_e.call(this,new Float32Array(e),t,n)}K.prototype=Object.create(_e.prototype);K.prototype.constructor=K;function Xs(e,t,n){_e.call(this,new Float64Array(e),t,n)}Xs.prototype=Object.create(_e.prototype);Xs.prototype.constructor=Xs;function nh(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(nh.prototype,{computeGroups:function(e){for(var t,n=[],i=void 0,r=e.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==i&&(i=o.materialIndex,t!==void 0&&(t.count=a*3-t.start,n.push(t)),t={start:a*3,materialIndex:i})}t!==void 0&&(t.count=a*3-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t=e.faces,n=e.vertices,i=e.faceVertexUvs,r=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,o=e.morphTargets,s=o.length,l;if(s>0){l=[];for(var c=0;c<s;c++)l[c]={name:o[c].name,data:[]};this.morphTargets.position=l}var u=e.morphNormals,h=u.length,f;if(h>0){f=[];for(var c=0;c<h;c++)f[c]={name:u[c].name,data:[]};this.morphTargets.normal=f}var d=e.skinIndices,p=e.skinWeights,m=d.length===n.length,v=p.length===n.length;n.length>0&&t.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var c=0;c<t.length;c++){var y=t[c];this.vertices.push(n[y.a],n[y.b],n[y.c]);var x=y.vertexNormals;if(x.length===3)this.normals.push(x[0],x[1],x[2]);else{var w=y.normal;this.normals.push(w,w,w)}var S=y.vertexColors;if(S.length===3)this.colors.push(S[0],S[1],S[2]);else{var b=y.color;this.colors.push(b,b,b)}if(r===!0){var A=i[0][c];A!==void 0?this.uvs.push(A[0],A[1],A[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",c),this.uvs.push(new U,new U,new U))}if(a===!0){var A=i[1][c];A!==void 0?this.uvs2.push(A[0],A[1],A[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",c),this.uvs2.push(new U,new U,new U))}for(var C=0;C<s;C++){var T=o[C].vertices;l[C].data.push(T[y.a],T[y.b],T[y.c])}for(var C=0;C<h;C++){var I=u[C].vertexNormals[c];f[C].data.push(I.a,I.b,I.c)}m&&this.skinIndices.push(d[y.a],d[y.b],d[y.c]),v&&this.skinWeights.push(p[y.a],p[y.b],p[y.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});function ih(e){if(e.length===0)return-1/0;for(var t=e[0],n=1,i=e.length;n<i;++n)e[n]>t&&(t=e[n]);return t}var Rd=1,an=new Re,bs=new Q,Di=new M,Nt=new yn,Er=new yn,ct=new M;function ne(){Object.defineProperty(this,"id",{value:Rd+=2}),this.uuid=Le.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}ne.prototype=Object.assign(Object.create(In.prototype),{constructor:ne,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(ih(e)>65535?Vr:Gr)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:n!==void 0?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(n!==void 0){var i=new bt().getNormalMatrix(e);n.applyNormalMatrix(i),n.needsUpdate=!0}var r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return an.makeRotationX(e),this.applyMatrix4(an),this},rotateY:function(e){return an.makeRotationY(e),this.applyMatrix4(an),this},rotateZ:function(e){return an.makeRotationZ(e),this.applyMatrix4(an),this},translate:function(e,t,n){return an.makeTranslation(e,t,n),this.applyMatrix4(an),this},scale:function(e,t,n){return an.makeScale(e,t,n),this.applyMatrix4(an),this},lookAt:function(e){return bs.lookAt(e),bs.updateMatrix(),this.applyMatrix4(bs.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Di).negate(),this.translate(Di.x,Di.y,Di.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new K(t.vertices.length*3,3),i=new K(t.colors.length*3,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",i.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var r=new K(t.lineDistances.length,1);this.setAttribute("lineDistance",r.copyArray(t.lineDistances))}t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new K(t,3)),this},updateFromObject:function(e){var t=e.geometry;if(e.isMesh){var n=t.__directGeometry;if(t.elementsNeedUpdate===!0&&(n=void 0,t.elementsNeedUpdate=!1),n===void 0)return this.fromGeometry(t);n.verticesNeedUpdate=t.verticesNeedUpdate,n.normalsNeedUpdate=t.normalsNeedUpdate,n.colorsNeedUpdate=t.colorsNeedUpdate,n.uvsNeedUpdate=t.uvsNeedUpdate,n.groupsNeedUpdate=t.groupsNeedUpdate,t.verticesNeedUpdate=!1,t.normalsNeedUpdate=!1,t.colorsNeedUpdate=!1,t.uvsNeedUpdate=!1,t.groupsNeedUpdate=!1,t=n}var i;return t.verticesNeedUpdate===!0&&(i=this.attributes.position,i!==void 0&&(i.copyVector3sArray(t.vertices),i.needsUpdate=!0),t.verticesNeedUpdate=!1),t.normalsNeedUpdate===!0&&(i=this.attributes.normal,i!==void 0&&(i.copyVector3sArray(t.normals),i.needsUpdate=!0),t.normalsNeedUpdate=!1),t.colorsNeedUpdate===!0&&(i=this.attributes.color,i!==void 0&&(i.copyColorsArray(t.colors),i.needsUpdate=!0),t.colorsNeedUpdate=!1),t.uvsNeedUpdate&&(i=this.attributes.uv,i!==void 0&&(i.copyVector2sArray(t.uvs),i.needsUpdate=!0),t.uvsNeedUpdate=!1),t.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,i!==void 0&&(i.copyArray(t.lineDistances),i.needsUpdate=!0),t.lineDistancesNeedUpdate=!1),t.groupsNeedUpdate&&(t.computeGroups(e.geometry),this.groups=t.groups,t.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new nh().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(e.vertices.length*3);if(this.setAttribute("position",new _e(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(e.normals.length*3);this.setAttribute("normal",new _e(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var i=new Float32Array(e.colors.length*3);this.setAttribute("color",new _e(i,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var r=new Float32Array(e.uvs.length*2);this.setAttribute("uv",new _e(r,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var a=new Float32Array(e.uvs2.length*2);this.setAttribute("uv2",new _e(a,2).copyVector2sArray(e.uvs2))}this.groups=e.groups;for(var o in e.morphTargets){for(var s=[],l=e.morphTargets[o],c=0,u=l.length;c<u;c++){var h=l[c],f=new K(h.data.length*3,3);f.name=h.name,s.push(f.copyVector3sArray(h.data))}this.morphAttributes[o]=s}if(e.skinIndices.length>0){var d=new K(e.skinIndices.length*4,4);this.setAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new K(e.skinWeights.length*4,4);this.setAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new yn);var e=this.attributes.position,t=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,i=t.length;n<i;n++){var r=t[n];Nt.setFromBufferAttribute(r),this.morphTargetsRelative?(ct.addVectors(this.boundingBox.min,Nt.min),this.boundingBox.expandByPoint(ct),ct.addVectors(this.boundingBox.max,Nt.max),this.boundingBox.expandByPoint(ct)):(this.boundingBox.expandByPoint(Nt.min),this.boundingBox.expandByPoint(Nt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ei);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(Nt.setFromBufferAttribute(e),t)for(var i=0,r=t.length;i<r;i++){var a=t[i];Er.setFromBufferAttribute(a),this.morphTargetsRelative?(ct.addVectors(Nt.min,Er.min),Nt.expandByPoint(ct),ct.addVectors(Nt.max,Er.max),Nt.expandByPoint(ct)):(Nt.expandByPoint(Er.min),Nt.expandByPoint(Er.max))}Nt.getCenter(n);for(var o=0,i=0,r=e.count;i<r;i++)ct.fromBufferAttribute(e,i),o=Math.max(o,n.distanceToSquared(ct));if(t)for(var i=0,r=t.length;i<r;i++)for(var a=t[i],s=this.morphTargetsRelative,l=0,c=a.count;l<c;l++)ct.fromBufferAttribute(a,l),s&&(Di.fromBufferAttribute(e,l),ct.add(Di)),o=Math.max(o,n.distanceToSquared(ct));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(t.normal===void 0)this.setAttribute("normal",new _e(new Float32Array(n.length),3));else for(var i=t.normal.array,r=0,a=i.length;r<a;r++)i[r]=0;var o=t.normal.array,s,l,c,u=new M,h=new M,f=new M,d=new M,p=new M;if(e)for(var m=e.array,r=0,a=e.count;r<a;r+=3)s=m[r+0]*3,l=m[r+1]*3,c=m[r+2]*3,u.fromArray(n,s),h.fromArray(n,l),f.fromArray(n,c),d.subVectors(f,h),p.subVectors(u,h),d.cross(p),o[s]+=d.x,o[s+1]+=d.y,o[s+2]+=d.z,o[l]+=d.x,o[l+1]+=d.y,o[l+2]+=d.z,o[c]+=d.x,o[c+1]+=d.y,o[c+2]+=d.z;else for(var r=0,a=n.length;r<a;r+=9)u.fromArray(n,r),h.fromArray(n,r+3),f.fromArray(n,r+6),d.subVectors(f,h),p.subVectors(u,h),d.cross(p),o[r]=d.x,o[r+1]=d.y,o[r+2]=d.z,o[r+3]=d.x,o[r+4]=d.y,o[r+5]=d.z,o[r+6]=d.x,o[r+7]=d.y,o[r+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(!(e&&e.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);return}t===void 0&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var i in n)if(e.attributes[i]!==void 0)for(var r=n[i],a=r.array,o=e.attributes[i],s=o.array,l=o.itemSize*t,c=Math.min(s.length,a.length-l),u=0,h=l;u<c;u++,h++)a[h]=s[u];return this},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)ct.x=e.getX(t),ct.y=e.getY(t),ct.z=e.getZ(t),ct.normalize(),e.setXYZ(t,ct.x,ct.y,ct.z)},toNonIndexed:function(){function e(m,v){for(var y=m.array,x=m.itemSize,w=new y.constructor(v.length*x),S=0,b=0,A=0,C=v.length;A<C;A++){S=v[A]*x;for(var T=0;T<x;T++)w[b++]=y[S++]}return new _e(w,x)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new ne,n=this.index.array,i=this.attributes;for(var r in i){var a=i[r],o=e(a,n);t.setAttribute(r,o)}var s=this.morphAttributes;for(r in s){for(var l=[],c=s[r],u=0,h=c.length;u<h;u++){var a=c[u],o=e(a,n);l.push(o)}t.morphAttributes[r]=l}t.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,u=0,d=f.length;u<d;u++){var p=f[u];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}e.data={attributes:{}};var i=this.index;i!==null&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});var r=this.attributes;for(var n in r){var a=r[n],o=a.toJSON();a.name!==""&&(o.name=a.name),e.data.attributes[n]=o}var s={},l=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],u=[],h=0,f=c.length;h<f;h++){var a=c[h],o=a.toJSON();a.name!==""&&(o.name=a.name),u.push(o)}u.length>0&&(s[n]=u,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));var p=this.boundingSphere;return p!==null&&(e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),e},clone:function(){return new ne().copy(this)},copy:function(e){var t,n,i;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var r=e.index;r!==null&&this.setIndex(r.clone());var a=e.attributes;for(t in a){var o=a[t];this.setAttribute(t,o.clone())}var s=e.morphAttributes;for(t in s){var l=[],c=s[t];for(n=0,i=c.length;n<i;n++)l.push(c[n].clone());this.morphAttributes[t]=l}this.morphTargetsRelative=e.morphTargetsRelative;var u=e.groups;for(n=0,i=u.length;n<i;n++){var h=u[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=e.boundingBox;f!==null&&(this.boundingBox=f.clone());var d=e.boundingSphere;return d!==null&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Lc=new Re,ii=new xr,Ms=new ei,ri=new M,ai=new M,oi=new M,Ss=new M,Es=new M,Ts=new M,Fa=new M,Ba=new M,ka=new M,qi=new U,Xi=new U,Yi=new U,Nr=new M,za=new M;function et(e,t){Q.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new ne,this.material=t!==void 0?t:new tn,this.updateMorphTargets()}et.prototype=Object.assign(Object.create(Q.prototype),{constructor:et,isMesh:!0,copy:function(e){return Q.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry,t,n,i;if(e.isBufferGeometry){var r=e.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(o!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,n=o.length;t<n;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=e.morphTargets;s!==void 0&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n=this.geometry,i=this.material,r=this.matrixWorld;if(i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Ms.copy(n.boundingSphere),Ms.applyMatrix4(r),e.ray.intersectsSphere(Ms)!==!1&&(Lc.getInverse(r),ii.copy(e.ray).applyMatrix4(Lc),!(n.boundingBox!==null&&ii.intersectsBox(n.boundingBox)===!1)))){var a;if(n.isBufferGeometry){var o,s,l,c=n.index,u=n.attributes.position,h=n.morphAttributes.position,f=n.morphTargetsRelative,d=n.attributes.uv,p=n.attributes.uv2,m=n.groups,v=n.drawRange,y,x,w,S,b,A,C,T;if(c!==null)if(Array.isArray(i))for(y=0,w=m.length;y<w;y++)for(b=m[y],A=i[b.materialIndex],C=Math.max(b.start,v.start),T=Math.min(b.start+b.count,v.start+v.count),x=C,S=T;x<S;x+=3)o=c.getX(x),s=c.getX(x+1),l=c.getX(x+2),a=Ua(this,A,e,ii,u,h,f,d,p,o,s,l),a&&(a.faceIndex=Math.floor(x/3),a.face.materialIndex=b.materialIndex,t.push(a));else for(C=Math.max(0,v.start),T=Math.min(c.count,v.start+v.count),y=C,w=T;y<w;y+=3)o=c.getX(y),s=c.getX(y+1),l=c.getX(y+2),a=Ua(this,i,e,ii,u,h,f,d,p,o,s,l),a&&(a.faceIndex=Math.floor(y/3),t.push(a));else if(u!==void 0)if(Array.isArray(i))for(y=0,w=m.length;y<w;y++)for(b=m[y],A=i[b.materialIndex],C=Math.max(b.start,v.start),T=Math.min(b.start+b.count,v.start+v.count),x=C,S=T;x<S;x+=3)o=x,s=x+1,l=x+2,a=Ua(this,A,e,ii,u,h,f,d,p,o,s,l),a&&(a.faceIndex=Math.floor(x/3),a.face.materialIndex=b.materialIndex,t.push(a));else for(C=Math.max(0,v.start),T=Math.min(u.count,v.start+v.count),y=C,w=T;y<w;y+=3)o=y,s=y+1,l=y+2,a=Ua(this,i,e,ii,u,h,f,d,p,o,s,l),a&&(a.faceIndex=Math.floor(y/3),t.push(a))}else if(n.isGeometry){var I,D,B,O=Array.isArray(i),F=n.vertices,N=n.faces,k,V=n.faceVertexUvs[0];V.length>0&&(k=V);for(var te=0,$=N.length;te<$;te++){var X=N[te],Y=O?i[X.materialIndex]:i;if(Y!==void 0&&(I=F[X.a],D=F[X.b],B=F[X.c],a=rh(this,Y,e,ii,I,D,B,Nr),a)){if(k&&k[te]){var ie=k[te];qi.copy(ie[0]),Xi.copy(ie[1]),Yi.copy(ie[2]),a.uv=xt.getUV(Nr,I,D,B,qi,Xi,Yi,new U)}a.face=X,a.faceIndex=te,t.push(a)}}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function rh(e,t,n,i,r,a,o,s){var l;if(t.side===mt?l=i.intersectTriangle(o,a,r,!0,s):l=i.intersectTriangle(r,a,o,t.side!==Qo,s),l===null)return null;za.copy(s),za.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(za);return c<n.near||c>n.far?null:{distance:c,point:za.clone(),object:e}}function Ua(e,t,n,i,r,a,o,s,l,c,u,h){ri.fromBufferAttribute(r,c),ai.fromBufferAttribute(r,u),oi.fromBufferAttribute(r,h);var f=e.morphTargetInfluences;if(t.morphTargets&&a&&f){Fa.set(0,0,0),Ba.set(0,0,0),ka.set(0,0,0);for(var d=0,p=a.length;d<p;d++){var m=f[d],v=a[d];m!==0&&(Ss.fromBufferAttribute(v,c),Es.fromBufferAttribute(v,u),Ts.fromBufferAttribute(v,h),o?(Fa.addScaledVector(Ss,m),Ba.addScaledVector(Es,m),ka.addScaledVector(Ts,m)):(Fa.addScaledVector(Ss.sub(ri),m),Ba.addScaledVector(Es.sub(ai),m),ka.addScaledVector(Ts.sub(oi),m)))}ri.add(Fa),ai.add(Ba),oi.add(ka)}var y=rh(e,t,n,i,ri,ai,oi,Nr);if(y){s&&(qi.fromBufferAttribute(s,c),Xi.fromBufferAttribute(s,u),Yi.fromBufferAttribute(s,h),y.uv=xt.getUV(Nr,ri,ai,oi,qi,Xi,Yi,new U)),l&&(qi.fromBufferAttribute(l,c),Xi.fromBufferAttribute(l,u),Yi.fromBufferAttribute(l,h),y.uv2=xt.getUV(Nr,ri,ai,oi,qi,Xi,Yi,new U));var x=new xo(c,u,h);xt.getNormal(ri,ai,oi,x.normal),y.face=x}return y}var Pd=0,on=new Re,As=new Q,Ga=new M;function we(){Object.defineProperty(this,"id",{value:Pd+=2}),this.uuid=Le.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}we.prototype=Object.assign(Object.create(In.prototype),{constructor:we,isGeometry:!0,applyMatrix4:function(e){for(var t=new bt().getNormalMatrix(e),n=0,i=this.vertices.length;n<i;n++){var r=this.vertices[n];r.applyMatrix4(e)}for(var n=0,i=this.faces.length;n<i;n++){var a=this.faces[n];a.normal.applyMatrix3(t).normalize();for(var o=0,s=a.vertexNormals.length;o<s;o++)a.vertexNormals[o].applyMatrix3(t).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return on.makeRotationX(e),this.applyMatrix4(on),this},rotateY:function(e){return on.makeRotationY(e),this.applyMatrix4(on),this},rotateZ:function(e){return on.makeRotationZ(e),this.applyMatrix4(on),this},translate:function(e,t,n){return on.makeTranslation(e,t,n),this.applyMatrix4(on),this},scale:function(e,t,n){return on.makeScale(e,t,n),this.applyMatrix4(on),this},lookAt:function(e){return As.lookAt(e),As.updateMatrix(),this.applyMatrix4(As.matrix),this},fromBufferGeometry:function(e){var t=this,n=e.index!==null?e.index.array:void 0,i=e.attributes;if(i.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var r=i.position.array,a=i.normal!==void 0?i.normal.array:void 0,o=i.color!==void 0?i.color.array:void 0,s=i.uv!==void 0?i.uv.array:void 0,l=i.uv2!==void 0?i.uv2.array:void 0;l!==void 0&&(this.faceVertexUvs[1]=[]);for(var c=0;c<r.length;c+=3)t.vertices.push(new M().fromArray(r,c)),o!==void 0&&t.colors.push(new ee().fromArray(o,c));function u(y,x,w,S){var b=o===void 0?[]:[t.colors[y].clone(),t.colors[x].clone(),t.colors[w].clone()],A=a===void 0?[]:[new M().fromArray(a,y*3),new M().fromArray(a,x*3),new M().fromArray(a,w*3)],C=new xo(y,x,w,A,b,S);t.faces.push(C),s!==void 0&&t.faceVertexUvs[0].push([new U().fromArray(s,y*2),new U().fromArray(s,x*2),new U().fromArray(s,w*2)]),l!==void 0&&t.faceVertexUvs[1].push([new U().fromArray(l,y*2),new U().fromArray(l,x*2),new U().fromArray(l,w*2)])}var h=e.groups;if(h.length>0)for(var c=0;c<h.length;c++)for(var f=h[c],d=f.start,p=f.count,m=d,v=d+p;m<v;m+=3)n!==void 0?u(n[m],n[m+1],n[m+2],f.materialIndex):u(m,m+1,m+2,f.materialIndex);else if(n!==void 0)for(var c=0;c<n.length;c+=3)u(n[c],n[c+1],n[c+2]);else for(var c=0;c<r.length/3;c+=3)u(c,c+1,c+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ga).negate(),this.translate(Ga.x,Ga.y,Ga.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=t===0?1:1/t,i=new Re;return i.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var e=new M,t=new M,n=0,i=this.faces.length;n<i;n++){var r=this.faces[n],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];e.subVectors(s,o),t.subVectors(a,o),e.cross(t),e.normalize(),r.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var t,n,i,r,a,o;for(o=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)o[t]=new M;if(e){var s,l,c,u=new M,h=new M;for(i=0,r=this.faces.length;i<r;i++)a=this.faces[i],s=this.vertices[a.a],l=this.vertices[a.b],c=this.vertices[a.c],u.subVectors(c,l),h.subVectors(s,l),u.cross(h),o[a.a].add(u),o[a.b].add(u),o[a.c].add(u)}else for(this.computeFaceNormals(),i=0,r=this.faces.length;i<r;i++)a=this.faces[i],o[a.a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(t=0,n=this.vertices.length;t<n;t++)o[t].normalize();for(i=0,r=this.faces.length;i<r;i++){a=this.faces[i];var f=a.vertexNormals;f.length===3?(f[0].copy(o[a.a]),f[1].copy(o[a.b]),f[2].copy(o[a.c])):(f[0]=o[a.a].clone(),f[1]=o[a.b].clone(),f[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){n=this.faces[e];var i=n.vertexNormals;i.length===3?(i[0].copy(n.normal),i[1].copy(n.normal),i[2].copy(n.normal)):(i[0]=n.normal.clone(),i[1]=n.normal.clone(),i[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,i,r;for(n=0,i=this.faces.length;n<i;n++)for(r=this.faces[n],r.__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),e=0,t=r.vertexNormals.length;e<t;e++)r.__originalVertexNormals[e]?r.__originalVertexNormals[e].copy(r.vertexNormals[e]):r.__originalVertexNormals[e]=r.vertexNormals[e].clone();var a=new we;for(a.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var o=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals,c,u;for(n=0,i=this.faces.length;n<i;n++)c=new M,u={a:new M,b:new M,c:new M},o.push(c),s.push(u)}var l=this.morphNormals[e];a.vertices=this.morphTargets[e].vertices,a.computeFaceNormals(),a.computeVertexNormals();var c,u;for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],c=l.faceNormals[n],u=l.vertexNormals[n],c.copy(r.normal),u.a.copy(r.vertexNormals[0]),u.b.copy(r.vertexNormals[1]),u.c.copy(r.vertexNormals[2])}for(n=0,i=this.faces.length;n<i;n++)r=this.faces[n],r.normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new yn),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new ei),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(!(e&&e.isGeometry)){console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e);return}var i,r=this.vertices.length,a=this.vertices,o=e.vertices,s=this.faces,l=e.faces,c=this.colors,u=e.colors;n===void 0&&(n=0),t!==void 0&&(i=new bt().getNormalMatrix(t));for(var h=0,f=o.length;h<f;h++){var d=o[h],p=d.clone();t!==void 0&&p.applyMatrix4(t),a.push(p)}for(var h=0,f=u.length;h<f;h++)c.push(u[h].clone());for(h=0,f=l.length;h<f;h++){var m=l[h],v,y,x,w=m.vertexNormals,S=m.vertexColors;v=new xo(m.a+r,m.b+r,m.c+r),v.normal.copy(m.normal),i!==void 0&&v.normal.applyMatrix3(i).normalize();for(var b=0,A=w.length;b<A;b++)y=w[b].clone(),i!==void 0&&y.applyMatrix3(i).normalize(),v.vertexNormals.push(y);v.color.copy(m.color);for(var b=0,A=S.length;b<A;b++)x=S[b],v.vertexColors.push(x.clone());v.materialIndex=m.materialIndex+n,s.push(v)}for(var h=0,f=e.faceVertexUvs.length;h<f;h++){var C=e.faceVertexUvs[h];this.faceVertexUvs[h]===void 0&&(this.faceVertexUvs[h]=[]);for(var b=0,A=C.length;b<A;b++){for(var T=C[b],I=[],D=0,B=T.length;D<B;D++)I.push(T[D].clone());this.faceVertexUvs[h].push(I)}}},mergeMesh:function(e){if(!(e&&e.isMesh)){console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e);return}e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)},mergeVertices:function(){var e={},t=[],n=[],i,r,a=4,o=Math.pow(10,a),s,l,c,u,h,f;for(s=0,l=this.vertices.length;s<l;s++)i=this.vertices[s],r=Math.round(i.x*o)+"_"+Math.round(i.y*o)+"_"+Math.round(i.z*o),e[r]===void 0?(e[r]=s,t.push(this.vertices[s]),n[s]=t.length-1):n[s]=n[e[r]];var d=[];for(s=0,l=this.faces.length;s<l;s++){c=this.faces[s],c.a=n[c.a],c.b=n[c.b],c.c=n[c.c],u=[c.a,c.b,c.c];for(var p=0;p<3;p++)if(u[p]===u[(p+1)%3]){d.push(s);break}}for(s=d.length-1;s>=0;s--){var m=d[s];for(this.faces.splice(m,1),h=0,f=this.faceVertexUvs.length;h<f;h++)this.faceVertexUvs[h].splice(m,1)}var v=this.vertices.length-t.length;return this.vertices=t,v},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var i=e[t];this.vertices.push(new M(i.x,i.y,i.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;function i(c,u){return c.materialIndex-u.materialIndex}e.sort(i);var r=this.faceVertexUvs[0],a=this.faceVertexUvs[1],o,s;r&&r.length===t&&(o=[]),a&&a.length===t&&(s=[]);for(var n=0;n<t;n++){var l=e[n]._id;o&&o.push(r[l]),s&&s.push(a[l])}o&&(this.faceVertexUvs[0]=o),s&&(this.faceVertexUvs[1]=s)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),this.parameters!==void 0){var t=this.parameters;for(var n in t)t[n]!==void 0&&(e[n]=t[n]);return e}for(var i=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];i.push(a.x,a.y,a.z)}for(var o=[],s=[],l={},c=[],u={},h=[],f={},r=0;r<this.faces.length;r++){var d=this.faces[r],p=!0,m=!1,v=this.faceVertexUvs[0][r]!==void 0,y=d.normal.length()>0,x=d.vertexNormals.length>0,w=d.color.r!==1||d.color.g!==1||d.color.b!==1,S=d.vertexColors.length>0,b=0;if(b=I(b,0,0),b=I(b,1,p),b=I(b,2,m),b=I(b,3,v),b=I(b,4,y),b=I(b,5,x),b=I(b,6,w),b=I(b,7,S),o.push(b),o.push(d.a,d.b,d.c),o.push(d.materialIndex),v){var A=this.faceVertexUvs[0][r];o.push(O(A[0]),O(A[1]),O(A[2]))}if(y&&o.push(D(d.normal)),x){var C=d.vertexNormals;o.push(D(C[0]),D(C[1]),D(C[2]))}if(w&&o.push(B(d.color)),S){var T=d.vertexColors;o.push(B(T[0]),B(T[1]),B(T[2]))}}function I(F,N,k){return k?F|1<<N:F&~(1<<N)}function D(F){var N=F.x.toString()+F.y.toString()+F.z.toString();return l[N]!==void 0||(l[N]=s.length/3,s.push(F.x,F.y,F.z)),l[N]}function B(F){var N=F.r.toString()+F.g.toString()+F.b.toString();return u[N]!==void 0||(u[N]=c.length,c.push(F.getHex())),u[N]}function O(F){var N=F.x.toString()+F.y.toString();return f[N]!==void 0||(f[N]=h.length/2,h.push(F.x,F.y)),f[N]}return e.data={},e.data.vertices=i,e.data.normals=s,c.length>0&&(e.data.colors=c),h.length>0&&(e.data.uvs=[h]),e.data.faces=o,e},clone:function(){return new we().copy(this)},copy:function(e){var t,n,i,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var l=e.colors;for(t=0,n=l.length;t<n;t++)this.colors.push(l[t].clone());var c=e.faces;for(t=0,n=c.length;t<n;t++)this.faces.push(c[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var u=e.faceVertexUvs[t];for(this.faceVertexUvs[t]===void 0&&(this.faceVertexUvs[t]=[]),i=0,r=u.length;i<r;i++){var h=u[i],f=[];for(a=0,o=h.length;a<o;a++){var d=h[a];f.push(d.clone())}this.faceVertexUvs[t].push(f)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,p[t].vertices!==void 0)for(m.vertices=[],i=0,r=p[t].vertices.length;i<r;i++)m.vertices.push(p[t].vertices[i].clone());if(p[t].normals!==void 0)for(m.normals=[],i=0,r=p[t].normals.length;i<r;i++)m.normals.push(p[t].normals[i].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,n=v.length;t<n;t++){var y={};if(v[t].vertexNormals!==void 0)for(y.vertexNormals=[],i=0,r=v[t].vertexNormals.length;i<r;i++){var x=v[t].vertexNormals[i],w={};w.a=x.a.clone(),w.b=x.b.clone(),w.c=x.c.clone(),y.vertexNormals.push(w)}if(v[t].faceNormals!==void 0)for(y.faceNormals=[],i=0,r=v[t].faceNormals.length;i<r;i++)y.faceNormals.push(v[t].faceNormals[i].clone());this.morphNormals.push(y)}var S=e.skinWeights;for(t=0,n=S.length;t<n;t++)this.skinWeights.push(S[t].clone());var b=e.skinIndices;for(t=0,n=b.length;t<n;t++)this.skinIndices.push(b[t].clone());var A=e.lineDistances;for(t=0,n=A.length;t<n;t++)this.lineDistances.push(A[t]);var C=e.boundingBox;C!==null&&(this.boundingBox=C.clone());var T=e.boundingSphere;return T!==null&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class ah extends we{constructor(t,n,i,r,a,o){super(),this.type="BoxGeometry",this.parameters={width:t,height:n,depth:i,widthSegments:r,heightSegments:a,depthSegments:o},this.fromBufferGeometry(new rs(t,n,i,r,a,o)),this.mergeVertices()}}class rs extends ne{constructor(t,n,i,r,a,o){super(),this.type="BoxBufferGeometry",this.parameters={width:t,height:n,depth:i,widthSegments:r,heightSegments:a,depthSegments:o};var s=this;t=t||1,n=n||1,i=i||1,r=Math.floor(r)||1,a=Math.floor(a)||1,o=Math.floor(o)||1;var l=[],c=[],u=[],h=[],f=0,d=0;p("z","y","x",-1,-1,i,n,t,o,a,0),p("z","y","x",1,-1,i,n,-t,o,a,1),p("x","z","y",1,1,t,i,n,r,o,2),p("x","z","y",1,-1,t,i,-n,r,o,3),p("x","y","z",1,-1,t,n,i,r,a,4),p("x","y","z",-1,-1,t,n,-i,r,a,5),this.setIndex(l),this.setAttribute("position",new K(c,3)),this.setAttribute("normal",new K(u,3)),this.setAttribute("uv",new K(h,2));function p(m,v,y,x,w,S,b,A,C,T,I){var D=S/C,B=b/T,O=S/2,F=b/2,N=A/2,k=C+1,V=T+1,te=0,$=0,X,Y,ie=new M;for(Y=0;Y<V;Y++){var Ue=Y*B-F;for(X=0;X<k;X++){var ze=X*D-O;ie[m]=ze*x,ie[v]=Ue*w,ie[y]=N,c.push(ie.x,ie.y,ie.z),ie[m]=0,ie[v]=0,ie[y]=A>0?1:-1,u.push(ie.x,ie.y,ie.z),h.push(X/C),h.push(1-Y/T),te+=1}}for(Y=0;Y<T;Y++)for(X=0;X<C;X++){var Be=f+X+k*Y,Me=f+X+k*(Y+1),G=f+(X+1)+k*(Y+1),He=f+(X+1)+k*Y;l.push(Be,Me,He),l.push(Me,G,He),$+=6}s.addGroup(d,$,I),d+=$,f+=te}}}function Qi(e){var t={};for(var n in e){t[n]={};for(var i in e[n]){var r=e[n][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?t[n][i]=r.clone():Array.isArray(r)?t[n][i]=r.slice():t[n][i]=r}}return t}function wt(e){for(var t={},n=0;n<e.length;n++){var i=Qi(e[n]);for(var r in i)t[r]=i[r]}return t}var Id={clone:Qi,merge:wt},Dd=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,Od=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;function Rt(e){xe.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=Dd,this.fragmentShader=Od,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}Rt.prototype=Object.create(xe.prototype);Rt.prototype.constructor=Rt;Rt.prototype.isShaderMaterial=!0;Rt.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Qi(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this};Rt.prototype.toJSON=function(e){var t=xe.prototype.toJSON.call(this,e);t.uniforms={};for(var n in this.uniforms){var i=this.uniforms[n],r=i.value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var o in this.extensions)this.extensions[o]===!0&&(a[o]=!0);return Object.keys(a).length>0&&(t.extensions=a),t};function Tn(){Q.call(this),this.type="Camera",this.matrixWorldInverse=new Re,this.projectionMatrix=new Re,this.projectionMatrixInverse=new Re}Tn.prototype=Object.assign(Object.create(Q.prototype),{constructor:Tn,isCamera:!0,copy:function(e,t){return Q.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new M),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){Q.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){Q.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}});function ut(e,t,n,i){Tn.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=n!==void 0?n:.1,this.far=i!==void 0?i:2e3,this.focus=10,this.aspect=t!==void 0?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ut.prototype=Object.assign(Object.create(Tn.prototype),{constructor:ut,isPerspectiveCamera:!0,copy:function(e,t){return Tn.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=Le.RAD2DEG*2*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(Le.DEG2RAD*.5*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return Le.RAD2DEG*2*Math.atan(Math.tan(Le.DEG2RAD*.5*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,i,r,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(Le.DEG2RAD*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,r=-.5*i,a=this.view;if(this.view!==null&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*i/o,t-=a.offsetY*n/s,i*=a.width/o,n*=a.height/s}var l=this.filmOffset;l!==0&&(r+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+i,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Q.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Oi=90,Ni=1;function Hr(e,t,n,i){Q.call(this),this.type="CubeCamera";var r=new ut(Oi,Ni,e,t);r.up.set(0,-1,0),r.lookAt(new M(1,0,0)),this.add(r);var a=new ut(Oi,Ni,e,t);a.up.set(0,-1,0),a.lookAt(new M(-1,0,0)),this.add(a);var o=new ut(Oi,Ni,e,t);o.up.set(0,0,1),o.lookAt(new M(0,1,0)),this.add(o);var s=new ut(Oi,Ni,e,t);s.up.set(0,0,-1),s.lookAt(new M(0,-1,0)),this.add(s);var l=new ut(Oi,Ni,e,t);l.up.set(0,-1,0),l.lookAt(new M(0,0,1)),this.add(l);var c=new ut(Oi,Ni,e,t);c.up.set(0,-1,0),c.lookAt(new M(0,0,-1)),this.add(c),i=i||{format:mi,magFilter:gt,minFilter:gt},this.renderTarget=new er(n,i),this.renderTarget.texture.name="CubeCamera",this.update=function(u,h){this.parent===null&&this.updateMatrixWorld();var f=u.getRenderTarget(),d=this.renderTarget,p=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,u.setRenderTarget(d,0),u.render(h,r),u.setRenderTarget(d,1),u.render(h,a),u.setRenderTarget(d,2),u.render(h,o),u.setRenderTarget(d,3),u.render(h,s),u.setRenderTarget(d,4),u.render(h,l),d.texture.generateMipmaps=p,u.setRenderTarget(d,5),u.render(h,c),u.setRenderTarget(f)},this.clear=function(u,h,f,d){for(var p=u.getRenderTarget(),m=this.renderTarget,v=0;v<6;v++)u.setRenderTarget(m,v),u.clear(h,f,d);u.setRenderTarget(p)}}Hr.prototype=Object.create(Q.prototype);Hr.prototype.constructor=Hr;function er(e,t,n){Number.isInteger(t)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),t=n),At.call(this,e,e,t)}er.prototype=Object.create(At.prototype);er.prototype.constructor=er;er.prototype.isWebGLCubeRenderTarget=!0;er.prototype.fromEquirectangularTexture=function(e,t){this.texture.type=t.type,this.texture.format=t.format,this.texture.encoding=t.encoding;var n=new En,i={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","	vWorldDirection = transformDirection( position, modelMatrix );","	#include <begin_vertex>","	#include <project_vertex>","}"].join(`
`),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","	vec3 direction = normalize( vWorldDirection );","	vec2 sampleUV;","	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","	gl_FragColor = texture2D( tEquirect, sampleUV );","}"].join(`
`)},r=new Rt({type:"CubemapFromEquirect",uniforms:Qi(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:mt,blending:Hn});r.uniforms.tEquirect.value=t;var a=new et(new rs(5,5,5),r);n.add(a);var o=new Hr(1,10,1);return o.renderTarget=this,o.renderTarget.texture.name="CubeCameraTexture",o.update(e,n),a.geometry.dispose(),a.material.dispose(),this};function tr(e,t,n,i,r,a,o,s,l,c,u,h){Je.call(this,null,a,o,s,l,c,i,r,u,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=l!==void 0?l:ht,this.minFilter=c!==void 0?c:ht,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}tr.prototype=Object.create(Je.prototype);tr.prototype.constructor=tr;tr.prototype.isDataTexture=!0;var Fi=new ei,Va=new M;function Sa(e,t,n,i,r,a){this.planes=[e!==void 0?e:new sn,t!==void 0?t:new sn,n!==void 0?n:new sn,i!==void 0?i:new sn,r!==void 0?r:new sn,a!==void 0?a:new sn]}Object.assign(Sa.prototype,{set:function(e,t,n,i,r,a){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(r),o[5].copy(a),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=e.elements,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],v=n[13],y=n[14],x=n[15];return t[0].setComponents(o-i,u-s,p-h,x-m).normalize(),t[1].setComponents(o+i,u+s,p+h,x+m).normalize(),t[2].setComponents(o+r,u+l,p+f,x+v).normalize(),t[3].setComponents(o-r,u-l,p-f,x-v).normalize(),t[4].setComponents(o-a,u-c,p-d,x-y).normalize(),t[5].setComponents(o+a,u+c,p+d,x+y).normalize(),this},intersectsObject:function(e){var t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Fi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Fi)},intersectsSprite:function(e){return Fi.center.set(0,0,0),Fi.radius=.7071067811865476,Fi.applyMatrix4(e.matrixWorld),this.intersectsSphere(Fi)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,i=-e.radius,r=0;r<6;r++){var a=t[r].distanceToPoint(n);if(a<i)return!1}return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var i=t[n];if(Va.x=i.normal.x>0?e.max.x:e.min.x,Va.y=i.normal.y>0?e.max.y:e.min.y,Va.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(Va)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var J={common:{diffuse:{value:new ee(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new bt},uv2Transform:{value:new bt},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new U(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ee(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ee(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new bt}},sprite:{diffuse:{value:new ee(15658734)},opacity:{value:1},center:{value:new U(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new bt}}};function oh(){var e=null,t=!1,n=null;function i(r,a){t!==!1&&(n(r,a),e.requestAnimationFrame(i))}return{start:function(){t!==!0&&n!==null&&(e.requestAnimationFrame(i),t=!0)},stop:function(){t=!1},setAnimationLoop:function(r){n=r},setContext:function(r){e=r}}}function Nd(e,t){var n=t.isWebGL2,i=new WeakMap;function r(c,u){var h=c.array,f=c.usage,d=e.createBuffer();e.bindBuffer(u,d),e.bufferData(u,h,f),c.onUploadCallback();var p=5126;return h instanceof Float32Array?p=5126:h instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):h instanceof Uint16Array?p=5123:h instanceof Int16Array?p=5122:h instanceof Uint32Array?p=5125:h instanceof Int32Array?p=5124:h instanceof Int8Array?p=5120:h instanceof Uint8Array&&(p=5121),{buffer:d,type:p,bytesPerElement:h.BYTES_PER_ELEMENT,version:c.version}}function a(c,u,h){var f=u.array,d=u.updateRange;e.bindBuffer(h,c),d.count===-1?e.bufferSubData(h,0,f):(n?e.bufferSubData(h,d.offset*f.BYTES_PER_ELEMENT,f,d.offset,d.count):e.bufferSubData(h,d.offset*f.BYTES_PER_ELEMENT,f.subarray(d.offset,d.offset+d.count)),d.count=-1)}function o(c){return c.isInterleavedBufferAttribute&&(c=c.data),i.get(c)}function s(c){c.isInterleavedBufferAttribute&&(c=c.data);var u=i.get(c);u&&(e.deleteBuffer(u.buffer),i.delete(c))}function l(c,u){c.isInterleavedBufferAttribute&&(c=c.data);var h=i.get(c);h===void 0?i.set(c,r(c,u)):h.version<c.version&&(a(h.buffer,c,u),h.version=c.version)}return{get:o,remove:s,update:l}}function Wr(e,t,n,i){we.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},this.fromBufferGeometry(new nr(e,t,n,i)),this.mergeVertices()}Wr.prototype=Object.create(we.prototype);Wr.prototype.constructor=Wr;function nr(e,t,n,i){ne.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i},e=e||1,t=t||1;var r=e/2,a=t/2,o=Math.floor(n)||1,s=Math.floor(i)||1,l=o+1,c=s+1,u=e/o,h=t/s,f,d,p=[],m=[],v=[],y=[];for(d=0;d<c;d++){var x=d*h-a;for(f=0;f<l;f++){var w=f*u-r;m.push(w,-x,0),v.push(0,0,1),y.push(f/o),y.push(1-d/s)}}for(d=0;d<s;d++)for(f=0;f<o;f++){var S=f+l*d,b=f+l*(d+1),A=f+1+l*(d+1),C=f+1+l*d;p.push(S,b,C),p.push(b,A,C)}this.setIndex(p),this.setAttribute("position",new K(m,3)),this.setAttribute("normal",new K(v,3)),this.setAttribute("uv",new K(y,2))}nr.prototype=Object.create(ne.prototype);nr.prototype.constructor=nr;var Fd=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,Bd=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,kd=`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,zd=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,Ud=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Gd="vec3 transformed = vec3( position );",Vd=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Hd=`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,Wd=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,jd=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;
	}
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;
		}
		if ( clipped ) discard;
	#endif
#endif`,qd=`#if NUM_CLIPPING_PLANES > 0
	#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
		varying vec3 vViewPosition;
	#endif
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Xd=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	varying vec3 vViewPosition;
#endif`,Yd=`#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )
	vViewPosition = - mvPosition.xyz;
#endif`,Zd=`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,Jd=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,$d=`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,Kd=`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,Qd=`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}`,ep=`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);
    } else if (face == 1.0) {
      uv = vec2(direction.x, -direction.z) / abs(direction.y);
    } else if (face == 2.0) {
      uv = direction.xy / abs(direction.z);
    } else if (face == 3.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);
    } else if (face == 4.0) {
      uv = direction.xz / abs(direction.y);
    } else {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);
    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,tp=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	transformedNormal = mat3( instanceMatrix ) * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,np=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,ip=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,rp=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,ap=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,op="gl_FragColor = linearToOutputTexel( gl_FragColor );",sp=`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,lp=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		vec2 sampleUV;
		reflectVec = normalize( reflectVec );
		sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
		sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,cp=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,up=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,hp=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,fp=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,dp=`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,pp=`#ifdef USE_FOG
	varying float fogDepth;
#endif`,mp=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,vp=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gp=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,yp=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,xp=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,_p=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
#endif`,wp=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
		float shadowCameraNear;
		float shadowCameraFar;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
		int shadow;
		float shadowBias;
		float shadowRadius;
		vec2 shadowMapSize;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,bp=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV;
			sampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
			sampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,Mp=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Sp=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,Ep=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,Tp=`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,Ap=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = saturate( clearcoat );	material.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,Lp=`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,Cp=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,Rp=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,Pp=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Ip=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Dp=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Op=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Np=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Fp=`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,Bp=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,kp=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,zp=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Up=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Gp=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Vp=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,Hp=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,Wp=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,jp=`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,qp=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,Xp=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,Yp=`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Zp=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,Jp=`#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,$p=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Kp=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Qp=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,em=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,tm=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,nm=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,im=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,rm=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,am=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,om=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#endif
#endif`,sm=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLight directionalLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLights[ i ];
		shadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLight spotLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLights[ i ];
		shadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLight pointLight;
	#pragma unroll_loop
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLights[ i ];
		shadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#endif
	#endif
	return shadow;
}`,lm=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,cm=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,um=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,hm=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,fm=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,dm=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,pm=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,mm=`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,vm=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,gm=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,ym=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,xm=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,_m=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,wm=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,bm=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,Mm=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Sm=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Em=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Tm=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Am=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( gl_FragCoord.z );
	#endif
}`,Lm=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
}`,Cm=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Rm=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Pm=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV;
	sampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,Im=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Dm=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Om=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	vLineDistance = scale * lineDistance;
	vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Nm=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Fm=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Bm=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	reflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,km=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zm=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Um=`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Gm=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Vm=`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Hm=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Wm=`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jm=`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_normalmap_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,qm=`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Xm=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,Ym=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,Zm=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Jm=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,$m=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Km=`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Qm=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,ev=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pe={alphamap_fragment:Fd,alphamap_pars_fragment:Bd,alphatest_fragment:kd,aomap_fragment:zd,aomap_pars_fragment:Ud,begin_vertex:Gd,beginnormal_vertex:Vd,bsdfs:Hd,bumpmap_pars_fragment:Wd,clipping_planes_fragment:jd,clipping_planes_pars_fragment:qd,clipping_planes_pars_vertex:Xd,clipping_planes_vertex:Yd,color_fragment:Zd,color_pars_fragment:Jd,color_pars_vertex:$d,color_vertex:Kd,common:Qd,cube_uv_reflection_fragment:ep,defaultnormal_vertex:tp,displacementmap_pars_vertex:np,displacementmap_vertex:ip,emissivemap_fragment:rp,emissivemap_pars_fragment:ap,encodings_fragment:op,encodings_pars_fragment:sp,envmap_fragment:lp,envmap_common_pars_fragment:cp,envmap_pars_fragment:up,envmap_pars_vertex:hp,envmap_physical_pars_fragment:bp,envmap_vertex:fp,fog_vertex:dp,fog_pars_vertex:pp,fog_fragment:mp,fog_pars_fragment:vp,gradientmap_pars_fragment:gp,lightmap_fragment:yp,lightmap_pars_fragment:xp,lights_lambert_vertex:_p,lights_pars_begin:wp,lights_toon_fragment:Mp,lights_toon_pars_fragment:Sp,lights_phong_fragment:Ep,lights_phong_pars_fragment:Tp,lights_physical_fragment:Ap,lights_physical_pars_fragment:Lp,lights_fragment_begin:Cp,lights_fragment_maps:Rp,lights_fragment_end:Pp,logdepthbuf_fragment:Ip,logdepthbuf_pars_fragment:Dp,logdepthbuf_pars_vertex:Op,logdepthbuf_vertex:Np,map_fragment:Fp,map_pars_fragment:Bp,map_particle_fragment:kp,map_particle_pars_fragment:zp,metalnessmap_fragment:Up,metalnessmap_pars_fragment:Gp,morphnormal_vertex:Vp,morphtarget_pars_vertex:Hp,morphtarget_vertex:Wp,normal_fragment_begin:jp,normal_fragment_maps:qp,normalmap_pars_fragment:Xp,clearcoat_normal_fragment_begin:Yp,clearcoat_normal_fragment_maps:Zp,clearcoat_normalmap_pars_fragment:Jp,packing:$p,premultiplied_alpha_fragment:Kp,project_vertex:Qp,dithering_fragment:em,dithering_pars_fragment:tm,roughnessmap_fragment:nm,roughnessmap_pars_fragment:im,shadowmap_pars_fragment:rm,shadowmap_pars_vertex:am,shadowmap_vertex:om,shadowmask_pars_fragment:sm,skinbase_vertex:lm,skinning_pars_vertex:cm,skinning_vertex:um,skinnormal_vertex:hm,specularmap_fragment:fm,specularmap_pars_fragment:dm,tonemapping_fragment:pm,tonemapping_pars_fragment:mm,uv_pars_fragment:vm,uv_pars_vertex:gm,uv_vertex:ym,uv2_pars_fragment:xm,uv2_pars_vertex:_m,uv2_vertex:wm,worldpos_vertex:bm,background_frag:Mm,background_vert:Sm,cube_frag:Em,cube_vert:Tm,depth_frag:Am,depth_vert:Lm,distanceRGBA_frag:Cm,distanceRGBA_vert:Rm,equirect_frag:Pm,equirect_vert:Im,linedashed_frag:Dm,linedashed_vert:Om,meshbasic_frag:Nm,meshbasic_vert:Fm,meshlambert_frag:Bm,meshlambert_vert:km,meshmatcap_frag:zm,meshmatcap_vert:Um,meshtoon_frag:Gm,meshtoon_vert:Vm,meshphong_frag:Hm,meshphong_vert:Wm,meshphysical_frag:jm,meshphysical_vert:qm,normal_frag:Xm,normal_vert:Ym,points_frag:Zm,points_vert:Jm,shadow_frag:$m,shadow_vert:Km,sprite_frag:Qm,sprite_vert:ev},Sn={basic:{uniforms:wt([J.common,J.specularmap,J.envmap,J.aomap,J.lightmap,J.fog]),vertexShader:Pe.meshbasic_vert,fragmentShader:Pe.meshbasic_frag},lambert:{uniforms:wt([J.common,J.specularmap,J.envmap,J.aomap,J.lightmap,J.emissivemap,J.fog,J.lights,{emissive:{value:new ee(0)}}]),vertexShader:Pe.meshlambert_vert,fragmentShader:Pe.meshlambert_frag},phong:{uniforms:wt([J.common,J.specularmap,J.envmap,J.aomap,J.lightmap,J.emissivemap,J.bumpmap,J.normalmap,J.displacementmap,J.fog,J.lights,{emissive:{value:new ee(0)},specular:{value:new ee(1118481)},shininess:{value:30}}]),vertexShader:Pe.meshphong_vert,fragmentShader:Pe.meshphong_frag},standard:{uniforms:wt([J.common,J.envmap,J.aomap,J.lightmap,J.emissivemap,J.bumpmap,J.normalmap,J.displacementmap,J.roughnessmap,J.metalnessmap,J.fog,J.lights,{emissive:{value:new ee(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Pe.meshphysical_vert,fragmentShader:Pe.meshphysical_frag},toon:{uniforms:wt([J.common,J.specularmap,J.aomap,J.lightmap,J.emissivemap,J.bumpmap,J.normalmap,J.displacementmap,J.gradientmap,J.fog,J.lights,{emissive:{value:new ee(0)},specular:{value:new ee(1118481)},shininess:{value:30}}]),vertexShader:Pe.meshtoon_vert,fragmentShader:Pe.meshtoon_frag},matcap:{uniforms:wt([J.common,J.bumpmap,J.normalmap,J.displacementmap,J.fog,{matcap:{value:null}}]),vertexShader:Pe.meshmatcap_vert,fragmentShader:Pe.meshmatcap_frag},points:{uniforms:wt([J.points,J.fog]),vertexShader:Pe.points_vert,fragmentShader:Pe.points_frag},dashed:{uniforms:wt([J.common,J.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pe.linedashed_vert,fragmentShader:Pe.linedashed_frag},depth:{uniforms:wt([J.common,J.displacementmap]),vertexShader:Pe.depth_vert,fragmentShader:Pe.depth_frag},normal:{uniforms:wt([J.common,J.bumpmap,J.normalmap,J.displacementmap,{opacity:{value:1}}]),vertexShader:Pe.normal_vert,fragmentShader:Pe.normal_frag},sprite:{uniforms:wt([J.sprite,J.fog]),vertexShader:Pe.sprite_vert,fragmentShader:Pe.sprite_frag},background:{uniforms:{uvTransform:{value:new bt},t2D:{value:null}},vertexShader:Pe.background_vert,fragmentShader:Pe.background_frag},cube:{uniforms:wt([J.envmap,{opacity:{value:1}}]),vertexShader:Pe.cube_vert,fragmentShader:Pe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pe.equirect_vert,fragmentShader:Pe.equirect_frag},distanceRGBA:{uniforms:wt([J.common,J.displacementmap,{referencePosition:{value:new M},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pe.distanceRGBA_vert,fragmentShader:Pe.distanceRGBA_frag},shadow:{uniforms:wt([J.lights,J.fog,{color:{value:new ee(0)},opacity:{value:1}}]),vertexShader:Pe.shadow_vert,fragmentShader:Pe.shadow_frag}};Sn.physical={uniforms:wt([Sn.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ee(0)},clearcoatNormalScale:{value:new U(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:Pe.meshphysical_vert,fragmentShader:Pe.meshphysical_frag};function tv(e,t,n,i){var r=new ee(0),a=0,o,s,l=null,c=0,u=null;function h(d,p,m,v){var y=p.background,x=e.xr,w=x.getSession&&x.getSession();if(w&&w.environmentBlendMode==="additive"&&(y=null),y===null?f(r,a):y&&y.isColor&&(f(y,1),v=!0),(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),y&&(y.isCubeTexture||y.isWebGLCubeRenderTarget||y.mapping===Ma)){s===void 0&&(s=new et(new rs(1,1,1),new Rt({type:"BackgroundCubeMaterial",uniforms:Qi(Sn.cube.uniforms),vertexShader:Sn.cube.vertexShader,fragmentShader:Sn.cube.fragmentShader,side:mt,depthTest:!1,depthWrite:!1,fog:!1})),s.geometry.deleteAttribute("normal"),s.geometry.deleteAttribute("uv"),s.onBeforeRender=function(b,A,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(s.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(s));var S=y.isWebGLCubeRenderTarget?y.texture:y;s.material.uniforms.envMap.value=S,s.material.uniforms.flipEnvMap.value=S.isCubeTexture?-1:1,(l!==y||c!==S.version||u!==e.toneMapping)&&(s.material.needsUpdate=!0,l=y,c=S.version,u=e.toneMapping),d.unshift(s,s.geometry,s.material,0,0,null)}else y&&y.isTexture&&(o===void 0&&(o=new et(new nr(2,2),new Rt({type:"BackgroundMaterial",uniforms:Qi(Sn.background.uniforms),vertexShader:Sn.background.vertexShader,fragmentShader:Sn.background.fragmentShader,side:wa,depthTest:!1,depthWrite:!1,fog:!1})),o.geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(o)),o.material.uniforms.t2D.value=y,y.matrixAutoUpdate===!0&&y.updateMatrix(),o.material.uniforms.uvTransform.value.copy(y.matrix),(l!==y||c!==y.version||u!==e.toneMapping)&&(o.material.needsUpdate=!0,l=y,c=y.version,u=e.toneMapping),d.unshift(o,o.geometry,o.material,0,0,null))}function f(d,p){t.buffers.color.setClear(d.r,d.g,d.b,p,i)}return{getClearColor:function(){return r},setClearColor:function(d,p){r.set(d),a=p!==void 0?p:1,f(r,a)},getClearAlpha:function(){return a},setClearAlpha:function(d){a=d,f(r,a)},render:h}}function nv(e,t,n,i){var r=i.isWebGL2,a;function o(c){a=c}function s(c,u){e.drawArrays(a,c,u),n.update(u,a)}function l(c,u,h,f){if(f!==0){var d,p;if(r)d=e,p="drawArraysInstanced";else if(d=t.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[p](a,u,h,f),n.update(h,a,f)}}this.setMode=o,this.render=s,this.renderInstances=l}function iv(e,t,n){var i;function r(){if(i!==void 0)return i;var A=t.get("EXT_texture_filter_anisotropic");return A!==null?i=e.getParameter(A.MAX_TEXTURE_MAX_ANISOTROPY_EXT):i=0,i}function a(A){if(A==="highp"){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";A="mediump"}return A==="mediump"&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var o=typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&e instanceof WebGL2ComputeRenderingContext,s=n.precision!==void 0?n.precision:"highp",l=a(s);l!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",l,"instead."),s=l);var c=n.logarithmicDepthBuffer===!0,u=e.getParameter(34930),h=e.getParameter(35660),f=e.getParameter(3379),d=e.getParameter(34076),p=e.getParameter(34921),m=e.getParameter(36347),v=e.getParameter(36348),y=e.getParameter(36349),x=h>0,w=o||!!t.get("OES_texture_float"),S=x&&w,b=o?e.getParameter(36183):0;return{isWebGL2:o,getMaxAnisotropy:r,getMaxPrecision:a,precision:s,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:d,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:y,vertexTextures:x,floatFragmentTextures:w,floatVertexTextures:S,maxSamples:b}}function rv(){var e=this,t=null,n=0,i=!1,r=!1,a=new sn,o=new bt,s={value:null,needsUpdate:!1};this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(u,h,f){var d=u.length!==0||h||n!==0||i;return i=h,t=c(u,f,0),n=u.length,d},this.beginShadows=function(){r=!0,c(null)},this.endShadows=function(){r=!1,l()},this.setState=function(u,h,f,d,p,m){if(!i||u===null||u.length===0||r&&!f)r?c(null):l();else{var v=r?0:n,y=v*4,x=p.clippingState||null;s.value=x,x=c(u,d,y,m);for(var w=0;w!==y;++w)x[w]=t[w];p.clippingState=x,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=v}};function l(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function c(u,h,f,d){var p=u!==null?u.length:0,m=null;if(p!==0){if(m=s.value,d!==!0||m===null){var v=f+p*4,y=h.matrixWorldInverse;o.getNormalMatrix(y),(m===null||m.length<v)&&(m=new Float32Array(v));for(var x=0,w=f;x!==p;++x,w+=4)a.copy(u[x]).applyMatrix4(y,o),a.normal.toArray(m,w),m[w+3]=a.constant}s.value=m,s.needsUpdate=!0}return e.numPlanes=p,m}}function av(e){var t={};return{get:function(n){if(t[n]!==void 0)return t[n];var i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return i===null&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),t[n]=i,i}}}function ov(e,t,n){var i=new WeakMap,r=new WeakMap;function a(u){var h=u.target,f=i.get(h);f.index!==null&&t.remove(f.index);for(var d in f.attributes)t.remove(f.attributes[d]);h.removeEventListener("dispose",a),i.delete(h);var p=r.get(f);p&&(t.remove(p),r.delete(f)),n.memory.geometries--}function o(u,h){var f=i.get(h);return f||(h.addEventListener("dispose",a),h.isBufferGeometry?f=h:h.isGeometry&&(h._bufferGeometry===void 0&&(h._bufferGeometry=new ne().setFromObject(u)),f=h._bufferGeometry),i.set(h,f),n.memory.geometries++,f)}function s(u){var h=u.index,f=u.attributes;h!==null&&t.update(h,34963);for(var d in f)t.update(f[d],34962);var p=u.morphAttributes;for(var d in p)for(var m=p[d],v=0,y=m.length;v<y;v++)t.update(m[v],34962)}function l(u){var h=[],f=u.index,d=u.attributes.position,p=0;if(f!==null){var m=f.array;p=f.version;for(var v=0,y=m.length;v<y;v+=3){var x=m[v+0],w=m[v+1],S=m[v+2];h.push(x,w,w,S,S,x)}}else{var m=d.array;p=d.version;for(var v=0,y=m.length/3-1;v<y;v+=3){var x=v+0,w=v+1,S=v+2;h.push(x,w,w,S,S,x)}}var b=new(ih(h)>65535?Vr:Gr)(h,1);b.version=p,t.update(b,34963);var A=r.get(u);A&&t.remove(A),r.set(u,b)}function c(u){var h=r.get(u);if(h){var f=u.index;f!==null&&h.version<f.version&&l(u)}else l(u);return r.get(u)}return{get:o,update:s,getWireframeAttribute:c}}function sv(e,t,n,i){var r=i.isWebGL2,a;function o(f){a=f}var s,l;function c(f){s=f.type,l=f.bytesPerElement}function u(f,d){e.drawElements(a,d,s,f*l),n.update(d,a)}function h(f,d,p,m){if(m!==0){var v,y;if(r)v=e,y="drawElementsInstanced";else if(v=t.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",v===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[y](a,p,s,d*l,m),n.update(p,a,m)}}this.setMode=o,this.setIndex=c,this.render=u,this.renderInstances=h}function lv(e){var t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(a,o,s){switch(s=s||1,n.calls++,o){case 4:n.triangles+=s*(a/3);break;case 1:n.lines+=s*(a/2);break;case 3:n.lines+=s*(a-1);break;case 2:n.lines+=s*a;break;case 0:n.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:r,update:i}}function cv(e,t){return Math.abs(t[1])-Math.abs(e[1])}function uv(e){var t={},n=new Float32Array(8);function i(r,a,o,s){var l=r.morphTargetInfluences,c=l===void 0?0:l.length,u=t[a.id];if(u===void 0){u=[];for(var h=0;h<c;h++)u[h]=[h,0];t[a.id]=u}for(var f=o.morphTargets&&a.morphAttributes.position,d=o.morphNormals&&a.morphAttributes.normal,h=0;h<c;h++){var p=u[h];p[1]!==0&&(f&&a.deleteAttribute("morphTarget"+h),d&&a.deleteAttribute("morphNormal"+h))}for(var h=0;h<c;h++){var p=u[h];p[0]=h,p[1]=l[h]}u.sort(cv);for(var m=0,h=0;h<8;h++){var p=u[h];if(p){var v=p[0],y=p[1];if(y){f&&a.setAttribute("morphTarget"+h,f[v]),d&&a.setAttribute("morphNormal"+h,d[v]),n[h]=y,m+=y;continue}}n[h]=0}var x=a.morphTargetsRelative?1:1-m;s.getUniforms().setValue(e,"morphTargetBaseInfluence",x),s.getUniforms().setValue(e,"morphTargetInfluences",n)}return{update:i}}function hv(e,t,n,i){var r={};function a(s){var l=i.render.frame,c=s.geometry,u=t.get(s,c);return r[u.id]!==l&&(c.isGeometry&&u.updateFromObject(s),t.update(u),r[u.id]=l),s.isInstancedMesh&&n.update(s.instanceMatrix,34962),u}function o(){r={}}return{update:a,dispose:o}}function Yn(e,t,n,i,r,a,o,s,l,c){e=e!==void 0?e:[],t=t!==void 0?t:zl,o=o!==void 0?o:mi,Je.call(this,e,t,n,i,r,a,o,s,l,c),this.flipY=!1}Yn.prototype=Object.create(Je.prototype);Yn.prototype.constructor=Yn;Yn.prototype.isCubeTexture=!0;Object.defineProperty(Yn.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});function jr(e,t,n,i){Je.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=ht,this.minFilter=ht,this.wrapR=Ct,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}jr.prototype=Object.create(Je.prototype);jr.prototype.constructor=jr;jr.prototype.isDataTexture2DArray=!0;function qr(e,t,n,i){Je.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:i||1},this.magFilter=ht,this.minFilter=ht,this.wrapR=Ct,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}qr.prototype=Object.create(Je.prototype);qr.prototype.constructor=qr;qr.prototype.isDataTexture3D=!0;var sh=new Je,fv=new jr,dv=new qr,lh=new Yn,Cc=[],Rc=[],Pc=new Float32Array(16),Ic=new Float32Array(9),Dc=new Float32Array(4);function _r(e,t,n){var i=e[0];if(i<=0||i>0)return e;var r=t*n,a=Cc[r];if(a===void 0&&(a=new Float32Array(r),Cc[r]=a),t!==0){i.toArray(a,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(a,s)}return a}function Ht(e,t){if(e.length!==t.length)return!1;for(var n=0,i=e.length;n<i;n++)if(e[n]!==t[n])return!1;return!0}function Bt(e,t){for(var n=0,i=t.length;n<i;n++)e[n]=t[n]}function ch(e,t){var n=Rc[t];n===void 0&&(n=new Int32Array(t),Rc[t]=n);for(var i=0;i!==t;++i)n[i]=e.allocateTextureUnit();return n}function pv(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function mv(e,t){var n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Ht(n,t))return;e.uniform2fv(this.addr,t),Bt(n,t)}}function vv(e,t){var n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Ht(n,t))return;e.uniform3fv(this.addr,t),Bt(n,t)}}function gv(e,t){var n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Ht(n,t))return;e.uniform4fv(this.addr,t),Bt(n,t)}}function yv(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(Ht(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Bt(n,t)}else{if(Ht(n,i))return;Dc.set(i),e.uniformMatrix2fv(this.addr,!1,Dc),Bt(n,i)}}function xv(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(Ht(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Bt(n,t)}else{if(Ht(n,i))return;Ic.set(i),e.uniformMatrix3fv(this.addr,!1,Ic),Bt(n,i)}}function _v(e,t){var n=this.cache,i=t.elements;if(i===void 0){if(Ht(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Bt(n,t)}else{if(Ht(n,i))return;Pc.set(i),e.uniformMatrix4fv(this.addr,!1,Pc),Bt(n,i)}}function wv(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTexture2D(t||sh,r)}function bv(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture2DArray(t||fv,r)}function Mv(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.setTexture3D(t||dv,r)}function Sv(e,t,n){var i=this.cache,r=n.allocateTextureUnit();i[0]!==r&&(e.uniform1i(this.addr,r),i[0]=r),n.safeSetTextureCube(t||lh,r)}function Ev(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Tv(e,t){var n=this.cache;Ht(n,t)||(e.uniform2iv(this.addr,t),Bt(n,t))}function Av(e,t){var n=this.cache;Ht(n,t)||(e.uniform3iv(this.addr,t),Bt(n,t))}function Lv(e,t){var n=this.cache;Ht(n,t)||(e.uniform4iv(this.addr,t),Bt(n,t))}function Cv(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Rv(e){switch(e){case 5126:return pv;case 35664:return mv;case 35665:return vv;case 35666:return gv;case 35674:return yv;case 35675:return xv;case 35676:return _v;case 5124:case 35670:return Ev;case 35667:case 35671:return Tv;case 35668:case 35672:return Av;case 35669:case 35673:return Lv;case 5125:return Cv;case 35678:case 36198:case 36298:case 36306:case 35682:return wv;case 35679:case 36299:case 36307:return Mv;case 35680:case 36300:case 36308:case 36293:return Sv;case 36289:case 36303:case 36311:case 36292:return bv}}function Pv(e,t){e.uniform1fv(this.addr,t)}function Iv(e,t){e.uniform1iv(this.addr,t)}function Dv(e,t){e.uniform2iv(this.addr,t)}function Ov(e,t){e.uniform3iv(this.addr,t)}function Nv(e,t){e.uniform4iv(this.addr,t)}function Fv(e,t){var n=_r(t,this.size,2);e.uniform2fv(this.addr,n)}function Bv(e,t){var n=_r(t,this.size,3);e.uniform3fv(this.addr,n)}function kv(e,t){var n=_r(t,this.size,4);e.uniform4fv(this.addr,n)}function zv(e,t){var n=_r(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Uv(e,t){var n=_r(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Gv(e,t){var n=_r(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Vv(e,t,n){var i=t.length,r=ch(n,i);e.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTexture2D(t[a]||sh,r[a])}function Hv(e,t,n){var i=t.length,r=ch(n,i);e.uniform1iv(this.addr,r);for(var a=0;a!==i;++a)n.safeSetTextureCube(t[a]||lh,r[a])}function Wv(e){switch(e){case 5126:return Pv;case 35664:return Fv;case 35665:return Bv;case 35666:return kv;case 35674:return zv;case 35675:return Uv;case 35676:return Gv;case 5124:case 35670:return Iv;case 35667:case 35671:return Dv;case 35668:case 35672:return Ov;case 35669:case 35673:return Nv;case 35678:case 36198:case 36298:case 36306:case 35682:return Vv;case 35680:case 36300:case 36308:case 36293:return Hv}}function jv(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=Rv(t.type)}function uh(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=Wv(t.type)}uh.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Bt(t,e)};function hh(e){this.id=e,this.seq=[],this.map={}}hh.prototype.setValue=function(e,t,n){for(var i=this.seq,r=0,a=i.length;r!==a;++r){var o=i[r];o.setValue(e,t[o.id],n)}};var Ls=/([\w\d_]+)(\])?(\[|\.)?/g;function Oc(e,t){e.seq.push(t),e.map[t.id]=t}function qv(e,t,n){var i=e.name,r=i.length;for(Ls.lastIndex=0;;){var a=Ls.exec(i),o=Ls.lastIndex,s=a[1],l=a[2]==="]",c=a[3];if(l&&(s=s|0),c===void 0||c==="["&&o+2===r){Oc(n,c===void 0?new jv(s,e,t):new uh(s,e,t));break}else{var u=n.map,h=u[s];h===void 0&&(h=new hh(s),Oc(n,h)),n=h}}}function Wn(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),i=0;i<n;++i){var r=e.getActiveUniform(t,i),a=e.getUniformLocation(t,r.name);qv(r,a,this)}}Wn.prototype.setValue=function(e,t,n,i){var r=this.map[t];r!==void 0&&r.setValue(e,n,i)};Wn.prototype.setOptional=function(e,t,n){var i=t[n];i!==void 0&&this.setValue(e,n,i)};Wn.upload=function(e,t,n,i){for(var r=0,a=t.length;r!==a;++r){var o=t[r],s=n[o.id];s.needsUpdate!==!1&&o.setValue(e,s.value,i)}};Wn.seqWithValue=function(e,t){for(var n=[],i=0,r=e.length;i!==r;++i){var a=e[i];a.id in t&&n.push(a)}return n};function Nc(e,t,n){var i=e.createShader(t);return e.shaderSource(i,n),e.compileShader(i),i}var Xv=0;function Yv(e){for(var t=e.split(`
`),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join(`
`)}function fh(e){switch(e){case Ft:return["Linear","( value )"];case Wl:return["sRGB","( value )"];case jl:return["RGBE","( value )"];case $u:return["RGBM","( value, 7.0 )"];case Ku:return["RGBM","( value, 16.0 )"];case Qu:return["RGBD","( value, 256.0 )"];case Ju:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case dd:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function Fc(e,t,n){var i=e.getShaderParameter(t,35713),r=e.getShaderInfoLog(t).trim();if(i&&r==="")return"";var a=e.getShaderSource(t);return"THREE.WebGLShader: gl.getShaderInfoLog() "+n+`
`+r+Yv(a)}function Tr(e,t){var n=fh(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Zv(e,t){var n=fh(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Jv(e,t){var n;switch(t){case Bl:n="Linear";break;case Lf:n="Reinhard";break;case Cf:n="Uncharted2";break;case Rf:n="OptimizedCineon";break;case Pf:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function $v(e){var t=[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||e.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return t.filter(Ir).join(`
`)}function Kv(e){var t=[];for(var n in e){var i=e[n];i!==!1&&t.push("#define "+n+" "+i)}return t.join(`
`)}function Qv(e,t){for(var n={},i=e.getProgramParameter(t,35721),r=0;r<i;r++){var a=e.getActiveAttrib(t,r),o=a.name;n[o]=e.getAttribLocation(t,o)}return n}function Ir(e){return e!==""}function Bc(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function kc(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var eg=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ys(e){return e.replace(eg,tg)}function tg(e,t){var n=Pe[t];if(n===void 0)throw new Error("Can not resolve #include <"+t+">");return Ys(n)}var ng=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function zc(e){return e.replace(ng,ig)}function ig(e,t,n,i){for(var r="",a=parseInt(t);a<parseInt(n);a++)r+=i.replace(/\[ i \]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return r}function Uc(e){var t="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function rg(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===Gu?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===af?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===Pr&&(t="SHADOWMAP_TYPE_VSM"),t}function ag(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case zl:case Ul:t="ENVMAP_TYPE_CUBE";break;case Ma:case Vl:t="ENVMAP_TYPE_CUBE_UV";break;case qu:case Gl:t="ENVMAP_TYPE_EQUIREC";break;case Xu:t="ENVMAP_TYPE_SPHERE";break}return t}function og(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Ul:case Gl:t="ENVMAP_MODE_REFRACTION";break}return t}function sg(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case es:t="ENVMAP_BLENDING_MULTIPLY";break;case Tf:t="ENVMAP_BLENDING_MIX";break;case Af:t="ENVMAP_BLENDING_ADD";break}return t}function lg(e,t,n){var i=e.getContext(),r=n.defines,a=n.vertexShader,o=n.fragmentShader,s=rg(n),l=ag(n),c=og(n),u=sg(n),h=e.gammaFactor>0?e.gammaFactor:1,f=n.isWebGL2?"":$v(n),d=Kv(r),p=i.createProgram(),m,v,y=n.numMultiviewViews;if(n.isRawShaderMaterial?(m=[d].filter(Ir).join(`
`),m.length>0&&(m+=`
`),v=[f,d].filter(Ir).join(`
`),v.length>0&&(v+=`
`)):(m=[Uc(n),"#define SHADER_NAME "+n.shaderName,d,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+h,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+s:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Ir).join(`
`),v=[f,Uc(n),"#define SHADER_NAME "+n.shaderName,d,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+h,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+s:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==lo?"#define TONE_MAPPING":"",n.toneMapping!==lo?Pe.tonemapping_pars_fragment:"",n.toneMapping!==lo?Jv("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Pe.encodings_pars_fragment:"",n.mapEncoding?Tr("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?Tr("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?Tr("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?Tr("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?Tr("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?Zv("linearToOutputTexel",n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Ir).join(`
`)),a=Ys(a),a=Bc(a,n),a=kc(a,n),o=Ys(o),o=Bc(o,n),o=kc(o,n),a=zc(a),o=zc(o),n.isWebGL2&&!n.isRawShaderMaterial){var x=!1,w=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&a.match(w)!==null&&o.match(w)!==null&&(x=!0,a=a.replace(w,""),o=o.replace(w,"")),m=[`#version 300 es
`,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+m,v=[`#version 300 es
`,"#define varying in",x?"":"out highp vec4 pc_fragColor;",x?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+v,y>0&&(m=m.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","layout(num_views = "+y+") in;","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),m=m.replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join(`
`),["uniform mat4 modelViewMatrices["+y+"];","uniform mat4 projectionMatrices["+y+"];","uniform mat4 viewMatrices["+y+"];","uniform mat3 normalMatrices["+y+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join(`
`)),v=v.replace(`#version 300 es
`,[`#version 300 es
`,"#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join(`
`)),v=v.replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+y+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join(`
`)))}var S=m+a,b=v+o,A=Nc(i,35633,S),C=Nc(i,35632,b);if(i.attachShader(p,A),i.attachShader(p,C),n.index0AttributeName!==void 0?i.bindAttribLocation(p,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(p,0,"position"),i.linkProgram(p),e.debug.checkShaderErrors){var T=i.getProgramInfoLog(p).trim(),I=i.getShaderInfoLog(A).trim(),D=i.getShaderInfoLog(C).trim(),B=!0,O=!0;if(i.getProgramParameter(p,35714)===!1){B=!1;var F=Fc(i,A,"vertex"),N=Fc(i,C,"fragment");console.error("THREE.WebGLProgram: shader error: ",i.getError(),"35715",i.getProgramParameter(p,35715),"gl.getProgramInfoLog",T,F,N)}else T!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",T):(I===""||D==="")&&(O=!1);O&&(this.diagnostics={runnable:B,programLog:T,vertexShader:{log:I,prefix:m},fragmentShader:{log:D,prefix:v}})}i.deleteShader(A),i.deleteShader(C);var k;this.getUniforms=function(){return k===void 0&&(k=new Wn(i,p)),k};var V;return this.getAttributes=function(){return V===void 0&&(V=Qv(i,p)),V},this.destroy=function(){i.deleteProgram(p),this.program=void 0},this.name=n.shaderName,this.id=Xv++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=A,this.fragmentShader=C,this.numMultiviewViews=y,this}function cg(e,t,n){var i=[],r=n.isWebGL2,a=n.logarithmicDepthBuffer,o=n.floatVertexTextures,s=n.precision,l=n.maxVertexUniforms,c=n.vertexTextures,u={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(m,v){var y;if(v){var x=Sn[v];y={name:m.type,uniforms:Id.clone(x.uniforms),vertexShader:x.vertexShader,fragmentShader:x.fragmentShader}}else y={name:m.type,uniforms:m.uniforms,vertexShader:m.vertexShader,fragmentShader:m.fragmentShader};return y}function d(m){var v=m.skeleton,y=v.bones;if(o)return 1024;var x=l,w=Math.floor((x-20)/4),S=Math.min(w,y.length);return S<y.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+y.length+" bones. This GPU supports "+S+"."),0):S}function p(m){var v;return m?m.isTexture?v=m.encoding:m.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),v=m.texture.encoding):v=Ft,v}this.getParameters=function(m,v,y,x,w,S,b){var A=x.fog,C=m.isMeshStandardMaterial?x.environment:null,T=m.envMap||C,I=u[m.type],D=b.isSkinnedMesh?d(b):0;m.precision!==null&&(s=n.getMaxPrecision(m.precision),s!==m.precision&&console.warn("THREE.WebGLProgram.getParameters:",m.precision,"not supported, using",s,"instead."));var B=f(m,I);m.onBeforeCompile(B,e);var O=e.getRenderTarget(),F=O&&O.isWebGLMultiviewRenderTarget?O.numViews:0,N={isWebGL2:r,shaderID:I,shaderName:B.name,uniforms:B.uniforms,vertexShader:B.vertexShader,fragmentShader:B.fragmentShader,defines:m.defines,isRawShaderMaterial:m.isRawShaderMaterial,isShaderMaterial:m.isShaderMaterial,precision:s,instancing:b.isInstancedMesh===!0,supportsVertexTextures:c,numMultiviewViews:F,outputEncoding:O!==null?p(O.texture):e.outputEncoding,map:!!m.map,mapEncoding:p(m.map),matcap:!!m.matcap,matcapEncoding:p(m.matcap),envMap:!!T,envMapMode:T&&T.mapping,envMapEncoding:p(T),envMapCubeUV:!!T&&(T.mapping===Ma||T.mapping===Vl),lightMap:!!m.lightMap,lightMapEncoding:p(m.lightMap),aoMap:!!m.aoMap,emissiveMap:!!m.emissiveMap,emissiveMapEncoding:p(m.emissiveMap),bumpMap:!!m.bumpMap,normalMap:!!m.normalMap,objectSpaceNormalMap:m.normalMapType===vd,tangentSpaceNormalMap:m.normalMapType===gr,clearcoatNormalMap:!!m.clearcoatNormalMap,displacementMap:!!m.displacementMap,roughnessMap:!!m.roughnessMap,metalnessMap:!!m.metalnessMap,specularMap:!!m.specularMap,alphaMap:!!m.alphaMap,gradientMap:!!m.gradientMap,sheen:!!m.sheen,combine:m.combine,vertexTangents:m.normalMap&&m.vertexTangents,vertexColors:m.vertexColors,vertexUvs:!!m.map||!!m.bumpMap||!!m.normalMap||!!m.specularMap||!!m.alphaMap||!!m.emissiveMap||!!m.roughnessMap||!!m.metalnessMap||!!m.clearcoatNormalMap||!!m.displacementMap,uvsVertexOnly:!(m.map||m.bumpMap||m.normalMap||m.specularMap||m.alphaMap||m.emissiveMap||m.roughnessMap||m.metalnessMap||m.clearcoatNormalMap)&&!!m.displacementMap,fog:!!A,useFog:m.fog,fogExp2:A&&A.isFogExp2,flatShading:m.flatShading,sizeAttenuation:m.sizeAttenuation,logarithmicDepthBuffer:a,skinning:m.skinning&&D>0,maxBones:D,useVertexTexture:o,morphTargets:m.morphTargets,morphNormals:m.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:v.directional.length,numPointLights:v.point.length,numSpotLights:v.spot.length,numRectAreaLights:v.rectArea.length,numHemiLights:v.hemi.length,numDirLightShadows:v.directionalShadowMap.length,numPointLightShadows:v.pointShadowMap.length,numSpotLightShadows:v.spotShadowMap.length,numClippingPlanes:w,numClipIntersection:S,dithering:m.dithering,shadowMapEnabled:e.shadowMap.enabled&&y.length>0,shadowMapType:e.shadowMap.type,toneMapping:m.toneMapped?e.toneMapping:lo,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:m.premultipliedAlpha,alphaTest:m.alphaTest,doubleSided:m.side===Qo,flipSided:m.side===mt,depthPacking:m.depthPacking!==void 0?m.depthPacking:!1,index0AttributeName:m.index0AttributeName,extensionDerivatives:m.extensions&&m.extensions.derivatives,extensionFragDepth:m.extensions&&m.extensions.frawbuffers,extensionDrawbuffers:m.extensions&&m.extensions.drawbuffers,extensionShaderTextureLOD:m.extensions&&m.extensions.shaderTextureLOD,rendererExtensionFragDepth:r||t.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:r||t.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:r||t.get("EXT_shader_texture_lod")!==null,onBeforeCompile:m.onBeforeCompile};return N},this.getProgramCacheKey=function(m){var v=[];if(m.shaderID?v.push(m.shaderID):(v.push(m.fragmentShader),v.push(m.vertexShader)),m.defines!==void 0)for(var y in m.defines)v.push(y),v.push(m.defines[y]);if(m.isRawShaderMaterial===void 0){for(var x=0;x<h.length;x++)v.push(m[h[x]]);v.push(e.outputEncoding),v.push(e.gammaFactor)}return v.push(m.onBeforeCompile.toString()),v.join()},this.acquireProgram=function(m,v){for(var y,x=0,w=i.length;x<w;x++){var S=i[x];if(S.cacheKey===v){y=S,++y.usedTimes;break}}return y===void 0&&(y=new lg(e,v,m),i.push(y)),y},this.releaseProgram=function(m){if(--m.usedTimes===0){var v=i.indexOf(m);i[v]=i[i.length-1],i.pop(),m.destroy()}},this.programs=i}function ug(){var e=new WeakMap;function t(a){var o=e.get(a);return o===void 0&&(o={},e.set(a,o)),o}function n(a){e.delete(a)}function i(a,o,s){e.get(a)[o]=s}function r(){e=new WeakMap}return{get:t,remove:n,update:i,dispose:r}}function hg(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function fg(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Gc(){var e=[],t=0,n=[],i=[],r={id:-1};function a(){t=0,n.length=0,i.length=0}function o(u,h,f,d,p,m){var v=e[t];return v===void 0?(v={id:u.id,object:u,geometry:h,material:f,program:f.program||r,groupOrder:d,renderOrder:u.renderOrder,z:p,group:m},e[t]=v):(v.id=u.id,v.object=u,v.geometry=h,v.material=f,v.program=f.program||r,v.groupOrder=d,v.renderOrder=u.renderOrder,v.z=p,v.group=m),t++,v}function s(u,h,f,d,p,m){var v=o(u,h,f,d,p,m);(f.transparent===!0?i:n).push(v)}function l(u,h,f,d,p,m){var v=o(u,h,f,d,p,m);(f.transparent===!0?i:n).unshift(v)}function c(u,h){n.length>1&&n.sort(u||hg),i.length>1&&i.sort(h||fg)}return{opaque:n,transparent:i,init:a,push:s,unshift:l,sort:c}}function dg(){var e=new WeakMap;function t(r){var a=r.target;a.removeEventListener("dispose",t),e.delete(a)}function n(r,a){var o=e.get(r),s;return o===void 0?(s=new Gc,e.set(r,new WeakMap),e.get(r).set(a,s),r.addEventListener("dispose",t)):(s=o.get(a),s===void 0&&(s=new Gc,o.set(a,s))),s}function i(){e=new WeakMap}return{get:n,dispose:i}}function pg(){var e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new M,color:new ee,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new U};break;case"SpotLight":n={position:new M,direction:new M,color:new ee,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new U};break;case"PointLight":n={position:new M,color:new ee,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new U,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new M,skyColor:new ee,groundColor:new ee};break;case"RectAreaLight":n={color:new ee,position:new M,halfWidth:new M,halfHeight:new M};break}return e[t.id]=n,n}}}var mg=0;function vg(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function gg(){for(var e=new pg,t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;n<9;n++)t.probe.push(new M);var i=new M,r=new Re,a=new Re;function o(s,l,c){for(var u=0,h=0,f=0,d=0;d<9;d++)t.probe[d].set(0,0,0);var p=0,m=0,v=0,y=0,x=0,w=0,S=0,b=0,A=c.matrixWorldInverse;s.sort(vg);for(var d=0,C=s.length;d<C;d++){var T=s[d],I=T.color,D=T.intensity,B=T.distance,O=T.shadow&&T.shadow.map?T.shadow.map.texture:null;if(T.isAmbientLight)u+=I.r*D,h+=I.g*D,f+=I.b*D;else if(T.isLightProbe)for(var F=0;F<9;F++)t.probe[F].addScaledVector(T.sh.coefficients[F],D);else if(T.isDirectionalLight){var N=e.get(T);if(N.color.copy(T.color).multiplyScalar(T.intensity),N.direction.setFromMatrixPosition(T.matrixWorld),i.setFromMatrixPosition(T.target.matrixWorld),N.direction.sub(i),N.direction.transformDirection(A),N.shadow=T.castShadow,T.castShadow){var k=T.shadow;N.shadowBias=k.bias,N.shadowRadius=k.radius,N.shadowMapSize=k.mapSize,t.directionalShadowMap[p]=O,t.directionalShadowMatrix[p]=T.shadow.matrix,w++}t.directional[p]=N,p++}else if(T.isSpotLight){var N=e.get(T);if(N.position.setFromMatrixPosition(T.matrixWorld),N.position.applyMatrix4(A),N.color.copy(I).multiplyScalar(D),N.distance=B,N.direction.setFromMatrixPosition(T.matrixWorld),i.setFromMatrixPosition(T.target.matrixWorld),N.direction.sub(i),N.direction.transformDirection(A),N.coneCos=Math.cos(T.angle),N.penumbraCos=Math.cos(T.angle*(1-T.penumbra)),N.decay=T.decay,N.shadow=T.castShadow,T.castShadow){var k=T.shadow;N.shadowBias=k.bias,N.shadowRadius=k.radius,N.shadowMapSize=k.mapSize,t.spotShadowMap[v]=O,t.spotShadowMatrix[v]=T.shadow.matrix,b++}t.spot[v]=N,v++}else if(T.isRectAreaLight){var N=e.get(T);N.color.copy(I).multiplyScalar(D),N.position.setFromMatrixPosition(T.matrixWorld),N.position.applyMatrix4(A),a.identity(),r.copy(T.matrixWorld),r.premultiply(A),a.extractRotation(r),N.halfWidth.set(T.width*.5,0,0),N.halfHeight.set(0,T.height*.5,0),N.halfWidth.applyMatrix4(a),N.halfHeight.applyMatrix4(a),t.rectArea[y]=N,y++}else if(T.isPointLight){var N=e.get(T);if(N.position.setFromMatrixPosition(T.matrixWorld),N.position.applyMatrix4(A),N.color.copy(T.color).multiplyScalar(T.intensity),N.distance=T.distance,N.decay=T.decay,N.shadow=T.castShadow,T.castShadow){var k=T.shadow;N.shadowBias=k.bias,N.shadowRadius=k.radius,N.shadowMapSize=k.mapSize,N.shadowCameraNear=k.camera.near,N.shadowCameraFar=k.camera.far,t.pointShadowMap[m]=O,t.pointShadowMatrix[m]=T.shadow.matrix,S++}t.point[m]=N,m++}else if(T.isHemisphereLight){var N=e.get(T);N.direction.setFromMatrixPosition(T.matrixWorld),N.direction.transformDirection(A),N.direction.normalize(),N.skyColor.copy(T.color).multiplyScalar(D),N.groundColor.copy(T.groundColor).multiplyScalar(D),t.hemi[x]=N,x++}}t.ambient[0]=u,t.ambient[1]=h,t.ambient[2]=f;var V=t.hash;(V.directionalLength!==p||V.pointLength!==m||V.spotLength!==v||V.rectAreaLength!==y||V.hemiLength!==x||V.numDirectionalShadows!==w||V.numPointShadows!==S||V.numSpotShadows!==b)&&(t.directional.length=p,t.spot.length=v,t.rectArea.length=y,t.point.length=m,t.hemi.length=x,t.directionalShadowMap.length=w,t.pointShadowMap.length=S,t.spotShadowMap.length=b,t.directionalShadowMatrix.length=w,t.pointShadowMatrix.length=S,t.spotShadowMatrix.length=b,V.directionalLength=p,V.pointLength=m,V.spotLength=v,V.rectAreaLength=y,V.hemiLength=x,V.numDirectionalShadows=w,V.numPointShadows=S,V.numSpotShadows=b,t.version=mg++)}return{setup:o,state:t}}function Vc(){var e=new gg,t=[],n=[];function i(){t.length=0,n.length=0}function r(l){t.push(l)}function a(l){n.push(l)}function o(l){e.setup(t,n,l)}var s={lightsArray:t,shadowsArray:n,lights:e};return{init:i,state:s,setupLights:o,pushLight:r,pushShadow:a}}function yg(){var e=new WeakMap;function t(r){var a=r.target;a.removeEventListener("dispose",t),e.delete(a)}function n(r,a){var o;return e.has(r)===!1?(o=new Vc,e.set(r,new WeakMap),e.get(r).set(a,o),r.addEventListener("dispose",t)):e.get(r).has(a)===!1?(o=new Vc,e.get(r).set(a,o)):o=e.get(r).get(a),o}function i(){e=new WeakMap}return{get:n,dispose:i}}function vi(e){xe.call(this),this.type="MeshDepthMaterial",this.depthPacking=pd,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}vi.prototype=Object.create(xe.prototype);vi.prototype.constructor=vi;vi.prototype.isMeshDepthMaterial=!0;vi.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this};function gi(e){xe.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new M,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}gi.prototype=Object.create(xe.prototype);gi.prototype.constructor=gi;gi.prototype.isMeshDistanceMaterial=!0;gi.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this};var xg=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`,_g=`void main() {
	gl_Position = vec4( position, 1.0 );
}`;function dh(e,t,n){var i=new Sa,r=new U,a=new U,o=new Ze,s=[],l=[],c={},u={0:mt,1:wa,2:Qo},h=new Rt({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new U},radius:{value:4}},vertexShader:_g,fragmentShader:xg}),f=h.clone();f.defines.HORIZONAL_PASS=1;var d=new ne;d.setAttribute("position",new _e(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new et(d,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Gu,this.render=function(b,A,C){if(m.enabled!==!1&&!(m.autoUpdate===!1&&m.needsUpdate===!1)&&b.length!==0){var T=e.getRenderTarget(),I=e.getActiveCubeFace(),D=e.getActiveMipmapLevel(),B=e.state;B.setBlending(Hn),B.buffers.color.setClear(1,1,1,1),B.buffers.depth.setTest(!0),B.setScissorTest(!1);for(var O=0,F=b.length;O<F;O++){var N=b[O],k=N.shadow;if(k===void 0){console.warn("THREE.WebGLShadowMap:",N,"has no shadow.");continue}r.copy(k.mapSize);var V=k.getFrameExtents();if(r.multiply(V),a.copy(k.mapSize),(r.x>n||r.y>n)&&(console.warn("THREE.WebGLShadowMap:",N,"has shadow exceeding max texture size, reducing"),r.x>n&&(a.x=Math.floor(n/V.x),r.x=a.x*V.x,k.mapSize.x=a.x),r.y>n&&(a.y=Math.floor(n/V.y),r.y=a.y*V.y,k.mapSize.y=a.y)),k.map===null&&!k.isPointLightShadow&&this.type===Pr){var te={minFilter:gt,magFilter:gt,format:hn};k.map=new At(r.x,r.y,te),k.map.texture.name=N.name+".shadowMap",k.mapPass=new At(r.x,r.y,te),k.camera.updateProjectionMatrix()}if(k.map===null){var te={minFilter:ht,magFilter:ht,format:hn};k.map=new At(r.x,r.y,te),k.map.texture.name=N.name+".shadowMap",k.camera.updateProjectionMatrix()}e.setRenderTarget(k.map),e.clear();for(var $=k.getViewportCount(),X=0;X<$;X++){var Y=k.getViewport(X);o.set(a.x*Y.x,a.y*Y.y,a.x*Y.z,a.y*Y.w),B.viewport(o),k.updateMatrices(N,X),i=k.getFrustum(),S(A,C,k.camera,N,this.type)}!k.isPointLightShadow&&this.type===Pr&&v(k,C)}m.needsUpdate=!1,e.setRenderTarget(T,I,D)}};function v(b,A){var C=t.update(p);h.uniforms.shadow_pass.value=b.map.texture,h.uniforms.resolution.value=b.mapSize,h.uniforms.radius.value=b.radius,e.setRenderTarget(b.mapPass),e.clear(),e.renderBufferDirect(A,null,C,h,p,null),f.uniforms.shadow_pass.value=b.mapPass.texture,f.uniforms.resolution.value=b.mapSize,f.uniforms.radius.value=b.radius,e.setRenderTarget(b.map),e.clear(),e.renderBufferDirect(A,null,C,f,p,null)}function y(b,A,C){var T=b<<0|A<<1|C<<2,I=s[T];return I===void 0&&(I=new vi({depthPacking:md,morphTargets:b,skinning:A}),s[T]=I),I}function x(b,A,C){var T=b<<0|A<<1|C<<2,I=l[T];return I===void 0&&(I=new gi({morphTargets:b,skinning:A}),l[T]=I),I}function w(b,A,C,T,I,D){var B=b.geometry,O=null,F=y,N=b.customDepthMaterial;if(C.isPointLight===!0&&(F=x,N=b.customDistanceMaterial),N===void 0){var k=!1;A.morphTargets===!0&&(B.isBufferGeometry===!0?k=B.morphAttributes&&B.morphAttributes.position&&B.morphAttributes.position.length>0:B.isGeometry===!0&&(k=B.morphTargets&&B.morphTargets.length>0));var V=!1;b.isSkinnedMesh===!0&&(A.skinning===!0?V=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",b));var te=b.isInstancedMesh===!0;O=F(k,V,te)}else O=N;if(e.localClippingEnabled&&A.clipShadows===!0&&A.clippingPlanes.length!==0){var $=O.uuid,X=A.uuid,Y=c[$];Y===void 0&&(Y={},c[$]=Y);var ie=Y[X];ie===void 0&&(ie=O.clone(),Y[X]=ie),O=ie}return O.visible=A.visible,O.wireframe=A.wireframe,D===Pr?O.side=A.shadowSide!==null?A.shadowSide:A.side:O.side=A.shadowSide!==null?A.shadowSide:u[A.side],O.clipShadows=A.clipShadows,O.clippingPlanes=A.clippingPlanes,O.clipIntersection=A.clipIntersection,O.wireframeLinewidth=A.wireframeLinewidth,O.linewidth=A.linewidth,C.isPointLight===!0&&O.isMeshDistanceMaterial===!0&&(O.referencePosition.setFromMatrixPosition(C.matrixWorld),O.nearDistance=T,O.farDistance=I),O}function S(b,A,C,T,I){if(b.visible!==!1){var D=b.layers.test(A.layers);if(D&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&I===Pr)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(C.matrixWorldInverse,b.matrixWorld);var B=t.update(b),O=b.material;if(Array.isArray(O))for(var F=B.groups,N=0,k=F.length;N<k;N++){var V=F[N],te=O[V.materialIndex];if(te&&te.visible){var $=w(b,te,T,C.near,C.far,I);e.renderBufferDirect(C,null,B,$,b,V)}}else if(O.visible){var $=w(b,O,T,C.near,C.far,I);e.renderBufferDirect(C,null,B,$,b,null)}}for(var X=b.children,Y=0,ie=X.length;Y<ie;Y++)S(X[Y],A,C,T,I)}}}function wg(e,t,n){var i=n.isWebGL2;function r(){var R=!1,q=new Ze,oe=null,Se=new Ze(0,0,0,0);return{setMask:function(ae){oe!==ae&&!R&&(e.colorMask(ae,ae,ae,ae),oe=ae)},setLocked:function(ae){R=ae},setClear:function(ae,Ne,$e,nt,Xt){Xt===!0&&(ae*=nt,Ne*=nt,$e*=nt),q.set(ae,Ne,$e,nt),Se.equals(q)===!1&&(e.clearColor(ae,Ne,$e,nt),Se.copy(q))},reset:function(){R=!1,oe=null,Se.set(-1,0,0,0)}}}function a(){var R=!1,q=null,oe=null,Se=null;return{setTest:function(ae){ae?be(2929):ke(2929)},setMask:function(ae){q!==ae&&!R&&(e.depthMask(ae),q=ae)},setFunc:function(ae){if(oe!==ae){if(ae)switch(ae){case xf:e.depthFunc(512);break;case _f:e.depthFunc(519);break;case wf:e.depthFunc(513);break;case zs:e.depthFunc(515);break;case bf:e.depthFunc(514);break;case Mf:e.depthFunc(518);break;case Sf:e.depthFunc(516);break;case Ef:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);oe=ae}},setLocked:function(ae){R=ae},setClear:function(ae){Se!==ae&&(e.clearDepth(ae),Se=ae)},reset:function(){R=!1,q=null,oe=null,Se=null}}}function o(){var R=!1,q=null,oe=null,Se=null,ae=null,Ne=null,$e=null,nt=null,Xt=null;return{setTest:function(qe){R||(qe?be(2960):ke(2960))},setMask:function(qe){q!==qe&&!R&&(e.stencilMask(qe),q=qe)},setFunc:function(qe,It,St){(oe!==qe||Se!==It||ae!==St)&&(e.stencilFunc(qe,It,St),oe=qe,Se=It,ae=St)},setOp:function(qe,It,St){(Ne!==qe||$e!==It||nt!==St)&&(e.stencilOp(qe,It,St),Ne=qe,$e=It,nt=St)},setLocked:function(qe){R=qe},setClear:function(qe){Xt!==qe&&(e.clearStencil(qe),Xt=qe)},reset:function(){R=!1,q=null,oe=null,Se=null,ae=null,Ne=null,$e=null,nt=null,Xt=null}}}var s=new r,l=new a,c=new o,u=e.getParameter(34921),h=new Uint8Array(u),f=new Uint8Array(u),d=new Uint8Array(u),p={},m=null,v=null,y=null,x=null,w=null,S=null,b=null,A=null,C=null,T=!1,I=null,D=null,B=null,O=null,F=null,N=e.getParameter(35661),k=!1,V=0,te=e.getParameter(7938);te.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL\ ([0-9])/.exec(te)[1]),k=V>=1):te.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(te)[1]),k=V>=2);var $=null,X={},Y=new Ze,ie=new Ze;function Ue(R,q,oe){var Se=new Uint8Array(4),ae=e.createTexture();e.bindTexture(R,ae),e.texParameteri(R,10241,9728),e.texParameteri(R,10240,9728);for(var Ne=0;Ne<oe;Ne++)e.texImage2D(q+Ne,0,6408,1,1,0,6408,5121,Se);return ae}var ze={};ze[3553]=Ue(3553,3553,1),ze[34067]=Ue(34067,34069,6),s.setClear(0,0,0,1),l.setClear(1),c.setClear(0),be(2929),l.setFunc(zs),rt(!1),E(ac),be(2884),tt(Hn);function Be(){for(var R=0,q=h.length;R<q;R++)h[R]=0}function Me(R){G(R,0)}function G(R,q){if(h[R]=1,f[R]===0&&(e.enableVertexAttribArray(R),f[R]=1),d[R]!==q){var oe=i?e:t.get("ANGLE_instanced_arrays");oe[i?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](R,q),d[R]=q}}function He(){for(var R=0,q=f.length;R!==q;++R)f[R]!==h[R]&&(e.disableVertexAttribArray(R),f[R]=0)}function be(R){p[R]!==!0&&(e.enable(R),p[R]=!0)}function ke(R){p[R]!==!1&&(e.disable(R),p[R]=!1)}function de(R){return m!==R?(e.useProgram(R),m=R,!0):!1}var W={[Hi]:32774,[lf]:32778,[cf]:32779};if(i)W[cc]=32775,W[uc]=32776;else{var Ce=t.get("EXT_blend_minmax");Ce!==null&&(W[cc]=Ce.MIN_EXT,W[uc]=Ce.MAX_EXT)}var Ge={[uf]:0,[hf]:1,[ff]:768,[Wu]:770,[yf]:776,[vf]:774,[pf]:772,[df]:769,[ju]:771,[gf]:775,[mf]:773};function tt(R,q,oe,Se,ae,Ne,$e,nt){if(R===Hn){v&&(ke(3042),v=!1);return}if(v||(be(3042),v=!0),R!==sf){if(R!==y||nt!==T){if((x!==Hi||b!==Hi)&&(e.blendEquation(32774),x=Hi,b=Hi),nt)switch(R){case Or:e.blendFuncSeparate(1,771,1,771);break;case oc:e.blendFunc(1,1);break;case sc:e.blendFuncSeparate(0,0,769,771);break;case lc:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",R);break}else switch(R){case Or:e.blendFuncSeparate(770,771,1,771);break;case oc:e.blendFunc(770,1);break;case sc:e.blendFunc(0,769);break;case lc:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",R);break}w=null,S=null,A=null,C=null,y=R,T=nt}return}ae=ae||q,Ne=Ne||oe,$e=$e||Se,(q!==x||ae!==b)&&(e.blendEquationSeparate(W[q],W[ae]),x=q,b=ae),(oe!==w||Se!==S||Ne!==A||$e!==C)&&(e.blendFuncSeparate(Ge[oe],Ge[Se],Ge[Ne],Ge[$e]),w=oe,S=Se,A=Ne,C=$e),y=R,T=null}function qt(R,q){R.side===Qo?ke(2884):be(2884);var oe=R.side===mt;q&&(oe=!oe),rt(oe),R.blending===Or&&R.transparent===!1?tt(Hn):tt(R.blending,R.blendEquation,R.blendSrc,R.blendDst,R.blendEquationAlpha,R.blendSrcAlpha,R.blendDstAlpha,R.premultipliedAlpha),l.setFunc(R.depthFunc),l.setTest(R.depthTest),l.setMask(R.depthWrite),s.setMask(R.colorWrite);var Se=R.stencilWrite;c.setTest(Se),Se&&(c.setMask(R.stencilWriteMask),c.setFunc(R.stencilFunc,R.stencilRef,R.stencilFuncMask),c.setOp(R.stencilFail,R.stencilZFail,R.stencilZPass)),Z(R.polygonOffset,R.polygonOffsetFactor,R.polygonOffsetUnits)}function rt(R){I!==R&&(R?e.frontFace(2304):e.frontFace(2305),I=R)}function E(R){R!==nf?(be(2884),R!==D&&(R===ac?e.cullFace(1029):R===rf?e.cullFace(1028):e.cullFace(1032))):ke(2884),D=R}function L(R){R!==B&&(k&&e.lineWidth(R),B=R)}function Z(R,q,oe){R?(be(32823),(O!==q||F!==oe)&&(e.polygonOffset(q,oe),O=q,F=oe)):ke(32823)}function H(R){R?be(3089):ke(3089)}function Ie(R){R===void 0&&(R=33984+N-1),$!==R&&(e.activeTexture(R),$=R)}function pe(R,q){$===null&&Ie();var oe=X[$];oe===void 0&&(oe={type:void 0,texture:void 0},X[$]=oe),(oe.type!==R||oe.texture!==q)&&(e.bindTexture(R,q||ze[R]),oe.type=R,oe.texture=q)}function ce(){var R=X[$];R!==void 0&&R.type!==void 0&&(e.bindTexture(R.type,null),R.type=void 0,R.texture=void 0)}function ge(){try{e.compressedTexImage2D.apply(e,arguments)}catch(R){console.error("THREE.WebGLState:",R)}}function De(){try{e.texImage2D.apply(e,arguments)}catch(R){console.error("THREE.WebGLState:",R)}}function me(){try{e.texImage3D.apply(e,arguments)}catch(R){console.error("THREE.WebGLState:",R)}}function re(R){Y.equals(R)===!1&&(e.scissor(R.x,R.y,R.z,R.w),Y.copy(R))}function he(R){ie.equals(R)===!1&&(e.viewport(R.x,R.y,R.z,R.w),ie.copy(R))}function se(){for(var R=0;R<f.length;R++)f[R]===1&&(e.disableVertexAttribArray(R),f[R]=0);p={},$=null,X={},m=null,y=null,I=null,D=null,s.reset(),l.reset(),c.reset()}return{buffers:{color:s,depth:l,stencil:c},initAttributes:Be,enableAttribute:Me,enableAttributeAndDivisor:G,disableUnusedAttributes:He,enable:be,disable:ke,useProgram:de,setBlending:tt,setMaterial:qt,setFlipSided:rt,setCullFace:E,setLineWidth:L,setPolygonOffset:Z,setScissorTest:H,activeTexture:Ie,bindTexture:pe,unbindTexture:ce,compressedTexImage2D:ge,texImage2D:De,texImage3D:me,scissor:re,viewport:he,reset:se}}function bg(e,t,n,i,r,a,o){var s=r.isWebGL2,l=r.maxTextures,c=r.maxCubemapSize,u=r.maxTextureSize,h=r.maxSamples,f=new WeakMap,d,p=!1;try{p=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function m(E,L){return p?new OffscreenCanvas(E,L):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function v(E,L,Z,H){var Ie=1;if((E.width>H||E.height>H)&&(Ie=H/Math.max(E.width,E.height)),Ie<1||L===!0)if(typeof HTMLImageElement<"u"&&E instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&E instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&E instanceof ImageBitmap){var pe=L?Le.floorPowerOfTwo:Math.floor,ce=pe(Ie*E.width),ge=pe(Ie*E.height);d===void 0&&(d=m(ce,ge));var De=Z?m(ce,ge):d;De.width=ce,De.height=ge;var me=De.getContext("2d");return me.drawImage(E,0,0,ce,ge),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+E.width+"x"+E.height+") to ("+ce+"x"+ge+")."),De}else return"data"in E&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+E.width+"x"+E.height+")."),E;return E}function y(E){return Le.isPowerOfTwo(E.width)&&Le.isPowerOfTwo(E.height)}function x(E){return s?!1:E.wrapS!==Ct||E.wrapT!==Ct||E.minFilter!==ht&&E.minFilter!==gt}function w(E,L){return E.generateMipmaps&&L&&E.minFilter!==ht&&E.minFilter!==gt}function S(E,L,Z,H){e.generateMipmap(E);var Ie=i.get(L);Ie.__maxMipLevel=Math.log(Math.max(Z,H))*Math.LOG2E}function b(E,L,Z){if(s===!1)return L;if(E!==null){if(e[E]!==void 0)return e[E];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+E+"'")}var H=L;return L===6403&&(Z===5126&&(H=33326),Z===5131&&(H=33325),Z===5121&&(H=33321)),L===6407&&(Z===5126&&(H=34837),Z===5131&&(H=34843),Z===5121&&(H=32849)),L===6408&&(Z===5126&&(H=34836),Z===5131&&(H=34842),Z===5121&&(H=32856)),H===33325||H===33326||H===34842||H===34836?t.get("EXT_color_buffer_float"):(H===34843||H===34837)&&console.warn("THREE.WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),H}function A(E){return E===ht||E===Us||E===Gs?9728:9729}function C(E){var L=E.target;L.removeEventListener("dispose",C),I(L),L.isVideoTexture&&f.delete(L),o.memory.textures--}function T(E){var L=E.target;L.removeEventListener("dispose",T),D(L),o.memory.textures--}function I(E){var L=i.get(E);L.__webglInit!==void 0&&(e.deleteTexture(L.__webglTexture),i.remove(E))}function D(E){var L=i.get(E),Z=i.get(E.texture);if(E){if(Z.__webglTexture!==void 0&&e.deleteTexture(Z.__webglTexture),E.depthTexture&&E.depthTexture.dispose(),E.isWebGLCubeRenderTarget)for(var H=0;H<6;H++)e.deleteFramebuffer(L.__webglFramebuffer[H]),L.__webglDepthbuffer&&e.deleteRenderbuffer(L.__webglDepthbuffer[H]);else e.deleteFramebuffer(L.__webglFramebuffer),L.__webglDepthbuffer&&e.deleteRenderbuffer(L.__webglDepthbuffer);if(E.isWebGLMultiviewRenderTarget){e.deleteTexture(L.__webglColorTexture),e.deleteTexture(L.__webglDepthStencilTexture),o.memory.textures-=2;for(var H=0,Ie=L.__webglViewFramebuffers.length;H<Ie;H++)e.deleteFramebuffer(L.__webglViewFramebuffers[H])}i.remove(E.texture),i.remove(E)}}var B=0;function O(){B=0}function F(){var E=B;return E>=l&&console.warn("THREE.WebGLTextures: Trying to use "+E+" texture units while this GPU supports only "+l),B+=1,E}function N(E,L){var Z=i.get(E);if(E.isVideoTexture&&Ce(E),E.version>0&&Z.__version!==E.version){var H=E.image;if(H===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(H.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ze(Z,E,L);return}}n.activeTexture(33984+L),n.bindTexture(3553,Z.__webglTexture)}function k(E,L){var Z=i.get(E);if(E.version>0&&Z.__version!==E.version){ze(Z,E,L);return}n.activeTexture(33984+L),n.bindTexture(35866,Z.__webglTexture)}function V(E,L){var Z=i.get(E);if(E.version>0&&Z.__version!==E.version){ze(Z,E,L);return}n.activeTexture(33984+L),n.bindTexture(32879,Z.__webglTexture)}function te(E,L){if(E.image.length===6){var Z=i.get(E);if(E.version>0&&Z.__version!==E.version){Ue(Z,E),n.activeTexture(33984+L),n.bindTexture(34067,Z.__webglTexture),e.pixelStorei(37440,E.flipY);for(var H=E&&(E.isCompressedTexture||E.image[0].isCompressedTexture),Ie=E.image[0]&&E.image[0].isDataTexture,pe=[],ce=0;ce<6;ce++)!H&&!Ie?pe[ce]=v(E.image[ce],!1,!0,c):pe[ce]=Ie?E.image[ce].image:E.image[ce];var ge=pe[0],De=y(ge)||s,me=a.convert(E.format),re=a.convert(E.type),he=b(E.internalFormat,me,re);ie(34067,E,De);var se;if(H){for(var ce=0;ce<6;ce++){se=pe[ce].mipmaps;for(var R=0;R<se.length;R++){var q=se[R];E.format!==hn&&E.format!==mi?me!==null?n.compressedTexImage2D(34069+ce,R,he,q.width,q.height,0,q.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+ce,R,he,q.width,q.height,0,me,re,q.data)}}Z.__maxMipLevel=se.length-1}else{se=E.mipmaps;for(var ce=0;ce<6;ce++)if(Ie){n.texImage2D(34069+ce,0,he,pe[ce].width,pe[ce].height,0,me,re,pe[ce].data);for(var R=0;R<se.length;R++){var q=se[R],oe=q.image[ce].image;n.texImage2D(34069+ce,R+1,he,oe.width,oe.height,0,me,re,oe.data)}}else{n.texImage2D(34069+ce,0,he,me,re,pe[ce]);for(var R=0;R<se.length;R++){var q=se[R];n.texImage2D(34069+ce,R+1,he,me,re,q.image[ce])}}Z.__maxMipLevel=se.length}w(E,De)&&S(34067,E,ge.width,ge.height),Z.__version=E.version,E.onUpdate&&E.onUpdate(E)}else n.activeTexture(33984+L),n.bindTexture(34067,Z.__webglTexture)}}function $(E,L){n.activeTexture(33984+L),n.bindTexture(34067,i.get(E).__webglTexture)}var X={[fo]:10497,[Ct]:33071,[po]:33648},Y={[ht]:9728,[Us]:9984,[Gs]:9986,[gt]:9729,[Yu]:9985,[ts]:9987};function ie(E,L,Z){Z?(e.texParameteri(E,10242,X[L.wrapS]),e.texParameteri(E,10243,X[L.wrapT]),(E===32879||E===35866)&&e.texParameteri(E,32882,X[L.wrapR]),e.texParameteri(E,10240,Y[L.magFilter]),e.texParameteri(E,10241,Y[L.minFilter])):(e.texParameteri(E,10242,33071),e.texParameteri(E,10243,33071),(E===32879||E===35866)&&e.texParameteri(E,32882,33071),(L.wrapS!==Ct||L.wrapT!==Ct)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(E,10240,A(L.magFilter)),e.texParameteri(E,10241,A(L.minFilter)),L.minFilter!==ht&&L.minFilter!==gt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));var H=t.get("EXT_texture_filter_anisotropic");if(H){if(L.type===kr&&t.get("OES_texture_float_linear")===null||L.type===Hl&&(s||t.get("OES_texture_half_float_linear"))===null)return;(L.anisotropy>1||i.get(L).__currentAnisotropy)&&(e.texParameterf(E,H.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(L.anisotropy,r.getMaxAnisotropy())),i.get(L).__currentAnisotropy=L.anisotropy)}}function Ue(E,L){E.__webglInit===void 0&&(E.__webglInit=!0,L.addEventListener("dispose",C),E.__webglTexture=e.createTexture(),o.memory.textures++)}function ze(E,L,Z){var H=3553;L.isDataTexture2DArray&&(H=35866),L.isDataTexture3D&&(H=32879),Ue(E,L),n.activeTexture(33984+Z),n.bindTexture(H,E.__webglTexture),e.pixelStorei(37440,L.flipY),e.pixelStorei(37441,L.premultiplyAlpha),e.pixelStorei(3317,L.unpackAlignment);var Ie=x(L)&&y(L.image)===!1,pe=v(L.image,Ie,!1,u),ce=y(pe)||s,ge=a.convert(L.format),De=a.convert(L.type),me=b(L.internalFormat,ge,De);ie(H,L,ce);var re,he=L.mipmaps;if(L.isDepthTexture){if(me=6402,L.type===kr){if(s===!1)throw new Error("Float Depth Texture only supported in WebGL2.0");me=36012}else s&&(me=33189);L.format===Ji&&me===6402&&L.type!==mo&&L.type!==Zu&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),L.type=mo,De=a.convert(L.type)),L.format===zr&&(me=34041,L.type!==vo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),L.type=vo,De=a.convert(L.type))),n.texImage2D(3553,0,me,pe.width,pe.height,0,ge,De,null)}else if(L.isDataTexture)if(he.length>0&&ce){for(var se=0,R=he.length;se<R;se++)re=he[se],n.texImage2D(3553,se,me,re.width,re.height,0,ge,De,re.data);L.generateMipmaps=!1,E.__maxMipLevel=he.length-1}else n.texImage2D(3553,0,me,pe.width,pe.height,0,ge,De,pe.data),E.__maxMipLevel=0;else if(L.isCompressedTexture){for(var se=0,R=he.length;se<R;se++)re=he[se],L.format!==hn&&L.format!==mi?ge!==null?n.compressedTexImage2D(3553,se,me,re.width,re.height,0,re.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,se,me,re.width,re.height,0,ge,De,re.data);E.__maxMipLevel=he.length-1}else if(L.isDataTexture2DArray)n.texImage3D(35866,0,me,pe.width,pe.height,pe.depth,0,ge,De,pe.data),E.__maxMipLevel=0;else if(L.isDataTexture3D)n.texImage3D(32879,0,me,pe.width,pe.height,pe.depth,0,ge,De,pe.data),E.__maxMipLevel=0;else if(he.length>0&&ce){for(var se=0,R=he.length;se<R;se++)re=he[se],n.texImage2D(3553,se,me,ge,De,re);L.generateMipmaps=!1,E.__maxMipLevel=he.length-1}else n.texImage2D(3553,0,me,ge,De,pe),E.__maxMipLevel=0;w(L,ce)&&S(H,L,pe.width,pe.height),E.__version=L.version,L.onUpdate&&L.onUpdate(L)}function Be(E,L,Z,H){var Ie=a.convert(L.texture.format),pe=a.convert(L.texture.type),ce=b(L.texture.internalFormat,Ie,pe);n.texImage2D(H,0,ce,L.width,L.height,0,Ie,pe,null),e.bindFramebuffer(36160,E),e.framebufferTexture2D(36160,Z,H,i.get(L.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Me(E,L,Z){if(e.bindRenderbuffer(36161,E),L.depthBuffer&&!L.stencilBuffer){if(Z){var H=W(L);e.renderbufferStorageMultisample(36161,H,33189,L.width,L.height)}else e.renderbufferStorage(36161,33189,L.width,L.height);e.framebufferRenderbuffer(36160,36096,36161,E)}else if(L.depthBuffer&&L.stencilBuffer){if(Z){var H=W(L);e.renderbufferStorageMultisample(36161,H,35056,L.width,L.height)}else e.renderbufferStorage(36161,34041,L.width,L.height);e.framebufferRenderbuffer(36160,33306,36161,E)}else{var Ie=a.convert(L.texture.format),pe=a.convert(L.texture.type),ce=b(L.texture.internalFormat,Ie,pe);if(Z){var H=W(L);e.renderbufferStorageMultisample(36161,H,ce,L.width,L.height)}else e.renderbufferStorage(36161,ce,L.width,L.height)}e.bindRenderbuffer(36161,null)}function G(E,L){var Z=L&&L.isWebGLCubeRenderTarget;if(Z)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,E),!(L.depthTexture&&L.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(L.depthTexture).__webglTexture||L.depthTexture.image.width!==L.width||L.depthTexture.image.height!==L.height)&&(L.depthTexture.image.width=L.width,L.depthTexture.image.height=L.height,L.depthTexture.needsUpdate=!0),N(L.depthTexture,0);var H=i.get(L.depthTexture).__webglTexture;if(L.depthTexture.format===Ji)e.framebufferTexture2D(36160,36096,3553,H,0);else if(L.depthTexture.format===zr)e.framebufferTexture2D(36160,33306,3553,H,0);else throw new Error("Unknown depthTexture format")}function He(E){var L=i.get(E),Z=E.isWebGLCubeRenderTarget===!0;if(E.depthTexture){if(Z)throw new Error("target.depthTexture not supported in Cube render targets");G(L.__webglFramebuffer,E)}else if(Z){L.__webglDepthbuffer=[];for(var H=0;H<6;H++)e.bindFramebuffer(36160,L.__webglFramebuffer[H]),L.__webglDepthbuffer[H]=e.createRenderbuffer(),Me(L.__webglDepthbuffer[H],E)}else e.bindFramebuffer(36160,L.__webglFramebuffer),L.__webglDepthbuffer=e.createRenderbuffer(),Me(L.__webglDepthbuffer,E);e.bindFramebuffer(36160,null)}function be(E){var L=i.get(E),Z=i.get(E.texture);E.addEventListener("dispose",T),Z.__webglTexture=e.createTexture(),o.memory.textures++;var H=E.isWebGLCubeRenderTarget===!0,Ie=E.isWebGLMultisampleRenderTarget===!0,pe=E.isWebGLMultiviewRenderTarget===!0,ce=y(E)||s;if(H){L.__webglFramebuffer=[];for(var ge=0;ge<6;ge++)L.__webglFramebuffer[ge]=e.createFramebuffer()}else if(L.__webglFramebuffer=e.createFramebuffer(),Ie)if(s){L.__webglMultisampledFramebuffer=e.createFramebuffer(),L.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,L.__webglColorRenderbuffer);var De=a.convert(E.texture.format),me=a.convert(E.texture.type),re=b(E.texture.internalFormat,De,me),he=W(E);e.renderbufferStorageMultisample(36161,he,re,E.width,E.height),e.bindFramebuffer(36160,L.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,L.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),E.depthBuffer&&(L.__webglDepthRenderbuffer=e.createRenderbuffer(),Me(L.__webglDepthRenderbuffer,E,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(pe){var se=E.width,R=E.height,q=E.numViews;e.bindFramebuffer(36160,L.__webglFramebuffer);var oe=t.get("OVR_multiview2");o.memory.textures+=2;var Se=e.createTexture();e.bindTexture(35866,Se),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,32856,se,R,q,0,6408,5121,null),oe.framebufferTextureMultiviewOVR(36160,36064,Se,0,0,q);var ae=e.createTexture();e.bindTexture(35866,ae),e.texParameteri(35866,10240,9728),e.texParameteri(35866,10241,9728),e.texImage3D(35866,0,35056,se,R,q,0,34041,34042,null),oe.framebufferTextureMultiviewOVR(36160,33306,ae,0,0,q);for(var Ne=new Array(q),ge=0;ge<q;++ge)Ne[ge]=e.createFramebuffer(),e.bindFramebuffer(36160,Ne[ge]),e.framebufferTextureLayer(36160,36064,Se,0,ge);L.__webglColorTexture=Se,L.__webglDepthStencilTexture=ae,L.__webglViewFramebuffers=Ne,e.bindFramebuffer(36160,null),e.bindTexture(35866,null)}if(H){n.bindTexture(34067,Z.__webglTexture),ie(34067,E.texture,ce);for(var ge=0;ge<6;ge++)Be(L.__webglFramebuffer[ge],E,36064,34069+ge);w(E.texture,ce)&&S(34067,E.texture,E.width,E.height),n.bindTexture(34067,null)}else pe||(n.bindTexture(3553,Z.__webglTexture),ie(3553,E.texture,ce),Be(L.__webglFramebuffer,E,36064,3553),w(E.texture,ce)&&S(3553,E.texture,E.width,E.height),n.bindTexture(3553,null));E.depthBuffer&&He(E)}function ke(E){var L=E.texture,Z=y(E)||s;if(w(L,Z)){var H=E.isWebGLCubeRenderTarget?34067:3553,Ie=i.get(L).__webglTexture;n.bindTexture(H,Ie),S(H,L,E.width,E.height),n.bindTexture(H,null)}}function de(E){if(E.isWebGLMultisampleRenderTarget)if(s){var L=i.get(E);e.bindFramebuffer(36008,L.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,L.__webglFramebuffer);var Z=E.width,H=E.height,Ie=16384;E.depthBuffer&&(Ie|=256),E.stencilBuffer&&(Ie|=1024),e.blitFramebuffer(0,0,Z,H,0,0,Z,H,Ie,9728)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function W(E){return s&&E.isWebGLMultisampleRenderTarget?Math.min(h,E.samples):0}function Ce(E){var L=o.render.frame;f.get(E)!==L&&(f.set(E,L),E.update())}var Ge=!1,tt=!1;function qt(E,L){E&&E.isWebGLRenderTarget&&(Ge===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Ge=!0),E=E.texture),N(E,L)}function rt(E,L){E&&E.isWebGLCubeRenderTarget&&(tt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),tt=!0),E=E.texture),E&&E.isCubeTexture||Array.isArray(E.image)&&E.image.length===6?te(E,L):$(E,L)}this.allocateTextureUnit=F,this.resetTextureUnits=O,this.setTexture2D=N,this.setTexture2DArray=k,this.setTexture3D=V,this.setTextureCube=te,this.setTextureCubeDynamic=$,this.setupRenderTarget=be,this.updateRenderTargetMipmap=ke,this.updateMultisampleRenderTarget=de,this.safeSetTexture2D=qt,this.safeSetTextureCube=rt}function Mg(e,t,n){var i=n.isWebGL2;function r(a){var o;if(a===ns)return 5121;if(a===Nf)return 32819;if(a===Ff)return 32820;if(a===Bf)return 33635;if(a===If)return 5120;if(a===Df)return 5122;if(a===mo)return 5123;if(a===Of)return 5124;if(a===Zu)return 5125;if(a===kr)return 5126;if(a===Hl)return i?5131:(o=t.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(a===kf)return 6406;if(a===mi)return 6407;if(a===hn)return 6408;if(a===zf)return 6409;if(a===Uf)return 6410;if(a===Ji)return 6402;if(a===zr)return 34041;if(a===Vf)return 6403;if(a===Hf)return 36244;if(a===Wf)return 33319;if(a===jf)return 33320;if(a===qf)return 36248;if(a===Xf)return 36249;if(a===hc||a===fc||a===dc||a===pc)if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(a===hc)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===fc)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===dc)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===pc)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===mc||a===vc||a===gc||a===yc)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(a===mc)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===vc)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===gc)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===yc)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===Yf)return o=t.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===Zf||a===Jf||a===$f||a===Kf||a===Qf||a===ed||a===td||a===nd||a===id||a===rd||a===ad||a===od||a===sd||a===ld)return o=t.get("WEBGL_compressed_texture_astc"),o!==null?a:null;if(a===vo)return i?34042:(o=t.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:r}}function Zs(e,t,n,i){At.call(this,e,t,i),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}Zs.prototype=Object.assign(Object.create(At.prototype),{constructor:Zs,isWebGLMultiviewRenderTarget:!0,copy:function(e){return At.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}});function Sg(e,t){var n=2,i=e.extensions,r=e.properties,a,o,s,l,c,u,h,f=0;function d(){if(h===void 0){var C=i.get("OVR_multiview2");if(h=C!==null&&t.getContextAttributes().antialias===!1,h){f=t.getParameter(C.MAX_VIEWS_OVR),a=new Zs(0,0,n),u=new U,l=[],s=[],c=[];for(var T=0;T<f;T++)l[T]=new Re,s[T]=new bt}}return h}function p(C){return C.isArrayCamera?C.cameras:(c[0]=C,c)}function m(C,T){for(var I=p(C),D=0;D<I.length;D++)l[D].copy(I[D].projectionMatrix);T.setValue(t,"projectionMatrices",l)}function v(C,T){for(var I=p(C),D=0;D<I.length;D++)l[D].copy(I[D].matrixWorldInverse);T.setValue(t,"viewMatrices",l)}function y(C,T,I){for(var D=p(T),B=0;B<D.length;B++)l[B].multiplyMatrices(D[B].matrixWorldInverse,C.matrixWorld),s[B].getNormalMatrix(l[B]);I.setValue(t,"modelViewMatrices",l),I.setValue(t,"normalMatrices",s)}function x(C){if(C.isArrayCamera===void 0)return!0;var T=C.cameras;if(T.length>f)return!1;for(var I=1,D=T.length;I<D;I++)if(T[0].viewport.z!==T[I].viewport.z||T[0].viewport.w!==T[I].viewport.w)return!1;return!0}function w(C){if(o?u.set(o.width,o.height):e.getDrawingBufferSize(u),C.isArrayCamera){var T=C.cameras[0].viewport;a.setSize(T.z,T.w),a.setNumViews(C.cameras.length)}else a.setSize(u.x,u.y),a.setNumViews(n)}function S(C){x(C)!==!1&&(o=e.getRenderTarget(),w(C),e.setRenderTarget(a))}function b(C){a===e.getRenderTarget()&&(e.setRenderTarget(o),A(C))}function A(C){var T=a,I=T.numViews,D=r.get(T).__webglViewFramebuffers,B=T.width,O=T.height;if(C.isArrayCamera)for(var F=0;F<I;F++){var N=C.cameras[F].viewport,k=N.x,V=N.y,te=k+N.z,$=V+N.w;t.bindFramebuffer(36008,D[F]),t.blitFramebuffer(0,0,B,O,k,V,te,$,16384,9728)}else t.bindFramebuffer(36008,D[0]),t.blitFramebuffer(0,0,B,O,0,0,u.x,u.y,16384,9728)}this.isAvailable=d,this.attachCamera=S,this.detachCamera=b,this.updateCameraProjectionMatricesUniform=m,this.updateCameraViewMatricesUniform=v,this.updateObjectMatricesUniforms=y}function Js(e){ut.call(this),this.cameras=e||[]}Js.prototype=Object.assign(Object.create(ut.prototype),{constructor:Js,isArrayCamera:!0});function Xr(){Q.call(this),this.type="Group"}Xr.prototype=Object.assign(Object.create(Q.prototype),{constructor:Xr,isGroup:!0});function ph(e,t){var n=this,i=null,r=null,a="local-floor",o=null,s=[],l=new Map,c=new ut;c.layers.enable(1),c.viewport=new Ze;var u=new ut;u.layers.enable(2),u.viewport=new Ze;var h=new Js([c,u]);h.layers.enable(1),h.layers.enable(2);var f=null,d=null;this.enabled=!1,this.isPresenting=!1,this.getController=function(I){var D=s[I];return D===void 0&&(D={},s[I]=D),D.targetRay===void 0&&(D.targetRay=new Xr,D.targetRay.matrixAutoUpdate=!1,D.targetRay.visible=!1),D.targetRay},this.getControllerGrip=function(I){var D=s[I];return D===void 0&&(D={},s[I]=D),D.grip===void 0&&(D.grip=new Xr,D.grip.matrixAutoUpdate=!1,D.grip.visible=!1),D.grip};function p(I){var D=l.get(I.inputSource);D&&(D.targetRay&&D.targetRay.dispatchEvent({type:I.type}),D.grip&&D.grip.dispatchEvent({type:I.type}))}function m(){l.forEach(function(I,D){I.targetRay&&(I.targetRay.dispatchEvent({type:"disconnected",data:D}),I.targetRay.visible=!1),I.grip&&(I.grip.dispatchEvent({type:"disconnected",data:D}),I.grip.visible=!1)}),l.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),T.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(I){r=I,T.setContext(i),T.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(I){a=I},this.getReferenceSpace=function(){return r},this.getSession=function(){return i},this.setSession=function(I){if(i=I,i!==null){i.addEventListener("select",p),i.addEventListener("selectstart",p),i.addEventListener("selectend",p),i.addEventListener("squeeze",p),i.addEventListener("squeezestart",p),i.addEventListener("squeezeend",p),i.addEventListener("end",m);var D=t.getContextAttributes(),B={antialias:D.antialias,alpha:D.alpha,depth:D.depth,stencil:D.stencil},O=new XRWebGLLayer(i,t,B);i.updateRenderState({baseLayer:O}),i.requestReferenceSpace(a).then(v),i.addEventListener("inputsourceschange",y)}};function y(I){for(var D=i.inputSources,B=0;B<s.length;B++)l.set(D[B],s[B]);for(var B=0;B<I.removed.length;B++){var O=I.removed[B],F=l.get(O);F&&(F.targetRay&&F.targetRay.dispatchEvent({type:"disconnected",data:O}),F.grip&&F.grip.dispatchEvent({type:"disconnected",data:O}),l.delete(O))}for(var B=0;B<I.added.length;B++){var O=I.added[B],F=l.get(O);F&&(F.targetRay&&F.targetRay.dispatchEvent({type:"connected",data:O}),F.grip&&F.grip.dispatchEvent({type:"connected",data:O}))}}var x=new M,w=new M;function S(I,D,B){x.setFromMatrixPosition(D.matrixWorld),w.setFromMatrixPosition(B.matrixWorld);var O=x.distanceTo(w),F=D.projectionMatrix.elements,N=B.projectionMatrix.elements,k=F[14]/(F[10]-1),V=F[14]/(F[10]+1),te=(F[9]+1)/F[5],$=(F[9]-1)/F[5],X=(F[8]-1)/F[0],Y=(N[8]+1)/N[0],ie=k*X,Ue=k*Y,ze=O/(-X+Y),Be=ze*-X;D.matrixWorld.decompose(I.position,I.quaternion,I.scale),I.translateX(Be),I.translateZ(ze),I.matrixWorld.compose(I.position,I.quaternion,I.scale),I.matrixWorldInverse.getInverse(I.matrixWorld);var Me=k+ze,G=V+ze,He=ie-Be,be=Ue+(O-Be),ke=te*V/G*Me,de=$*V/G*Me;I.projectionMatrix.makePerspective(He,be,ke,de,Me,G)}function b(I,D){D===null?I.matrixWorld.copy(I.matrix):I.matrixWorld.multiplyMatrices(D.matrixWorld,I.matrix),I.matrixWorldInverse.getInverse(I.matrixWorld)}this.getCamera=function(I){h.near=u.near=c.near=I.near,h.far=u.far=c.far=I.far,(f!==h.near||d!==h.far)&&(i.updateRenderState({depthNear:h.near,depthFar:h.far}),f=h.near,d=h.far);var D=I.parent,B=h.cameras;b(h,D);for(var O=0;O<B.length;O++)b(B[O],D);I.matrixWorld.copy(h.matrixWorld);for(var F=I.children,O=0,N=F.length;O<N;O++)F[O].updateMatrixWorld(!0);return S(h,c,u),h};var A=null;function C(I,D){if(o=D.getViewerPose(r),o!==null){var B=o.views,O=i.renderState.baseLayer;e.setFramebuffer(O.framebuffer);for(var F=0;F<B.length;F++){var N=B[F],k=O.getViewport(N),V=h.cameras[F];V.matrix.fromArray(N.transform.matrix),V.projectionMatrix.fromArray(N.projectionMatrix),V.viewport.set(k.x,k.y,k.width,k.height),F===0&&h.matrix.copy(V.matrix)}}for(var te=i.inputSources,F=0;F<s.length;F++){var $=s[F],X=te[F],Y=null,ie=null;X&&($.targetRay&&(Y=D.getPose(X.targetRaySpace,r),Y!==null&&($.targetRay.matrix.fromArray(Y.transform.matrix),$.targetRay.matrix.decompose($.targetRay.position,$.targetRay.rotation,$.targetRay.scale))),$.grip&&X.gripSpace&&(ie=D.getPose(X.gripSpace,r),ie!==null&&($.grip.matrix.fromArray(ie.transform.matrix),$.grip.matrix.decompose($.grip.position,$.grip.rotation,$.grip.scale)))),$.targetRay&&($.targetRay.visible=Y!==null),$.grip&&($.grip.visible=ie!==null)}A&&A(I,D)}var T=new oh;T.setAnimationLoop(C),this.setAnimationLoop=function(I){A=I},this.dispose=function(){}}Object.assign(ph.prototype,In.prototype);function ql(e){e=e||{};var t=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=e.context!==void 0?e.context:null,i=e.alpha!==void 0?e.alpha:!1,r=e.depth!==void 0?e.depth:!0,a=e.stencil!==void 0?e.stencil:!0,o=e.antialias!==void 0?e.antialias:!1,s=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,l=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,c=e.powerPreference!==void 0?e.powerPreference:"default",u=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,h=null,f=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Ft,this.physicallyCorrectLights=!1,this.toneMapping=Bl,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var d=this,p=!1,m=null,v=0,y=0,x=null,w=null,S=-1,b={geometry:null,program:null,wireframe:!1},A=null,C=null,T=new Ze,I=new Ze,D=null,B=t.width,O=t.height,F=1,N=null,k=null,V=new Ze(0,0,B,O),te=new Ze(0,0,B,O),$=!1,X=new Sa,Y=new rv,ie=!1,Ue=!1,ze=new Re,Be=new M;function Me(){return x===null?F:1}var G;try{var He={alpha:i,depth:r,stencil:a,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:l,powerPreference:c,failIfMajorPerformanceCaveat:u,xrCompatible:!0};if(t.addEventListener("webglcontextlost",se,!1),t.addEventListener("webglcontextrestored",R,!1),G=n||t.getContext("webgl",He)||t.getContext("experimental-webgl",He),G===null)throw t.getContext("webgl")!==null?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(g){throw console.error("THREE.WebGLRenderer: "+g.message),g}var be,ke,de,W,Ce,Ge,tt,qt,rt,E,L,Z,H,Ie,pe,ce,ge;function De(){be=new av(G),ke=new iv(G,be,e),ke.isWebGL2===!1&&(be.get("WEBGL_depth_texture"),be.get("OES_texture_float"),be.get("OES_texture_half_float"),be.get("OES_texture_half_float_linear"),be.get("OES_standard_derivatives"),be.get("OES_element_index_uint"),be.get("ANGLE_instanced_arrays")),be.get("OES_texture_float_linear"),ge=new Mg(G,be,ke),de=new wg(G,be,ke),de.scissor(I.copy(te).multiplyScalar(F).floor()),de.viewport(T.copy(V).multiplyScalar(F).floor()),W=new lv,Ce=new ug,Ge=new bg(G,be,de,Ce,ke,ge,W),tt=new Nd(G,ke),qt=new ov(G,tt,W),rt=new hv(G,qt,tt,W),Ie=new uv(G),E=new cg(d,be,ke),L=new dg,Z=new yg,H=new tv(d,de,rt,s),pe=new nv(G,be,W,ke),ce=new sv(G,be,W,ke),W.programs=E.programs,d.capabilities=ke,d.extensions=be,d.properties=Ce,d.renderLists=L,d.state=de,d.info=W}De();var me=new ph(d,G);this.xr=me;var re=new Sg(d,G),he=new dh(d,rt,ke.maxTextureSize);this.shadowMap=he,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){var g=be.get("WEBGL_lose_context");g&&g.loseContext()},this.forceContextRestore=function(){var g=be.get("WEBGL_lose_context");g&&g.restoreContext()},this.getPixelRatio=function(){return F},this.setPixelRatio=function(g){g!==void 0&&(F=g,this.setSize(B,O,!1))},this.getSize=function(g){return g===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),g=new U),g.set(B,O)},this.setSize=function(g,_,P){if(me.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}B=g,O=_,t.width=Math.floor(g*F),t.height=Math.floor(_*F),P!==!1&&(t.style.width=g+"px",t.style.height=_+"px"),this.setViewport(0,0,g,_)},this.getDrawingBufferSize=function(g){return g===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),g=new U),g.set(B*F,O*F).floor()},this.setDrawingBufferSize=function(g,_,P){B=g,O=_,F=P,t.width=Math.floor(g*P),t.height=Math.floor(_*P),this.setViewport(0,0,g,_)},this.getCurrentViewport=function(g){return g===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),g=new Ze),g.copy(T)},this.getViewport=function(g){return g.copy(V)},this.setViewport=function(g,_,P,z){g.isVector4?V.set(g.x,g.y,g.z,g.w):V.set(g,_,P,z),de.viewport(T.copy(V).multiplyScalar(F).floor())},this.getScissor=function(g){return g.copy(te)},this.setScissor=function(g,_,P,z){g.isVector4?te.set(g.x,g.y,g.z,g.w):te.set(g,_,P,z),de.scissor(I.copy(te).multiplyScalar(F).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(g){de.setScissorTest($=g)},this.setOpaqueSort=function(g){N=g},this.setTransparentSort=function(g){k=g},this.getClearColor=function(){return H.getClearColor()},this.setClearColor=function(){H.setClearColor.apply(H,arguments)},this.getClearAlpha=function(){return H.getClearAlpha()},this.setClearAlpha=function(){H.setClearAlpha.apply(H,arguments)},this.clear=function(g,_,P){var z=0;(g===void 0||g)&&(z|=16384),(_===void 0||_)&&(z|=256),(P===void 0||P)&&(z|=1024),G.clear(z)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",se,!1),t.removeEventListener("webglcontextrestored",R,!1),L.dispose(),Z.dispose(),Ce.dispose(),rt.dispose(),me.dispose(),qe.stop()};function se(g){g.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function R(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,De()}function q(g){var _=g.target;_.removeEventListener("dispose",q),oe(_)}function oe(g){Se(g),Ce.remove(g)}function Se(g){var _=Ce.get(g).program;g.program=void 0,_!==void 0&&E.releaseProgram(_)}function ae(g,_){g.render(function(P){d.renderBufferImmediate(P,_)})}this.renderBufferImmediate=function(g,_){de.initAttributes();var P=Ce.get(g);g.hasPositions&&!P.position&&(P.position=G.createBuffer()),g.hasNormals&&!P.normal&&(P.normal=G.createBuffer()),g.hasUvs&&!P.uv&&(P.uv=G.createBuffer()),g.hasColors&&!P.color&&(P.color=G.createBuffer());var z=_.getAttributes();g.hasPositions&&(G.bindBuffer(34962,P.position),G.bufferData(34962,g.positionArray,35048),de.enableAttribute(z.position),G.vertexAttribPointer(z.position,3,5126,!1,0,0)),g.hasNormals&&(G.bindBuffer(34962,P.normal),G.bufferData(34962,g.normalArray,35048),de.enableAttribute(z.normal),G.vertexAttribPointer(z.normal,3,5126,!1,0,0)),g.hasUvs&&(G.bindBuffer(34962,P.uv),G.bufferData(34962,g.uvArray,35048),de.enableAttribute(z.uv),G.vertexAttribPointer(z.uv,2,5126,!1,0,0)),g.hasColors&&(G.bindBuffer(34962,P.color),G.bufferData(34962,g.colorArray,35048),de.enableAttribute(z.color),G.vertexAttribPointer(z.color,3,5126,!1,0,0)),de.disableUnusedAttributes(),G.drawArrays(4,0,g.count),g.count=0};var Ne=new En;this.renderBufferDirect=function(g,_,P,z,j,ve){_===null&&(_=Ne);var le=j.isMesh&&j.matrixWorld.determinant()<0,Oe=Ea(g,_,z,j);de.setMaterial(z,le);var Ee=!1;(b.geometry!==P.id||b.program!==Oe.id||b.wireframe!==(z.wireframe===!0))&&(b.geometry=P.id,b.program=Oe.id,b.wireframe=z.wireframe===!0,Ee=!0),(z.morphTargets||z.morphNormals)&&(Ie.update(j,P,z,Oe),Ee=!0);var Ae=P.index,Xe=P.attributes.position;if(Ae===null){if(Xe===void 0||Xe.count===0)return}else if(Ae.count===0)return;var We=1;z.wireframe===!0&&(Ae=qt.getWireframeAttribute(P),We=2);var Fe,ue=pe;Ae!==null&&(Fe=tt.get(Ae),ue=ce,ue.setIndex(Fe)),Ee&&($e(j,P,z,Oe),Ae!==null&&G.bindBuffer(34963,Fe.buffer));var ye=Ae!==null?Ae.count:Xe.count,rn=P.drawRange.start*We,dt=P.drawRange.count*We,Si=ve!==null?ve.start*We:0,Dt=ve!==null?ve.count*We:1/0,Et=Math.max(rn,Si),as=Math.min(ye,rn+dt,Si+Dt)-1,Aa=Math.max(0,as-Et+1);if(Aa!==0){if(j.isMesh)z.wireframe===!0?(de.setLineWidth(z.wireframeLinewidth*Me()),ue.setMode(1)):ue.setMode(4);else if(j.isLine){var os=z.linewidth;os===void 0&&(os=1),de.setLineWidth(os*Me()),j.isLineSegments?ue.setMode(1):j.isLineLoop?ue.setMode(2):ue.setMode(3)}else j.isPoints?ue.setMode(0):j.isSprite&&ue.setMode(4);j.isInstancedMesh?ue.renderInstances(P,Et,Aa,j.count):P.isInstancedBufferGeometry?ue.renderInstances(P,Et,Aa,P.maxInstancedCount):ue.render(Et,Aa)}};function $e(g,_,P,z){if(!(ke.isWebGL2===!1&&(g.isInstancedMesh||_.isInstancedBufferGeometry)&&be.get("ANGLE_instanced_arrays")===null)){de.initAttributes();var j=_.attributes,ve=z.getAttributes(),le=P.defaultAttributeValues;for(var Oe in ve){var Ee=ve[Oe];if(Ee>=0){var Ae=j[Oe];if(Ae!==void 0){var Xe=Ae.normalized,We=Ae.itemSize,Fe=tt.get(Ae);if(Fe===void 0)continue;var ue=Fe.buffer,ye=Fe.type,rn=Fe.bytesPerElement;if(Ae.isInterleavedBufferAttribute){var dt=Ae.data,Si=dt.stride,Dt=Ae.offset;dt&&dt.isInstancedInterleavedBuffer?(de.enableAttributeAndDivisor(Ee,dt.meshPerAttribute),_.maxInstancedCount===void 0&&(_.maxInstancedCount=dt.meshPerAttribute*dt.count)):de.enableAttribute(Ee),G.bindBuffer(34962,ue),G.vertexAttribPointer(Ee,We,ye,Xe,Si*rn,Dt*rn)}else Ae.isInstancedBufferAttribute?(de.enableAttributeAndDivisor(Ee,Ae.meshPerAttribute),_.maxInstancedCount===void 0&&(_.maxInstancedCount=Ae.meshPerAttribute*Ae.count)):de.enableAttribute(Ee),G.bindBuffer(34962,ue),G.vertexAttribPointer(Ee,We,ye,Xe,0,0)}else if(Oe==="instanceMatrix"){var Fe=tt.get(g.instanceMatrix);if(Fe===void 0)continue;var ue=Fe.buffer,ye=Fe.type;de.enableAttributeAndDivisor(Ee+0,1),de.enableAttributeAndDivisor(Ee+1,1),de.enableAttributeAndDivisor(Ee+2,1),de.enableAttributeAndDivisor(Ee+3,1),G.bindBuffer(34962,ue),G.vertexAttribPointer(Ee+0,4,ye,!1,64,0),G.vertexAttribPointer(Ee+1,4,ye,!1,64,16),G.vertexAttribPointer(Ee+2,4,ye,!1,64,32),G.vertexAttribPointer(Ee+3,4,ye,!1,64,48)}else if(le!==void 0){var Et=le[Oe];if(Et!==void 0)switch(Et.length){case 2:G.vertexAttrib2fv(Ee,Et);break;case 3:G.vertexAttrib3fv(Ee,Et);break;case 4:G.vertexAttrib4fv(Ee,Et);break;default:G.vertexAttrib1fv(Ee,Et)}}}}de.disableUnusedAttributes()}}this.compile=function(g,_){f=Z.get(g,_),f.init(),g.traverse(function(z){z.isLight&&(f.pushLight(z),z.castShadow&&f.pushShadow(z))}),f.setupLights(_);var P={};g.traverse(function(z){if(z.material)if(Array.isArray(z.material))for(var j=0;j<z.material.length;j++)z.material[j].uuid in P||(Yt(z.material[j],g,z),P[z.material[j].uuid]=!0);else z.material.uuid in P||(Yt(z.material,g,z),P[z.material.uuid]=!0)})};var nt=null;function Xt(g){me.isPresenting||nt&&nt(g)}var qe=new oh;qe.setAnimationLoop(Xt),typeof window<"u"&&qe.setContext(window),this.setAnimationLoop=function(g){nt=g,me.setAnimationLoop(g),qe.start()},this.render=function(g,_){var P,z;if(arguments[2]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),P=arguments[2]),arguments[3]!==void 0&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),z=arguments[3]),!(_&&_.isCamera)){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!p){b.geometry=null,b.program=null,b.wireframe=!1,S=-1,A=null,g.autoUpdate===!0&&g.updateMatrixWorld(),_.parent===null&&_.updateMatrixWorld(),me.enabled&&me.isPresenting&&(_=me.getCamera(_)),f=Z.get(g,_),f.init(),g.onBeforeRender(d,g,_,P||x),ze.multiplyMatrices(_.projectionMatrix,_.matrixWorldInverse),X.setFromProjectionMatrix(ze),Ue=this.localClippingEnabled,ie=Y.init(this.clippingPlanes,Ue,_),h=L.get(g,_),h.init(),It(g,_,0,d.sortObjects),d.sortObjects===!0&&h.sort(N,k),ie&&Y.beginShadows();var j=f.state.shadowsArray;he.render(j,g,_),f.setupLights(_),ie&&Y.endShadows(),this.info.autoReset&&this.info.reset(),P!==void 0&&this.setRenderTarget(P),me.enabled&&re.isAvailable()&&re.attachCamera(_),H.render(h,g,_,z);var ve=h.opaque,le=h.transparent;if(g.overrideMaterial){var Oe=g.overrideMaterial;ve.length&&St(ve,g,_,Oe),le.length&&St(le,g,_,Oe)}else ve.length&&St(ve,g,_),le.length&&St(le,g,_);g.onAfterRender(d,g,_),x!==null&&(Ge.updateRenderTargetMipmap(x),Ge.updateMultisampleRenderTarget(x)),de.buffers.depth.setTest(!0),de.buffers.depth.setMask(!0),de.buffers.color.setMask(!0),de.setPolygonOffset(!1),me.enabled&&re.isAvailable()&&re.detachCamera(_),h=null,f=null}};function It(g,_,P,z){if(g.visible!==!1){var j=g.layers.test(_.layers);if(j){if(g.isGroup)P=g.renderOrder;else if(g.isLOD)g.autoUpdate===!0&&g.update(_);else if(g.isLight)f.pushLight(g),g.castShadow&&f.pushShadow(g);else if(g.isSprite){if(!g.frustumCulled||X.intersectsSprite(g)){z&&Be.setFromMatrixPosition(g.matrixWorld).applyMatrix4(ze);var ve=rt.update(g),le=g.material;le.visible&&h.push(g,ve,le,P,Be.z,null)}}else if(g.isImmediateRenderObject)z&&Be.setFromMatrixPosition(g.matrixWorld).applyMatrix4(ze),h.push(g,null,g.material,P,Be.z,null);else if((g.isMesh||g.isLine||g.isPoints)&&(g.isSkinnedMesh&&g.skeleton.frame!==W.render.frame&&(g.skeleton.update(),g.skeleton.frame=W.render.frame),!g.frustumCulled||X.intersectsObject(g))){z&&Be.setFromMatrixPosition(g.matrixWorld).applyMatrix4(ze);var ve=rt.update(g),le=g.material;if(Array.isArray(le))for(var Oe=ve.groups,Ee=0,Ae=Oe.length;Ee<Ae;Ee++){var Xe=Oe[Ee],We=le[Xe.materialIndex];We&&We.visible&&h.push(g,ve,We,P,Be.z,Xe)}else le.visible&&h.push(g,ve,le,P,Be.z,null)}}for(var Fe=g.children,Ee=0,Ae=Fe.length;Ee<Ae;Ee++)It(Fe[Ee],_,P,z)}}function St(g,_,P,z){for(var j=0,ve=g.length;j<ve;j++){var le=g[j],Oe=le.object,Ee=le.geometry,Ae=z===void 0?le.material:z,Xe=le.group;if(P.isArrayCamera)if(C=P,me.enabled&&re.isAvailable())bi(Oe,_,P,Ee,Ae,Xe);else for(var We=P.cameras,Fe=0,ue=We.length;Fe<ue;Fe++){var ye=We[Fe];Oe.layers.test(ye.layers)&&(de.viewport(T.copy(ye.viewport)),f.setupLights(ye),bi(Oe,_,ye,Ee,Ae,Xe))}else C=null,bi(Oe,_,P,Ee,Ae,Xe)}}function bi(g,_,P,z,j,ve){if(g.onBeforeRender(d,_,P,z,j,ve),f=Z.get(_,C||P),g.modelViewMatrix.multiplyMatrices(P.matrixWorldInverse,g.matrixWorld),g.normalMatrix.getNormalMatrix(g.modelViewMatrix),g.isImmediateRenderObject){var le=Ea(P,_,j,g);de.setMaterial(j),b.geometry=null,b.program=null,b.wireframe=!1,ae(g,le)}else d.renderBufferDirect(P,_,z,j,g,ve);g.onAfterRender(d,_,P,z,j,ve),f=Z.get(_,C||P)}function Yt(g,_,P){var z=Ce.get(g),j=f.state.lights,ve=f.state.shadowsArray,le=j.state.version,Oe=E.getParameters(g,j.state,ve,_,Y.numPlanes,Y.numIntersection,P),Ee=E.getProgramCacheKey(Oe),Ae=z.program,Xe=!0;if(Ae===void 0)g.addEventListener("dispose",q);else if(Ae.cacheKey!==Ee)Se(g);else if(z.lightsStateVersion!==le)z.lightsStateVersion=le,Xe=!1;else{if(Oe.shaderID!==void 0)return;Xe=!1}Xe&&(Ae=E.acquireProgram(Oe,Ee),z.program=Ae,z.uniforms=Oe.uniforms,z.environment=g.isMeshStandardMaterial?_.environment:null,z.outputEncoding=d.outputEncoding,g.program=Ae);var We=Ae.getAttributes();if(g.morphTargets){g.numSupportedMorphTargets=0;for(var Fe=0;Fe<d.maxMorphTargets;Fe++)We["morphTarget"+Fe]>=0&&g.numSupportedMorphTargets++}if(g.morphNormals){g.numSupportedMorphNormals=0;for(var Fe=0;Fe<d.maxMorphNormals;Fe++)We["morphNormal"+Fe]>=0&&g.numSupportedMorphNormals++}var ue=z.uniforms;(!g.isShaderMaterial&&!g.isRawShaderMaterial||g.clipping===!0)&&(z.numClippingPlanes=Y.numPlanes,z.numIntersection=Y.numIntersection,ue.clippingPlanes=Y.uniform),z.fog=_.fog,z.needsLights=Kh(g),z.lightsStateVersion=le,z.needsLights&&(ue.ambientLightColor.value=j.state.ambient,ue.lightProbe.value=j.state.probe,ue.directionalLights.value=j.state.directional,ue.spotLights.value=j.state.spot,ue.rectAreaLights.value=j.state.rectArea,ue.pointLights.value=j.state.point,ue.hemisphereLights.value=j.state.hemi,ue.directionalShadowMap.value=j.state.directionalShadowMap,ue.directionalShadowMatrix.value=j.state.directionalShadowMatrix,ue.spotShadowMap.value=j.state.spotShadowMap,ue.spotShadowMatrix.value=j.state.spotShadowMatrix,ue.pointShadowMap.value=j.state.pointShadowMap,ue.pointShadowMatrix.value=j.state.pointShadowMatrix);var ye=z.program.getUniforms(),rn=Wn.seqWithValue(ye.seq,ue);z.uniformsList=rn}function Ea(g,_,P,z){Ge.resetTextureUnits();var j=_.fog,ve=P.isMeshStandardMaterial?_.environment:null,le=Ce.get(P),Oe=f.state.lights;if(ie&&(Ue||g!==A)){var Ee=g===A&&P.id===S;Y.setState(P.clippingPlanes,P.clipIntersection,P.clipShadows,g,le,Ee)}P.version===le.__version?(le.program===void 0||P.fog&&le.fog!==j||le.environment!==ve||le.needsLights&&le.lightsStateVersion!==Oe.state.version||le.numClippingPlanes!==void 0&&(le.numClippingPlanes!==Y.numPlanes||le.numIntersection!==Y.numIntersection)||le.outputEncoding!==d.outputEncoding)&&Yt(P,_,z):(Yt(P,_,z),le.__version=P.version);var Ae=!1,Xe=!1,We=!1,Fe=le.program,ue=Fe.getUniforms(),ye=le.uniforms;if(de.useProgram(Fe.program)&&(Ae=!0,Xe=!0,We=!0),P.id!==S&&(S=P.id,Xe=!0),Ae||A!==g){if(Fe.numMultiviewViews>0?re.updateCameraProjectionMatricesUniform(g,ue):ue.setValue(G,"projectionMatrix",g.projectionMatrix),ke.logarithmicDepthBuffer&&ue.setValue(G,"logDepthBufFC",2/(Math.log(g.far+1)/Math.LN2)),A!==g&&(A=g,Xe=!0,We=!0),P.isShaderMaterial||P.isMeshPhongMaterial||P.isMeshToonMaterial||P.isMeshStandardMaterial||P.envMap){var rn=ue.map.cameraPosition;rn!==void 0&&rn.setValue(G,Be.setFromMatrixPosition(g.matrixWorld))}(P.isMeshPhongMaterial||P.isMeshToonMaterial||P.isMeshLambertMaterial||P.isMeshBasicMaterial||P.isMeshStandardMaterial||P.isShaderMaterial)&&ue.setValue(G,"isOrthographic",g.isOrthographicCamera===!0),(P.isMeshPhongMaterial||P.isMeshToonMaterial||P.isMeshLambertMaterial||P.isMeshBasicMaterial||P.isMeshStandardMaterial||P.isShaderMaterial||P.skinning)&&(Fe.numMultiviewViews>0?re.updateCameraViewMatricesUniform(g,ue):ue.setValue(G,"viewMatrix",g.matrixWorldInverse))}if(P.skinning){ue.setOptional(G,z,"bindMatrix"),ue.setOptional(G,z,"bindMatrixInverse");var dt=z.skeleton;if(dt){var Si=dt.bones;if(ke.floatVertexTextures){if(dt.boneTexture===void 0){var Dt=Math.sqrt(Si.length*4);Dt=Le.ceilPowerOfTwo(Dt),Dt=Math.max(Dt,4);var Et=new Float32Array(Dt*Dt*4);Et.set(dt.boneMatrices);var as=new tr(Et,Dt,Dt,hn,kr);dt.boneMatrices=Et,dt.boneTexture=as,dt.boneTextureSize=Dt}ue.setValue(G,"boneTexture",dt.boneTexture,Ge),ue.setValue(G,"boneTextureSize",dt.boneTextureSize)}else ue.setOptional(G,dt,"boneMatrices")}}return(Xe||le.receiveShadow!==z.receiveShadow)&&(le.receiveShadow=z.receiveShadow,ue.setValue(G,"receiveShadow",z.receiveShadow)),Xe&&(ue.setValue(G,"toneMappingExposure",d.toneMappingExposure),ue.setValue(G,"toneMappingWhitePoint",d.toneMappingWhitePoint),le.needsLights&&$h(ye,We),j&&P.fog&&Vh(ye,j),P.isMeshBasicMaterial?Gt(ye,P):P.isMeshLambertMaterial?(Gt(ye,P),Hh(ye,P)):P.isMeshToonMaterial?(Gt(ye,P),jh(ye,P)):P.isMeshPhongMaterial?(Gt(ye,P),Wh(ye,P)):P.isMeshStandardMaterial?(Gt(ye,P,ve),P.isMeshPhysicalMaterial?qh(ye,P,ve):ic(ye,P,ve)):P.isMeshMatcapMaterial?(Gt(ye,P),Xh(ye,P)):P.isMeshDepthMaterial?(Gt(ye,P),Yh(ye,P)):P.isMeshDistanceMaterial?(Gt(ye,P),Zh(ye,P)):P.isMeshNormalMaterial?(Gt(ye,P),Jh(ye,P)):P.isLineBasicMaterial?(Ta(ye,P),P.isLineDashedMaterial&&Mi(ye,P)):P.isPointsMaterial?Uh(ye,P):P.isSpriteMaterial?Gh(ye,P):P.isShadowMaterial&&(ye.color.value.copy(P.color),ye.opacity.value=P.opacity),ye.ltc_1!==void 0&&(ye.ltc_1.value=J.LTC_1),ye.ltc_2!==void 0&&(ye.ltc_2.value=J.LTC_2),Wn.upload(G,le.uniformsList,ye,Ge),P.isShaderMaterial&&(P.uniformsNeedUpdate=!1)),P.isShaderMaterial&&P.uniformsNeedUpdate===!0&&(Wn.upload(G,le.uniformsList,ye,Ge),P.uniformsNeedUpdate=!1),P.isSpriteMaterial&&ue.setValue(G,"center",z.center),Fe.numMultiviewViews>0?re.updateObjectMatricesUniforms(z,g,ue):(ue.setValue(G,"modelViewMatrix",z.modelViewMatrix),ue.setValue(G,"normalMatrix",z.normalMatrix)),ue.setValue(G,"modelMatrix",z.matrixWorld),Fe}function Gt(g,_,P){g.opacity.value=_.opacity,_.color&&g.diffuse.value.copy(_.color),_.emissive&&g.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap),_.specularMap&&(g.specularMap.value=_.specularMap);var z=_.envMap||P;z&&(g.envMap.value=z,g.flipEnvMap.value=z.isCubeTexture?-1:1,g.reflectivity.value=_.reflectivity,g.refractionRatio.value=_.refractionRatio,g.maxMipLevel.value=Ce.get(z).__maxMipLevel),_.lightMap&&(g.lightMap.value=_.lightMap,g.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(g.aoMap.value=_.aoMap,g.aoMapIntensity.value=_.aoMapIntensity);var j;_.map?j=_.map:_.specularMap?j=_.specularMap:_.displacementMap?j=_.displacementMap:_.normalMap?j=_.normalMap:_.bumpMap?j=_.bumpMap:_.roughnessMap?j=_.roughnessMap:_.metalnessMap?j=_.metalnessMap:_.alphaMap?j=_.alphaMap:_.emissiveMap&&(j=_.emissiveMap),j!==void 0&&(j.isWebGLRenderTarget&&(j=j.texture),j.matrixAutoUpdate===!0&&j.updateMatrix(),g.uvTransform.value.copy(j.matrix));var ve;_.aoMap?ve=_.aoMap:_.lightMap&&(ve=_.lightMap),ve!==void 0&&(ve.isWebGLRenderTarget&&(ve=ve.texture),ve.matrixAutoUpdate===!0&&ve.updateMatrix(),g.uv2Transform.value.copy(ve.matrix))}function Ta(g,_){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity}function Mi(g,_){g.dashSize.value=_.dashSize,g.totalSize.value=_.dashSize+_.gapSize,g.scale.value=_.scale}function Uh(g,_){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity,g.size.value=_.size*F,g.scale.value=O*.5,_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap);var P;_.map?P=_.map:_.alphaMap&&(P=_.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),g.uvTransform.value.copy(P.matrix))}function Gh(g,_){g.diffuse.value.copy(_.color),g.opacity.value=_.opacity,g.rotation.value=_.rotation,_.map&&(g.map.value=_.map),_.alphaMap&&(g.alphaMap.value=_.alphaMap);var P;_.map?P=_.map:_.alphaMap&&(P=_.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),g.uvTransform.value.copy(P.matrix))}function Vh(g,_){g.fogColor.value.copy(_.color),_.isFog?(g.fogNear.value=_.near,g.fogFar.value=_.far):_.isFogExp2&&(g.fogDensity.value=_.density)}function Hh(g,_){_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap)}function Wh(g,_){g.specular.value.copy(_.specular),g.shininess.value=Math.max(_.shininess,1e-4),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function jh(g,_){g.specular.value.copy(_.specular),g.shininess.value=Math.max(_.shininess,1e-4),_.gradientMap&&(g.gradientMap.value=_.gradientMap),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function ic(g,_,P){g.roughness.value=_.roughness,g.metalness.value=_.metalness,_.roughnessMap&&(g.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(g.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(g.emissiveMap.value=_.emissiveMap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias),(_.envMap||P)&&(g.envMapIntensity.value=_.envMapIntensity)}function qh(g,_,P){ic(g,_,P),g.reflectivity.value=_.reflectivity,g.clearcoat.value=_.clearcoat,g.clearcoatRoughness.value=_.clearcoatRoughness,_.sheen&&g.sheen.value.copy(_.sheen),_.clearcoatNormalMap&&(g.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),g.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===mt&&g.clearcoatNormalScale.value.negate()),g.transparency.value=_.transparency}function Xh(g,_){_.matcap&&(g.matcap.value=_.matcap),_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function Yh(g,_){_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function Zh(g,_){_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias),g.referencePosition.value.copy(_.referencePosition),g.nearDistance.value=_.nearDistance,g.farDistance.value=_.farDistance}function Jh(g,_){_.bumpMap&&(g.bumpMap.value=_.bumpMap,g.bumpScale.value=_.bumpScale,_.side===mt&&(g.bumpScale.value*=-1)),_.normalMap&&(g.normalMap.value=_.normalMap,g.normalScale.value.copy(_.normalScale),_.side===mt&&g.normalScale.value.negate()),_.displacementMap&&(g.displacementMap.value=_.displacementMap,g.displacementScale.value=_.displacementScale,g.displacementBias.value=_.displacementBias)}function $h(g,_){g.ambientLightColor.needsUpdate=_,g.lightProbe.needsUpdate=_,g.directionalLights.needsUpdate=_,g.pointLights.needsUpdate=_,g.spotLights.needsUpdate=_,g.rectAreaLights.needsUpdate=_,g.hemisphereLights.needsUpdate=_}function Kh(g){return g.isMeshLambertMaterial||g.isMeshToonMaterial||g.isMeshPhongMaterial||g.isMeshStandardMaterial||g.isShadowMaterial||g.isShaderMaterial&&g.lights===!0}this.setFramebuffer=function(g){m!==g&&x===null&&G.bindFramebuffer(36160,g),m=g},this.getActiveCubeFace=function(){return v},this.getActiveMipmapLevel=function(){return y},this.getRenderTarget=function(){return x},this.setRenderTarget=function(g,_,P){x=g,v=_,y=P,g&&Ce.get(g).__webglFramebuffer===void 0&&Ge.setupRenderTarget(g);var z=m,j=!1;if(g){var ve=Ce.get(g).__webglFramebuffer;g.isWebGLCubeRenderTarget?(z=ve[_||0],j=!0):g.isWebGLMultisampleRenderTarget?z=Ce.get(g).__webglMultisampledFramebuffer:z=ve,T.copy(g.viewport),I.copy(g.scissor),D=g.scissorTest}else T.copy(V).multiplyScalar(F).floor(),I.copy(te).multiplyScalar(F).floor(),D=$;if(w!==z&&(G.bindFramebuffer(36160,z),w=z),de.viewport(T),de.scissor(I),de.setScissorTest(D),j){var le=Ce.get(g.texture);G.framebufferTexture2D(36160,36064,34069+(_||0),le.__webglTexture,P||0)}},this.readRenderTargetPixels=function(g,_,P,z,j,ve,le){if(!(g&&g.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}var Oe=Ce.get(g).__webglFramebuffer;if(g.isWebGLCubeRenderTarget&&le!==void 0&&(Oe=Oe[le]),Oe){var Ee=!1;Oe!==w&&(G.bindFramebuffer(36160,Oe),Ee=!0);try{var Ae=g.texture,Xe=Ae.format,We=Ae.type;if(Xe!==hn&&ge.convert(Xe)!==G.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(We!==ns&&ge.convert(We)!==G.getParameter(35738)&&!(We===kr&&(ke.isWebGL2||be.get("OES_texture_float")||be.get("WEBGL_color_buffer_float")))&&!(We===Hl&&(ke.isWebGL2?be.get("EXT_color_buffer_float"):be.get("EXT_color_buffer_half_float")))){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}G.checkFramebufferStatus(36160)===36053?_>=0&&_<=g.width-z&&P>=0&&P<=g.height-j&&G.readPixels(_,P,z,j,ge.convert(Xe),ge.convert(We),ve):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{Ee&&G.bindFramebuffer(36160,w)}}},this.copyFramebufferToTexture=function(g,_,P){P===void 0&&(P=0);var z=Math.pow(2,-P),j=Math.floor(_.image.width*z),ve=Math.floor(_.image.height*z),le=ge.convert(_.format);Ge.setTexture2D(_,0),G.copyTexImage2D(3553,P,le,g.x,g.y,j,ve,0),de.unbindTexture()},this.copyTextureToTexture=function(g,_,P,z){var j=_.image.width,ve=_.image.height,le=ge.convert(P.format),Oe=ge.convert(P.type);Ge.setTexture2D(P,0),_.isDataTexture?G.texSubImage2D(3553,z||0,g.x,g.y,j,ve,le,Oe,_.image.data):G.texSubImage2D(3553,z||0,g.x,g.y,le,Oe,_.image),de.unbindTexture()},this.initTexture=function(g){Ge.setTexture2D(g,0),de.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function $s(e,t){this.name="",this.color=new ee(e),this.density=t!==void 0?t:25e-5}Object.assign($s.prototype,{isFogExp2:!0,clone:function(){return new $s(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});function Ks(e,t,n){this.name="",this.color=new ee(e),this.near=t!==void 0?t:1,this.far=n!==void 0?n:1e3}Object.assign(Ks.prototype,{isFog:!0,clone:function(){return new Ks(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}});function Zn(e,t){this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=is,this.updateRange={offset:0,count:-1},this.version=0}Object.defineProperty(Zn.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}});Object.assign(Zn.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var i=0,r=this.stride;i<r;i++)this.array[e+i]=t.array[n+i];return this},set:function(e,t){return t===void 0&&(t=0),this.array.set(e,t),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var si=new M;function _o(e,t,n,i){this.data=e,this.itemSize=t,this.offset=n,this.normalized=i===!0}Object.defineProperties(_o.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}});Object.assign(_o.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)si.x=this.getX(t),si.y=this.getY(t),si.z=this.getZ(t),si.applyMatrix4(e),this.setXYZ(t,si.x,si.y,si.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,i){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this},setXYZW:function(e,t,n,i,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=r,this}});function yi(e){xe.call(this),this.type="SpriteMaterial",this.color=new ee(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}yi.prototype=Object.create(xe.prototype);yi.prototype.constructor=yi;yi.prototype.isSpriteMaterial=!0;yi.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Bi,Ar=new M,ki=new M,zi=new M,Ui=new U,Lr=new U,mh=new Re,Ha=new M,Cr=new M,Wa=new M,Hc=new U,Cs=new U,Wc=new U;function Qs(e){if(Q.call(this),this.type="Sprite",Bi===void 0){Bi=new ne;var t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new Zn(t,5);Bi.setIndex([0,1,2,0,2,3]),Bi.setAttribute("position",new _o(n,3,0,!1)),Bi.setAttribute("uv",new _o(n,2,3,!1))}this.geometry=Bi,this.material=e!==void 0?e:new yi,this.center=new U(.5,.5)}Qs.prototype=Object.assign(Object.create(Q.prototype),{constructor:Qs,isSprite:!0,raycast:function(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ki.setFromMatrixScale(this.matrixWorld),mh.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),zi.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&ki.multiplyScalar(-zi.z);var n=this.material.rotation,i,r;n!==0&&(r=Math.cos(n),i=Math.sin(n));var a=this.center;ja(Ha.set(-.5,-.5,0),zi,a,ki,i,r),ja(Cr.set(.5,-.5,0),zi,a,ki,i,r),ja(Wa.set(.5,.5,0),zi,a,ki,i,r),Hc.set(0,0),Cs.set(1,0),Wc.set(1,1);var o=e.ray.intersectTriangle(Ha,Cr,Wa,!1,Ar);if(!(o===null&&(ja(Cr.set(-.5,.5,0),zi,a,ki,i,r),Cs.set(0,1),o=e.ray.intersectTriangle(Ha,Wa,Cr,!1,Ar),o===null))){var s=e.ray.origin.distanceTo(Ar);s<e.near||s>e.far||t.push({distance:s,point:Ar.clone(),uv:xt.getUV(Ar,Ha,Cr,Wa,Hc,Cs,Wc,new U),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Q.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});function ja(e,t,n,i,r,a){Ui.subVectors(e,n).addScalar(.5).multiply(i),r!==void 0?(Lr.x=a*Ui.x-r*Ui.y,Lr.y=r*Ui.x+a*Ui.y):Lr.copy(Ui),e.copy(t),e.x+=Lr.x,e.y+=Lr.y,e.applyMatrix4(mh)}var qa=new M,jc=new M;function wo(){Q.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}wo.prototype=Object.assign(Object.create(Q.prototype),{constructor:wo,isLOD:!0,copy:function(e){Q.prototype.copy.call(this,e,!1);for(var t=e.levels,n=0,i=t.length;n<i;n++){var r=t[n];this.addLevel(r.object.clone(),r.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,t){t===void 0&&(t=0),t=Math.abs(t);for(var n=this.levels,i=0;i<n.length&&!(t<n[i].distance);i++);return n.splice(i,0,{distance:t,object:e}),this.add(e),this},getObjectForDistance:function(e){var t=this.levels;if(t.length>0){for(var n=1,i=t.length;n<i&&!(e<t[n].distance);n++);return t[n-1].object}return null},raycast:function(e,t){var n=this.levels;if(n.length>0){qa.setFromMatrixPosition(this.matrixWorld);var i=e.ray.origin.distanceTo(qa);this.getObjectForDistance(i).raycast(e,t)}},update:function(e){var t=this.levels;if(t.length>1){qa.setFromMatrixPosition(e.matrixWorld),jc.setFromMatrixPosition(this.matrixWorld);var n=qa.distanceTo(jc);t[0].object.visible=!0;for(var i=1,r=t.length;i<r&&n>=t[i].distance;i++)t[i-1].object.visible=!1,t[i].object.visible=!0;for(;i<r;i++)t[i].object.visible=!1}},toJSON:function(e){var t=Q.prototype.toJSON.call(this,e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var n=this.levels,i=0,r=n.length;i<r;i++){var a=n[i];t.object.levels.push({object:a.object.uuid,distance:a.distance})}return t}});function bo(e,t){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),et.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Re,this.bindMatrixInverse=new Re}bo.prototype=Object.assign(Object.create(et.prototype),{constructor:bo,isSkinnedMesh:!0,bind:function(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.getInverse(t)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Ze,t=this.geometry.attributes.skinWeight,n=0,i=t.count;n<i;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){et.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var qc=new Re,Eg=new Re;function el(e,t){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(this.bones.length*16),this.frame=-1,t===void 0)this.calculateInverses();else if(this.bones.length===t.length)this.boneInverses=t.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new Re)}}Object.assign(el.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,t=this.bones.length;e<t;e++){var n=new Re;this.bones[e]&&n.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(n)}},pose:function(){var e,t,n;for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&e.matrixWorld.getInverse(this.boneInverses[t]);for(t=0,n=this.bones.length;t<n;t++)e=this.bones[t],e&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture,r=0,a=e.length;r<a;r++){var o=e[r]?e[r].matrixWorld:Eg;qc.multiplyMatrices(o,t[r]),qc.toArray(n,r*16)}i!==void 0&&(i.needsUpdate=!0)},clone:function(){return new el(this.bones,this.boneInverses)},getBoneByName:function(e){for(var t=0,n=this.bones.length;t<n;t++){var i=this.bones[t];if(i.name===e)return i}}});function Xc(){Q.call(this),this.type="Bone"}Xc.prototype=Object.assign(Object.create(Q.prototype),{constructor:Xc,isBone:!0});var Yc=new Re,Zc=new Re,Gi=[],Rr=new et;function tl(e,t,n){et.call(this,e,t),this.instanceMatrix=new _e(new Float32Array(n*16),16),this.count=n,this.frustumCulled=!1}tl.prototype=Object.assign(Object.create(et.prototype),{constructor:tl,isInstancedMesh:!0,getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,e*16)},raycast:function(e,t){var n=this.matrixWorld,i=this.count;if(Rr.geometry=this.geometry,Rr.material=this.material,Rr.material!==void 0)for(var r=0;r<i;r++)this.getMatrixAt(r,Yc),Zc.multiplyMatrices(n,Yc),Rr.matrixWorld=Zc,Rr.raycast(e,Gi),Gi.length>0&&(Gi[0].instanceId=r,Gi[0].object=this,t.push(Gi[0]),Gi.length=0)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,e*16)},updateMorphTargets:function(){}});function lt(e){xe.call(this),this.type="LineBasicMaterial",this.color=new ee(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}lt.prototype=Object.create(xe.prototype);lt.prototype.constructor=lt;lt.prototype.isLineBasicMaterial=!0;lt.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this};var Jc=new M,$c=new M,Kc=new Re,Xa=new xr,Ya=new ei;function Wt(e,t,n){n===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Q.call(this),this.type="Line",this.geometry=e!==void 0?e:new ne,this.material=t!==void 0?t:new lt}Wt.prototype=Object.assign(Object.create(Q.prototype),{constructor:Wt,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[0],i=1,r=t.count;i<r;i++)Jc.fromBufferAttribute(t,i-1),$c.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Jc.distanceTo($c);e.setAttribute("lineDistance",new K(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var a=e.vertices,n=e.lineDistances;n[0]=0;for(var i=1,r=a.length;i<r;i++)n[i]=n[i-1],n[i]+=a[i-1].distanceTo(a[i])}return this},raycast:function(e,t){var n=e.linePrecision,i=this.geometry,r=this.matrixWorld;if(i.boundingSphere===null&&i.computeBoundingSphere(),Ya.copy(i.boundingSphere),Ya.applyMatrix4(r),Ya.radius+=n,e.ray.intersectsSphere(Ya)!==!1){Kc.getInverse(r),Xa.copy(e.ray).applyMatrix4(Kc);var a=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a,s=new M,l=new M,c=new M,u=new M,h=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var f=i.index,d=i.attributes,p=d.position.array;if(f!==null)for(var m=f.array,v=0,y=m.length-1;v<y;v+=h){var x=m[v],w=m[v+1];s.fromArray(p,x*3),l.fromArray(p,w*3);var S=Xa.distanceSqToSegment(s,l,u,c);if(!(S>o)){u.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(u);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}else for(var v=0,y=p.length/3-1;v<y;v+=h){s.fromArray(p,3*v),l.fromArray(p,3*v+3);var S=Xa.distanceSqToSegment(s,l,u,c);if(!(S>o)){u.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(u);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}else if(i.isGeometry)for(var A=i.vertices,C=A.length,v=0;v<C-1;v+=h){var S=Xa.distanceSqToSegment(A[v],A[v+1],u,c);if(!(S>o)){u.applyMatrix4(this.matrixWorld);var b=e.ray.origin.distanceTo(u);b<e.near||b>e.far||t.push({distance:b,point:c.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this})}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Za=new M,Ja=new M;function ft(e,t){Wt.call(this,e,t),this.type="LineSegments"}ft.prototype=Object.assign(Object.create(Wt.prototype),{constructor:ft,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var t=e.attributes.position,n=[],i=0,r=t.count;i<r;i+=2)Za.fromBufferAttribute(t,i),Ja.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Za.distanceTo(Ja);e.setAttribute("lineDistance",new K(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(var a=e.vertices,n=e.lineDistances,i=0,r=a.length;i<r;i+=2)Za.copy(a[i]),Ja.copy(a[i+1]),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+Za.distanceTo(Ja);return this}});function nl(e,t){Wt.call(this,e,t),this.type="LineLoop"}nl.prototype=Object.assign(Object.create(Wt.prototype),{constructor:nl,isLineLoop:!0});function xi(e){xe.call(this),this.type="PointsMaterial",this.color=new ee(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}xi.prototype=Object.create(xe.prototype);xi.prototype.constructor=xi;xi.prototype.isPointsMaterial=!0;xi.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var Qc=new Re,il=new xr,$a=new ei,Ka=new M;function rl(e,t){Q.call(this),this.type="Points",this.geometry=e!==void 0?e:new ne,this.material=t!==void 0?t:new xi,this.updateMorphTargets()}rl.prototype=Object.assign(Object.create(Q.prototype),{constructor:rl,isPoints:!0,raycast:function(e,t){var n=this.geometry,i=this.matrixWorld,r=e.params.Points.threshold;if(n.boundingSphere===null&&n.computeBoundingSphere(),$a.copy(n.boundingSphere),$a.applyMatrix4(i),$a.radius+=r,e.ray.intersectsSphere($a)!==!1){Qc.getInverse(i),il.copy(e.ray).applyMatrix4(Qc);var a=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=a*a;if(n.isBufferGeometry){var s=n.index,l=n.attributes,c=l.position.array;if(s!==null)for(var u=s.array,h=0,f=u.length;h<f;h++){var d=u[h];Ka.fromArray(c,d*3),Rs(Ka,d,o,i,e,t,this)}else for(var h=0,p=c.length/3;h<p;h++)Ka.fromArray(c,h*3),Rs(Ka,h,o,i,e,t,this)}else for(var m=n.vertices,h=0,p=m.length;h<p;h++)Rs(m[h],h,o,i,e,t,this)}},updateMorphTargets:function(){var e=this.geometry,t,n,i;if(e.isBufferGeometry){var r=e.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(o!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,n=o.length;t<n;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=e.morphTargets;s!==void 0&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});function Rs(e,t,n,i,r,a,o){var s=il.distanceSqToPoint(e);if(s<n){var l=new M;il.closestPointToPoint(e,l),l.applyMatrix4(i);var c=r.ray.origin.distanceTo(l);if(c<r.near||c>r.far)return;a.push({distance:c,distanceToRay:Math.sqrt(s),point:l,index:t,face:null,object:o})}}function eu(e,t,n,i,r,a,o,s,l){Je.call(this,e,t,n,i,r,a,o,s,l),this.format=o!==void 0?o:mi,this.minFilter=a!==void 0?a:gt,this.magFilter=r!==void 0?r:gt,this.generateMipmaps=!1}eu.prototype=Object.assign(Object.create(Je.prototype),{constructor:eu,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});function Yr(e,t,n,i,r,a,o,s,l,c,u,h){Je.call(this,null,a,o,s,l,c,i,r,u,h),this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}Yr.prototype=Object.create(Je.prototype);Yr.prototype.constructor=Yr;Yr.prototype.isCompressedTexture=!0;function Mo(e,t,n,i,r,a,o,s,l){Je.call(this,e,t,n,i,r,a,o,s,l),this.needsUpdate=!0}Mo.prototype=Object.create(Je.prototype);Mo.prototype.constructor=Mo;Mo.prototype.isCanvasTexture=!0;function So(e,t,n,i,r,a,o,s,l,c){if(c=c!==void 0?c:Ji,c!==Ji&&c!==zr)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&c===Ji&&(n=mo),n===void 0&&c===zr&&(n=vo),Je.call(this,null,i,r,a,o,s,c,n,l),this.image={width:e,height:t},this.magFilter=o!==void 0?o:ht,this.minFilter=s!==void 0?s:ht,this.flipY=!1,this.generateMipmaps=!1}So.prototype=Object.create(Je.prototype);So.prototype.constructor=So;So.prototype.isDepthTexture=!0;function Eo(e){ne.call(this),this.type="WireframeGeometry";var t=[],n,i,r,a,o,s=[0,0],l={},c,u,h,f,d=["a","b","c"],p;if(e&&e.isGeometry){var m=e.faces;for(n=0,r=m.length;n<r;n++){var v=m[n];for(i=0;i<3;i++)u=v[d[i]],h=v[d[(i+1)%3]],s[0]=Math.min(u,h),s[1]=Math.max(u,h),f=s[0]+","+s[1],l[f]===void 0&&(l[f]={index1:s[0],index2:s[1]})}for(f in l)c=l[f],p=e.vertices[c.index1],t.push(p.x,p.y,p.z),p=e.vertices[c.index2],t.push(p.x,p.y,p.z)}else if(e&&e.isBufferGeometry){var y,x,w,S,b,A,C,T;if(p=new M,e.index!==null){for(y=e.attributes.position,x=e.index,w=e.groups,w.length===0&&(w=[{start:0,count:x.count,materialIndex:0}]),a=0,o=w.length;a<o;++a)for(S=w[a],b=S.start,A=S.count,n=b,r=b+A;n<r;n+=3)for(i=0;i<3;i++)u=x.getX(n+i),h=x.getX(n+(i+1)%3),s[0]=Math.min(u,h),s[1]=Math.max(u,h),f=s[0]+","+s[1],l[f]===void 0&&(l[f]={index1:s[0],index2:s[1]});for(f in l)c=l[f],p.fromBufferAttribute(y,c.index1),t.push(p.x,p.y,p.z),p.fromBufferAttribute(y,c.index2),t.push(p.x,p.y,p.z)}else for(y=e.attributes.position,n=0,r=y.count/3;n<r;n++)for(i=0;i<3;i++)C=3*n+i,p.fromBufferAttribute(y,C),t.push(p.x,p.y,p.z),T=3*n+(i+1)%3,p.fromBufferAttribute(y,T),t.push(p.x,p.y,p.z)}this.setAttribute("position",new K(t,3))}Eo.prototype=Object.create(ne.prototype);Eo.prototype.constructor=Eo;function To(e,t,n){we.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n},this.fromBufferGeometry(new Zr(e,t,n)),this.mergeVertices()}To.prototype=Object.create(we.prototype);To.prototype.constructor=To;function Zr(e,t,n){ne.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:t,stacks:n};var i=[],r=[],a=[],o=[],s=1e-5,l=new M,c=new M,u=new M,h=new M,f=new M,d,p;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var m=t+1;for(d=0;d<=n;d++){var v=d/n;for(p=0;p<=t;p++){var y=p/t;e(y,v,c),r.push(c.x,c.y,c.z),y-s>=0?(e(y-s,v,u),h.subVectors(c,u)):(e(y+s,v,u),h.subVectors(u,c)),v-s>=0?(e(y,v-s,u),f.subVectors(c,u)):(e(y,v+s,u),f.subVectors(u,c)),l.crossVectors(h,f).normalize(),a.push(l.x,l.y,l.z),o.push(y,v)}}for(d=0;d<n;d++)for(p=0;p<t;p++){var x=d*m+p,w=d*m+p+1,S=(d+1)*m+p+1,b=(d+1)*m+p;i.push(x,w,b),i.push(w,S,b)}this.setIndex(i),this.setAttribute("position",new K(r,3)),this.setAttribute("normal",new K(a,3)),this.setAttribute("uv",new K(o,2))}Zr.prototype=Object.create(ne.prototype);Zr.prototype.constructor=Zr;function Ao(e,t,n,i){we.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},this.fromBufferGeometry(new kt(e,t,n,i)),this.mergeVertices()}Ao.prototype=Object.create(we.prototype);Ao.prototype.constructor=Ao;function kt(e,t,n,i){ne.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i},n=n||1,i=i||0;var r=[],a=[];o(i),l(n),c(),this.setAttribute("position",new K(r,3)),this.setAttribute("normal",new K(r.slice(),3)),this.setAttribute("uv",new K(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(y){for(var x=new M,w=new M,S=new M,b=0;b<t.length;b+=3)f(t[b+0],x),f(t[b+1],w),f(t[b+2],S),s(x,w,S,y)}function s(y,x,w,S){var b=Math.pow(2,S),A=[],C,T;for(C=0;C<=b;C++){A[C]=[];var I=y.clone().lerp(w,C/b),D=x.clone().lerp(w,C/b),B=b-C;for(T=0;T<=B;T++)T===0&&C===b?A[C][T]=I:A[C][T]=I.clone().lerp(D,T/B)}for(C=0;C<b;C++)for(T=0;T<2*(b-C)-1;T++){var O=Math.floor(T/2);T%2===0?(h(A[C][O+1]),h(A[C+1][O]),h(A[C][O])):(h(A[C][O+1]),h(A[C+1][O+1]),h(A[C+1][O]))}}function l(y){for(var x=new M,w=0;w<r.length;w+=3)x.x=r[w+0],x.y=r[w+1],x.z=r[w+2],x.normalize().multiplyScalar(y),r[w+0]=x.x,r[w+1]=x.y,r[w+2]=x.z}function c(){for(var y=new M,x=0;x<r.length;x+=3){y.x=r[x+0],y.y=r[x+1],y.z=r[x+2];var w=m(y)/2/Math.PI+.5,S=v(y)/Math.PI+.5;a.push(w,1-S)}d(),u()}function u(){for(var y=0;y<a.length;y+=6){var x=a[y+0],w=a[y+2],S=a[y+4],b=Math.max(x,w,S),A=Math.min(x,w,S);b>.9&&A<.1&&(x<.2&&(a[y+0]+=1),w<.2&&(a[y+2]+=1),S<.2&&(a[y+4]+=1))}}function h(y){r.push(y.x,y.y,y.z)}function f(y,x){var w=y*3;x.x=e[w+0],x.y=e[w+1],x.z=e[w+2]}function d(){for(var y=new M,x=new M,w=new M,S=new M,b=new U,A=new U,C=new U,T=0,I=0;T<r.length;T+=9,I+=6){y.set(r[T+0],r[T+1],r[T+2]),x.set(r[T+3],r[T+4],r[T+5]),w.set(r[T+6],r[T+7],r[T+8]),b.set(a[I+0],a[I+1]),A.set(a[I+2],a[I+3]),C.set(a[I+4],a[I+5]),S.copy(y).add(x).add(w).divideScalar(3);var D=m(S);p(b,I+0,y,D),p(A,I+2,x,D),p(C,I+4,w,D)}}function p(y,x,w,S){S<0&&y.x===1&&(a[x]=y.x-1),w.x===0&&w.z===0&&(a[x]=S/2/Math.PI+.5)}function m(y){return Math.atan2(y.z,-y.x)}function v(y){return Math.atan2(-y.y,Math.sqrt(y.x*y.x+y.z*y.z))}}kt.prototype=Object.create(ne.prototype);kt.prototype.constructor=kt;function Lo(e,t){we.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Jr(e,t)),this.mergeVertices()}Lo.prototype=Object.create(we.prototype);Lo.prototype.constructor=Lo;function Jr(e,t){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];kt.call(this,n,i,e,t),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:t}}Jr.prototype=Object.create(kt.prototype);Jr.prototype.constructor=Jr;function Co(e,t){we.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new ir(e,t)),this.mergeVertices()}Co.prototype=Object.create(we.prototype);Co.prototype.constructor=Co;function ir(e,t){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];kt.call(this,n,i,e,t),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:t}}ir.prototype=Object.create(kt.prototype);ir.prototype.constructor=ir;function Ro(e,t){we.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new $r(e,t)),this.mergeVertices()}Ro.prototype=Object.create(we.prototype);Ro.prototype.constructor=Ro;function $r(e,t){var n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],r=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];kt.call(this,i,r,e,t),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:t}}$r.prototype=Object.create(kt.prototype);$r.prototype.constructor=$r;function Po(e,t){we.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t},this.fromBufferGeometry(new Kr(e,t)),this.mergeVertices()}Po.prototype=Object.create(we.prototype);Po.prototype.constructor=Po;function Kr(e,t){var n=(1+Math.sqrt(5))/2,i=1/n,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];kt.call(this,r,a,e,t),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:t}}Kr.prototype=Object.create(kt.prototype);Kr.prototype.constructor=Kr;function Io(e,t,n,i,r,a){we.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},a!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new rr(e,t,n,i,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}Io.prototype=Object.create(we.prototype);Io.prototype.constructor=Io;function rr(e,t,n,i,r){ne.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:r},t=t||64,n=n||1,i=i||8,r=r||!1;var a=e.computeFrenetFrames(t,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o=new M,s=new M,l=new U,c=new M,u,h,f=[],d=[],p=[],m=[];v(),this.setIndex(m),this.setAttribute("position",new K(f,3)),this.setAttribute("normal",new K(d,3)),this.setAttribute("uv",new K(p,2));function v(){for(u=0;u<t;u++)y(u);y(r===!1?t:0),w(),x()}function y(S){c=e.getPointAt(S/t,c);var b=a.normals[S],A=a.binormals[S];for(h=0;h<=i;h++){var C=h/i*Math.PI*2,T=Math.sin(C),I=-Math.cos(C);s.x=I*b.x+T*A.x,s.y=I*b.y+T*A.y,s.z=I*b.z+T*A.z,s.normalize(),d.push(s.x,s.y,s.z),o.x=c.x+n*s.x,o.y=c.y+n*s.y,o.z=c.z+n*s.z,f.push(o.x,o.y,o.z)}}function x(){for(h=1;h<=t;h++)for(u=1;u<=i;u++){var S=(i+1)*(h-1)+(u-1),b=(i+1)*h+(u-1),A=(i+1)*h+u,C=(i+1)*(h-1)+u;m.push(S,b,C),m.push(b,A,C)}}function w(){for(u=0;u<=t;u++)for(h=0;h<=i;h++)l.x=u/t,l.y=h/i,p.push(l.x,l.y)}}rr.prototype=Object.create(ne.prototype);rr.prototype.constructor=rr;rr.prototype.toJSON=function(){var e=ne.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e};function Do(e,t,n,i,r,a,o){we.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},o!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Qr(e,t,n,i,r,a)),this.mergeVertices()}Do.prototype=Object.create(we.prototype);Do.prototype.constructor=Do;function Qr(e,t,n,i,r,a){ne.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:r,q:a},e=e||1,t=t||.4,n=Math.floor(n)||64,i=Math.floor(i)||8,r=r||2,a=a||3;var o=[],s=[],l=[],c=[],u,h,f=new M,d=new M,p=new M,m=new M,v=new M,y=new M,x=new M;for(u=0;u<=n;++u){var w=u/n*r*Math.PI*2;for(B(w,r,a,e,p),B(w+.01,r,a,e,m),y.subVectors(m,p),x.addVectors(m,p),v.crossVectors(y,x),x.crossVectors(v,y),v.normalize(),x.normalize(),h=0;h<=i;++h){var S=h/i*Math.PI*2,b=-t*Math.cos(S),A=t*Math.sin(S);f.x=p.x+(b*x.x+A*v.x),f.y=p.y+(b*x.y+A*v.y),f.z=p.z+(b*x.z+A*v.z),s.push(f.x,f.y,f.z),d.subVectors(f,p).normalize(),l.push(d.x,d.y,d.z),c.push(u/n),c.push(h/i)}}for(h=1;h<=n;h++)for(u=1;u<=i;u++){var C=(i+1)*(h-1)+(u-1),T=(i+1)*h+(u-1),I=(i+1)*h+u,D=(i+1)*(h-1)+u;o.push(C,T,D),o.push(T,I,D)}this.setIndex(o),this.setAttribute("position",new K(s,3)),this.setAttribute("normal",new K(l,3)),this.setAttribute("uv",new K(c,2));function B(O,F,N,k,V){var te=Math.cos(O),$=Math.sin(O),X=N/F*O,Y=Math.cos(X);V.x=k*(2+Y)*.5*te,V.y=k*(2+Y)*$*.5,V.z=k*Math.sin(X)*.5}}Qr.prototype=Object.create(ne.prototype);Qr.prototype.constructor=Qr;function Oo(e,t,n,i,r){we.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},this.fromBufferGeometry(new ea(e,t,n,i,r)),this.mergeVertices()}Oo.prototype=Object.create(we.prototype);Oo.prototype.constructor=Oo;function ea(e,t,n,i,r){ne.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:r},e=e||1,t=t||.4,n=Math.floor(n)||8,i=Math.floor(i)||6,r=r||Math.PI*2;var a=[],o=[],s=[],l=[],c=new M,u=new M,h=new M,f,d;for(f=0;f<=n;f++)for(d=0;d<=i;d++){var p=d/i*r,m=f/n*Math.PI*2;u.x=(e+t*Math.cos(m))*Math.cos(p),u.y=(e+t*Math.cos(m))*Math.sin(p),u.z=t*Math.sin(m),o.push(u.x,u.y,u.z),c.x=e*Math.cos(p),c.y=e*Math.sin(p),h.subVectors(u,c).normalize(),s.push(h.x,h.y,h.z),l.push(d/i),l.push(f/n)}for(f=1;f<=n;f++)for(d=1;d<=i;d++){var v=(i+1)*f+d-1,y=(i+1)*(f-1)+d-1,x=(i+1)*(f-1)+d,w=(i+1)*f+d;a.push(v,y,w),a.push(y,x,w)}this.setIndex(a),this.setAttribute("position",new K(o,3)),this.setAttribute("normal",new K(s,3)),this.setAttribute("uv",new K(l,2))}ea.prototype=Object.create(ne.prototype);ea.prototype.constructor=ea;var Tg={triangulate:function(e,t,n){n=n||2;var i=t&&t.length,r=i?t[0]*n:e.length,a=vh(e,0,r,n,!0),o=[];if(!a||a.next===a.prev)return o;var s,l,c,u,h,f,d;if(i&&(a=Pg(e,t,a,n)),e.length>80*n){s=c=e[0],l=u=e[1];for(var p=n;p<r;p+=n)h=e[p],f=e[p+1],h<s&&(s=h),f<l&&(l=f),h>c&&(c=h),f>u&&(u=f);d=Math.max(c-s,u-l),d=d!==0?1/d:0}return na(a,o,n,s,l,d),o}};function vh(e,t,n,i,r){var a,o;if(r===Gg(e,t,n,i)>0)for(a=t;a<n;a+=i)o=tu(a,e[a],e[a+1],o);else for(a=n-i;a>=t;a-=i)o=tu(a,e[a],e[a+1],o);return o&&di(o,o.next)&&(ra(o),o=o.next),o}function ta(e,t){if(!e)return e;t||(t=e);var n=e,i;do if(i=!1,!n.steiner&&(di(n,n.next)||_t(n.prev,n,n.next)===0)){if(ra(n),n=t=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==t);return t}function na(e,t,n,i,r,a,o){if(e){!o&&a&&Ng(e,i,r,a);for(var s=e,l,c;e.prev!==e.next;){if(l=e.prev,c=e.next,a?Lg(e,i,r,a):Ag(e)){t.push(l.i/n),t.push(e.i/n),t.push(c.i/n),ra(e),e=c.next,s=c.next;continue}if(e=c,e===s){o?o===1?(e=Cg(e,t,n),na(e,t,n,i,r,a,2)):o===2&&Rg(e,t,n,i,r,a):na(ta(e),t,n,i,r,a,1);break}}}}function Ag(e){var t=e.prev,n=e,i=e.next;if(_t(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(Zi(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&_t(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Lg(e,t,n,i){var r=e.prev,a=e,o=e.next;if(_t(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,l=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,c=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,u=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,h=al(s,l,t,n,i),f=al(c,u,t,n,i),d=e.prevZ,p=e.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==e.prev&&d!==e.next&&Zi(r.x,r.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_t(d.prev,d,d.next)>=0||(d=d.prevZ,p!==e.prev&&p!==e.next&&Zi(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&_t(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&Zi(r.x,r.y,a.x,a.y,o.x,o.y,d.x,d.y)&&_t(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&Zi(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&_t(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Cg(e,t,n){var i=e;do{var r=i.prev,a=i.next.next;!di(r,a)&&gh(r,i,i.next,a)&&ia(r,a)&&ia(a,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(a.i/n),ra(i),ra(i.next),i=e=a),i=i.next}while(i!==e);return i}function Rg(e,t,n,i,r,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&kg(o,s)){var l=yh(o,s);o=ta(o,o.next),l=ta(l,l.next),na(o,t,n,i,r,a),na(l,t,n,i,r,a);return}s=s.next}o=o.next}while(o!==e)}function Pg(e,t,n,i){var r=[],a,o,s,l,c;for(a=0,o=t.length;a<o;a++)s=t[a]*i,l=a<o-1?t[a+1]*i:e.length,c=vh(e,s,l,i,!1),c===c.next&&(c.steiner=!0),r.push(Bg(c));for(r.sort(Ig),a=0;a<r.length;a++)Dg(r[a],n),n=ta(n,n.next);return n}function Ig(e,t){return e.x-t.x}function Dg(e,t){if(t=Og(e,t),t){var n=yh(t,e);ta(n,n.next)}}function Og(e,t){var n=t,i=e.x,r=e.y,a=-1/0,o;do{if(r<=n.y&&r>=n.next.y&&n.next.y!==n.y){var s=n.x+(r-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a){if(a=s,s===i){if(r===n.y)return n;if(r===n.next.y)return n.next}o=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!o)return null;if(i===a)return o.prev;var l=o,c=o.x,u=o.y,h=1/0,f;for(n=o.next;n!==l;)i>=n.x&&n.x>=c&&i!==n.x&&Zi(r<u?i:a,r,c,u,r<u?a:i,r,n.x,n.y)&&(f=Math.abs(r-n.y)/(i-n.x),(f<h||f===h&&n.x>o.x)&&ia(n,e)&&(o=n,h=f)),n=n.next;return o}function Ng(e,t,n,i){var r=e;do r.z===null&&(r.z=al(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,Fg(r)}function Fg(e){var t,n,i,r,a,o,s,l,c=1;do{for(n=e,e=null,a=null,o=0;n;){for(o++,i=n,s=0,t=0;t<c&&(s++,i=i.nextZ,!!i);t++);for(l=c;s>0||l>0&&i;)s!==0&&(l===0||!i||n.z<=i.z)?(r=n,n=n.nextZ,s--):(r=i,i=i.nextZ,l--),a?a.nextZ=r:e=r,r.prevZ=a,a=r;n=i}a.nextZ=null,c*=2}while(o>1);return e}function al(e,t,n,i,r){return e=32767*(e-n)*r,t=32767*(t-i)*r,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Bg(e){var t=e,n=e;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==e);return n}function Zi(e,t,n,i,r,a,o,s){return(r-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(i-s)-(n-o)*(t-s)>=0&&(n-o)*(a-s)-(r-o)*(i-s)>=0}function kg(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!zg(e,t)&&ia(e,t)&&ia(t,e)&&Ug(e,t)}function _t(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function di(e,t){return e.x===t.x&&e.y===t.y}function gh(e,t,n,i){return di(e,n)&&di(t,i)||di(e,i)&&di(n,t)?!0:_t(e,t,n)>0!=_t(e,t,i)>0&&_t(n,i,e)>0!=_t(n,i,t)>0}function zg(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&gh(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}function ia(e,t){return _t(e.prev,e,e.next)<0?_t(e,t,e.next)>=0&&_t(e,e.prev,t)>=0:_t(e,t,e.prev)<0||_t(e,e.next,t)<0}function Ug(e,t){var n=e,i=!1,r=(e.x+t.x)/2,a=(e.y+t.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&r<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==e);return i}function yh(e,t){var n=new ol(e.i,e.x,e.y),i=new ol(t.i,t.x,t.y),r=e.next,a=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function tu(e,t,n,i){var r=new ol(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function ra(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function ol(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Gg(e,t,n,i){for(var r=0,a=t,o=n-i;a<n;a+=i)r+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return r}var jn={area:function(e){for(var t=e.length,n=0,i=t-1,r=0;r<t;i=r++)n+=e[i].x*e[r].y-e[r].x*e[i].y;return n*.5},isClockWise:function(e){return jn.area(e)<0},triangulateShape:function(e,t){var n=[],i=[],r=[];nu(e),iu(n,e);var a=e.length;t.forEach(nu);for(var o=0;o<t.length;o++)i.push(a),a+=t[o].length,iu(n,t[o]);for(var s=Tg.triangulate(n,i),o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function nu(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function iu(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}function ar(e,t){we.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},this.fromBufferGeometry(new An(e,t)),this.mergeVertices()}ar.prototype=Object.create(we.prototype);ar.prototype.constructor=ar;ar.prototype.toJSON=function(){var e=we.prototype.toJSON.call(this),t=this.parameters.shapes,n=this.parameters.options;return xh(t,n,e)};function An(e,t){ne.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];for(var n=this,i=[],r=[],a=0,o=e.length;a<o;a++){var s=e[a];l(s)}this.setAttribute("position",new K(i,3)),this.setAttribute("uv",new K(r,2)),this.computeVertexNormals();function l(c){var u=[],h=t.curveSegments!==void 0?t.curveSegments:12,f=t.steps!==void 0?t.steps:1,d=t.depth!==void 0?t.depth:100,p=t.bevelEnabled!==void 0?t.bevelEnabled:!0,m=t.bevelThickness!==void 0?t.bevelThickness:6,v=t.bevelSize!==void 0?t.bevelSize:m-2,y=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3,w=t.extrudePath,S=t.UVGenerator!==void 0?t.UVGenerator:Vg;t.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=t.amount);var b,A=!1,C,T,I,D;w&&(b=w.getSpacedPoints(f),A=!0,p=!1,C=w.computeFrenetFrames(f,!1),T=new M,I=new M,D=new M),p||(x=0,m=0,v=0,y=0);var B,O,F,N=c.extractPoints(h),k=N.shape,V=N.holes,te=!jn.isClockWise(k);if(te)for(k=k.reverse(),O=0,F=V.length;O<F;O++)B=V[O],jn.isClockWise(B)&&(V[O]=B.reverse());var $=jn.triangulateShape(k,V),X=k;for(O=0,F=V.length;O<F;O++)B=V[O],k=k.concat(B);function Y(re,he,se){return he||console.error("THREE.ExtrudeGeometry: vec does not exist"),he.clone().multiplyScalar(se).add(re)}var ie,Ue,ze,Be,Me,G=k.length,He,be=$.length;function ke(re,he,se){var R,q,oe,Se=re.x-he.x,ae=re.y-he.y,Ne=se.x-re.x,$e=se.y-re.y,nt=Se*Se+ae*ae,Xt=Se*$e-ae*Ne;if(Math.abs(Xt)>Number.EPSILON){var qe=Math.sqrt(nt),It=Math.sqrt(Ne*Ne+$e*$e),St=he.x-ae/qe,bi=he.y+Se/qe,Yt=se.x-$e/It,Ea=se.y+Ne/It,Gt=((Yt-St)*$e-(Ea-bi)*Ne)/(Se*$e-ae*Ne);R=St+Se*Gt-re.x,q=bi+ae*Gt-re.y;var Ta=R*R+q*q;if(Ta<=2)return new U(R,q);oe=Math.sqrt(Ta/2)}else{var Mi=!1;Se>Number.EPSILON?Ne>Number.EPSILON&&(Mi=!0):Se<-Number.EPSILON?Ne<-Number.EPSILON&&(Mi=!0):Math.sign(ae)===Math.sign($e)&&(Mi=!0),Mi?(R=-ae,q=Se,oe=Math.sqrt(nt)):(R=Se,q=ae,oe=Math.sqrt(nt/2))}return new U(R/oe,q/oe)}for(var de=[],W=0,Ce=X.length,Ge=Ce-1,tt=W+1;W<Ce;W++,Ge++,tt++)Ge===Ce&&(Ge=0),tt===Ce&&(tt=0),de[W]=ke(X[W],X[Ge],X[tt]);var qt=[],rt,E=de.concat();for(O=0,F=V.length;O<F;O++){for(B=V[O],rt=[],W=0,Ce=B.length,Ge=Ce-1,tt=W+1;W<Ce;W++,Ge++,tt++)Ge===Ce&&(Ge=0),tt===Ce&&(tt=0),rt[W]=ke(B[W],B[Ge],B[tt]);qt.push(rt),E=E.concat(rt)}for(ie=0;ie<x;ie++){for(ze=ie/x,Be=m*Math.cos(ze*Math.PI/2),Ue=v*Math.sin(ze*Math.PI/2)+y,W=0,Ce=X.length;W<Ce;W++)Me=Y(X[W],de[W],Ue),pe(Me.x,Me.y,-Be);for(O=0,F=V.length;O<F;O++)for(B=V[O],rt=qt[O],W=0,Ce=B.length;W<Ce;W++)Me=Y(B[W],rt[W],Ue),pe(Me.x,Me.y,-Be)}for(Ue=v+y,W=0;W<G;W++)Me=p?Y(k[W],E[W],Ue):k[W],A?(I.copy(C.normals[0]).multiplyScalar(Me.x),T.copy(C.binormals[0]).multiplyScalar(Me.y),D.copy(b[0]).add(I).add(T),pe(D.x,D.y,D.z)):pe(Me.x,Me.y,0);var L;for(L=1;L<=f;L++)for(W=0;W<G;W++)Me=p?Y(k[W],E[W],Ue):k[W],A?(I.copy(C.normals[L]).multiplyScalar(Me.x),T.copy(C.binormals[L]).multiplyScalar(Me.y),D.copy(b[L]).add(I).add(T),pe(D.x,D.y,D.z)):pe(Me.x,Me.y,d/f*L);for(ie=x-1;ie>=0;ie--){for(ze=ie/x,Be=m*Math.cos(ze*Math.PI/2),Ue=v*Math.sin(ze*Math.PI/2)+y,W=0,Ce=X.length;W<Ce;W++)Me=Y(X[W],de[W],Ue),pe(Me.x,Me.y,d+Be);for(O=0,F=V.length;O<F;O++)for(B=V[O],rt=qt[O],W=0,Ce=B.length;W<Ce;W++)Me=Y(B[W],rt[W],Ue),A?pe(Me.x,Me.y+b[f-1].y,b[f-1].x+Be):pe(Me.x,Me.y,d+Be)}Z(),H();function Z(){var re=i.length/3;if(p){var he=0,se=G*he;for(W=0;W<be;W++)He=$[W],ce(He[2]+se,He[1]+se,He[0]+se);for(he=f+x*2,se=G*he,W=0;W<be;W++)He=$[W],ce(He[0]+se,He[1]+se,He[2]+se)}else{for(W=0;W<be;W++)He=$[W],ce(He[2],He[1],He[0]);for(W=0;W<be;W++)He=$[W],ce(He[0]+G*f,He[1]+G*f,He[2]+G*f)}n.addGroup(re,i.length/3-re,0)}function H(){var re=i.length/3,he=0;for(Ie(X,he),he+=X.length,O=0,F=V.length;O<F;O++)B=V[O],Ie(B,he),he+=B.length;n.addGroup(re,i.length/3-re,1)}function Ie(re,he){var se,R;for(W=re.length;--W>=0;){se=W,R=W-1,R<0&&(R=re.length-1);var q=0,oe=f+x*2;for(q=0;q<oe;q++){var Se=G*q,ae=G*(q+1),Ne=he+se+Se,$e=he+R+Se,nt=he+R+ae,Xt=he+se+ae;ge(Ne,$e,nt,Xt)}}}function pe(re,he,se){u.push(re),u.push(he),u.push(se)}function ce(re,he,se){De(re),De(he),De(se);var R=i.length/3,q=S.generateTopUV(n,i,R-3,R-2,R-1);me(q[0]),me(q[1]),me(q[2])}function ge(re,he,se,R){De(re),De(he),De(R),De(he),De(se),De(R);var q=i.length/3,oe=S.generateSideWallUV(n,i,q-6,q-3,q-2,q-1);me(oe[0]),me(oe[1]),me(oe[3]),me(oe[1]),me(oe[2]),me(oe[3])}function De(re){i.push(u[re*3+0]),i.push(u[re*3+1]),i.push(u[re*3+2])}function me(re){r.push(re.x),r.push(re.y)}}}An.prototype=Object.create(ne.prototype);An.prototype.constructor=An;An.prototype.toJSON=function(){var e=ne.prototype.toJSON.call(this),t=this.parameters.shapes,n=this.parameters.options;return xh(t,n,e)};var Vg={generateTopUV:function(e,t,n,i,r){var a=t[n*3],o=t[n*3+1],s=t[i*3],l=t[i*3+1],c=t[r*3],u=t[r*3+1];return[new U(a,o),new U(s,l),new U(c,u)]},generateSideWallUV:function(e,t,n,i,r,a){var o=t[n*3],s=t[n*3+1],l=t[n*3+2],c=t[i*3],u=t[i*3+1],h=t[i*3+2],f=t[r*3],d=t[r*3+1],p=t[r*3+2],m=t[a*3],v=t[a*3+1],y=t[a*3+2];return Math.abs(s-u)<.01?[new U(o,1-l),new U(c,1-h),new U(f,1-p),new U(m,1-y)]:[new U(s,1-l),new U(u,1-h),new U(d,1-p),new U(v,1-y)]}};function xh(e,t,n){if(n.shapes=[],Array.isArray(e))for(var i=0,r=e.length;i<r;i++){var a=e[i];n.shapes.push(a.uuid)}else n.shapes.push(e.uuid);return t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON()),n}function No(e,t){we.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:t},this.fromBufferGeometry(new aa(e,t)),this.mergeVertices()}No.prototype=Object.create(we.prototype);No.prototype.constructor=No;function aa(e,t){t=t||{};var n=t.font;if(!(n&&n.isFont))return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new we;var i=n.generateShapes(e,t.size);t.depth=t.height!==void 0?t.height:50,t.bevelThickness===void 0&&(t.bevelThickness=10),t.bevelSize===void 0&&(t.bevelSize=8),t.bevelEnabled===void 0&&(t.bevelEnabled=!1),An.call(this,i,t),this.type="TextBufferGeometry"}aa.prototype=Object.create(An.prototype);aa.prototype.constructor=aa;function Fo(e,t,n,i,r,a,o){we.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new or(e,t,n,i,r,a,o)),this.mergeVertices()}Fo.prototype=Object.create(we.prototype);Fo.prototype.constructor=Fo;function or(e,t,n,i,r,a,o){ne.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:r,thetaStart:a,thetaLength:o},e=e||1,t=Math.max(3,Math.floor(t)||8),n=Math.max(2,Math.floor(n)||6),i=i!==void 0?i:0,r=r!==void 0?r:Math.PI*2,a=a!==void 0?a:0,o=o!==void 0?o:Math.PI;var s=Math.min(a+o,Math.PI),l,c,u=0,h=[],f=new M,d=new M,p=[],m=[],v=[],y=[];for(c=0;c<=n;c++){var x=[],w=c/n,S=0;for(c==0&&a==0?S=.5/t:c==n&&s==Math.PI&&(S=-.5/t),l=0;l<=t;l++){var b=l/t;f.x=-e*Math.cos(i+b*r)*Math.sin(a+w*o),f.y=e*Math.cos(a+w*o),f.z=e*Math.sin(i+b*r)*Math.sin(a+w*o),m.push(f.x,f.y,f.z),d.copy(f).normalize(),v.push(d.x,d.y,d.z),y.push(b+S,1-w),x.push(u++)}h.push(x)}for(c=0;c<n;c++)for(l=0;l<t;l++){var A=h[c][l+1],C=h[c][l],T=h[c+1][l],I=h[c+1][l+1];(c!==0||a>0)&&p.push(A,C,I),(c!==n-1||s<Math.PI)&&p.push(C,T,I)}this.setIndex(p),this.setAttribute("position",new K(m,3)),this.setAttribute("normal",new K(v,3)),this.setAttribute("uv",new K(y,2))}or.prototype=Object.create(ne.prototype);or.prototype.constructor=or;function Bo(e,t,n,i,r,a){we.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new oa(e,t,n,i,r,a)),this.mergeVertices()}Bo.prototype=Object.create(we.prototype);Bo.prototype.constructor=Bo;function oa(e,t,n,i,r,a){ne.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:r,thetaLength:a},e=e||.5,t=t||1,r=r!==void 0?r:0,a=a!==void 0?a:Math.PI*2,n=n!==void 0?Math.max(3,n):8,i=i!==void 0?Math.max(1,i):1;var o=[],s=[],l=[],c=[],u,h=e,f=(t-e)/i,d=new M,p=new U,m,v;for(m=0;m<=i;m++){for(v=0;v<=n;v++)u=r+v/n*a,d.x=h*Math.cos(u),d.y=h*Math.sin(u),s.push(d.x,d.y,d.z),l.push(0,0,1),p.x=(d.x/t+1)/2,p.y=(d.y/t+1)/2,c.push(p.x,p.y);h+=f}for(m=0;m<i;m++){var y=m*(n+1);for(v=0;v<n;v++){u=v+y;var x=u,w=u+n+1,S=u+n+2,b=u+1;o.push(x,w,b),o.push(w,S,b)}}this.setIndex(o),this.setAttribute("position",new K(s,3)),this.setAttribute("normal",new K(l,3)),this.setAttribute("uv",new K(c,2))}oa.prototype=Object.create(ne.prototype);oa.prototype.constructor=oa;function ko(e,t,n,i){we.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},this.fromBufferGeometry(new sa(e,t,n,i)),this.mergeVertices()}ko.prototype=Object.create(we.prototype);ko.prototype.constructor=ko;function sa(e,t,n,i){ne.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t)||12,n=n||0,i=i||Math.PI*2,i=Le.clamp(i,0,Math.PI*2);var r=[],a=[],o=[],s,l=1/t,c=new M,u=new U,h,f;for(h=0;h<=t;h++){var d=n+h*l*i,p=Math.sin(d),m=Math.cos(d);for(f=0;f<=e.length-1;f++)c.x=e[f].x*p,c.y=e[f].y,c.z=e[f].x*m,a.push(c.x,c.y,c.z),u.x=h/t,u.y=f/(e.length-1),o.push(u.x,u.y)}for(h=0;h<t;h++)for(f=0;f<e.length-1;f++){s=f+h*e.length;var v=s,y=s+e.length,x=s+e.length+1,w=s+1;r.push(v,y,w),r.push(y,x,w)}if(this.setIndex(r),this.setAttribute("position",new K(a,3)),this.setAttribute("uv",new K(o,2)),this.computeVertexNormals(),i===Math.PI*2){var S=this.attributes.normal.array,b=new M,A=new M,C=new M;for(s=t*e.length*3,h=0,f=0;h<e.length;h++,f+=3)b.x=S[f+0],b.y=S[f+1],b.z=S[f+2],A.x=S[s+f+0],A.y=S[s+f+1],A.z=S[s+f+2],C.addVectors(b,A).normalize(),S[f+0]=S[s+f+0]=C.x,S[f+1]=S[s+f+1]=C.y,S[f+2]=S[s+f+2]=C.z}}sa.prototype=Object.create(ne.prototype);sa.prototype.constructor=sa;function sr(e,t){we.call(this),this.type="ShapeGeometry",typeof t=="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),t=t.curveSegments),this.parameters={shapes:e,curveSegments:t},this.fromBufferGeometry(new lr(e,t)),this.mergeVertices()}sr.prototype=Object.create(we.prototype);sr.prototype.constructor=sr;sr.prototype.toJSON=function(){var e=we.prototype.toJSON.call(this),t=this.parameters.shapes;return _h(t,e)};function lr(e,t){ne.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:t},t=t||12;var n=[],i=[],r=[],a=[],o=0,s=0;if(Array.isArray(e)===!1)c(e);else for(var l=0;l<e.length;l++)c(e[l]),this.addGroup(o,s,l),o+=s,s=0;this.setIndex(n),this.setAttribute("position",new K(i,3)),this.setAttribute("normal",new K(r,3)),this.setAttribute("uv",new K(a,2));function c(u){var h,f,d,p=i.length/3,m=u.extractPoints(t),v=m.shape,y=m.holes;for(jn.isClockWise(v)===!1&&(v=v.reverse()),h=0,f=y.length;h<f;h++)d=y[h],jn.isClockWise(d)===!0&&(y[h]=d.reverse());var x=jn.triangulateShape(v,y);for(h=0,f=y.length;h<f;h++)d=y[h],v=v.concat(d);for(h=0,f=v.length;h<f;h++){var w=v[h];i.push(w.x,w.y,0),r.push(0,0,1),a.push(w.x,w.y)}for(h=0,f=x.length;h<f;h++){var S=x[h],b=S[0]+p,A=S[1]+p,C=S[2]+p;n.push(b,A,C),s+=3}}}lr.prototype=Object.create(ne.prototype);lr.prototype.constructor=lr;lr.prototype.toJSON=function(){var e=ne.prototype.toJSON.call(this),t=this.parameters.shapes;return _h(t,e)};function _h(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,i=e.length;n<i;n++){var r=e[n];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}function zo(e,t){ne.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:t},t=t!==void 0?t:1;var n=[],i=Math.cos(Le.DEG2RAD*t),r=[0,0],a={},o,s,l,c=["a","b","c"],u;e.isBufferGeometry?(u=new we,u.fromBufferGeometry(e)):u=e.clone(),u.mergeVertices(),u.computeFaceNormals();for(var h=u.vertices,f=u.faces,d=0,p=f.length;d<p;d++)for(var m=f[d],v=0;v<3;v++)o=m[c[v]],s=m[c[(v+1)%3]],r[0]=Math.min(o,s),r[1]=Math.max(o,s),l=r[0]+","+r[1],a[l]===void 0?a[l]={index1:r[0],index2:r[1],face1:d,face2:void 0}:a[l].face2=d;for(l in a){var y=a[l];if(y.face2===void 0||f[y.face1].normal.dot(f[y.face2].normal)<=i){var x=h[y.index1];n.push(x.x,x.y,x.z),x=h[y.index2],n.push(x.x,x.y,x.z)}}this.setAttribute("position",new K(n,3))}zo.prototype=Object.create(ne.prototype);zo.prototype.constructor=zo;function cr(e,t,n,i,r,a,o,s){we.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new Jn(e,t,n,i,r,a,o,s)),this.mergeVertices()}cr.prototype=Object.create(we.prototype);cr.prototype.constructor=cr;function Jn(e,t,n,i,r,a,o,s){ne.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var l=this;e=e!==void 0?e:1,t=t!==void 0?t:1,n=n||1,i=Math.floor(i)||8,r=Math.floor(r)||1,a=a!==void 0?a:!1,o=o!==void 0?o:0,s=s!==void 0?s:Math.PI*2;var c=[],u=[],h=[],f=[],d=0,p=[],m=n/2,v=0;y(),a===!1&&(e>0&&x(!0),t>0&&x(!1)),this.setIndex(c),this.setAttribute("position",new K(u,3)),this.setAttribute("normal",new K(h,3)),this.setAttribute("uv",new K(f,2));function y(){var w,S,b=new M,A=new M,C=0,T=(t-e)/n;for(S=0;S<=r;S++){var I=[],D=S/r,B=D*(t-e)+e;for(w=0;w<=i;w++){var O=w/i,F=O*s+o,N=Math.sin(F),k=Math.cos(F);A.x=B*N,A.y=-D*n+m,A.z=B*k,u.push(A.x,A.y,A.z),b.set(N,T,k).normalize(),h.push(b.x,b.y,b.z),f.push(O,1-D),I.push(d++)}p.push(I)}for(w=0;w<i;w++)for(S=0;S<r;S++){var V=p[S][w],te=p[S+1][w],$=p[S+1][w+1],X=p[S][w+1];c.push(V,te,X),c.push(te,$,X),C+=6}l.addGroup(v,C,0),v+=C}function x(w){var S,b,A,C=new U,T=new M,I=0,D=w===!0?e:t,B=w===!0?1:-1;for(b=d,S=1;S<=i;S++)u.push(0,m*B,0),h.push(0,B,0),f.push(.5,.5),d++;for(A=d,S=0;S<=i;S++){var O=S/i,F=O*s+o,N=Math.cos(F),k=Math.sin(F);T.x=D*k,T.y=m*B,T.z=D*N,u.push(T.x,T.y,T.z),h.push(0,B,0),C.x=N*.5+.5,C.y=k*.5*B+.5,f.push(C.x,C.y),d++}for(S=0;S<i;S++){var V=b+S,te=A+S;w===!0?c.push(te,te+1,V):c.push(te+1,te,V),I+=3}l.addGroup(v,I,w===!0?1:2),v+=I}}Jn.prototype=Object.create(ne.prototype);Jn.prototype.constructor=Jn;function Uo(e,t,n,i,r,a,o){cr.call(this,0,e,t,n,i,r,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}Uo.prototype=Object.create(cr.prototype);Uo.prototype.constructor=Uo;function Go(e,t,n,i,r,a,o){Jn.call(this,0,e,t,n,i,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:r,thetaStart:a,thetaLength:o}}Go.prototype=Object.create(Jn.prototype);Go.prototype.constructor=Go;function Vo(e,t,n,i){we.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},this.fromBufferGeometry(new la(e,t,n,i)),this.mergeVertices()}Vo.prototype=Object.create(we.prototype);Vo.prototype.constructor=Vo;function la(e,t,n,i){ne.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},e=e||1,t=t!==void 0?Math.max(3,t):8,n=n!==void 0?n:0,i=i!==void 0?i:Math.PI*2;var r=[],a=[],o=[],s=[],l,c,u=new M,h=new U;for(a.push(0,0,0),o.push(0,0,1),s.push(.5,.5),c=0,l=3;c<=t;c++,l+=3){var f=n+c/t*i;u.x=e*Math.cos(f),u.y=e*Math.sin(f),a.push(u.x,u.y,u.z),o.push(0,0,1),h.x=(a[l]/e+1)/2,h.y=(a[l+1]/e+1)/2,s.push(h.x,h.y)}for(l=1;l<=t;l++)r.push(l,l+1,0);this.setIndex(r),this.setAttribute("position",new K(a,3)),this.setAttribute("normal",new K(o,3)),this.setAttribute("uv",new K(s,2))}la.prototype=Object.create(ne.prototype);la.prototype.constructor=la;var Tt=Object.freeze({__proto__:null,WireframeGeometry:Eo,ParametricGeometry:To,ParametricBufferGeometry:Zr,TetrahedronGeometry:Lo,TetrahedronBufferGeometry:Jr,OctahedronGeometry:Co,OctahedronBufferGeometry:ir,IcosahedronGeometry:Ro,IcosahedronBufferGeometry:$r,DodecahedronGeometry:Po,DodecahedronBufferGeometry:Kr,PolyhedronGeometry:Ao,PolyhedronBufferGeometry:kt,TubeGeometry:Io,TubeBufferGeometry:rr,TorusKnotGeometry:Do,TorusKnotBufferGeometry:Qr,TorusGeometry:Oo,TorusBufferGeometry:ea,TextGeometry:No,TextBufferGeometry:aa,SphereGeometry:Fo,SphereBufferGeometry:or,RingGeometry:Bo,RingBufferGeometry:oa,PlaneGeometry:Wr,PlaneBufferGeometry:nr,LatheGeometry:ko,LatheBufferGeometry:sa,ShapeGeometry:sr,ShapeBufferGeometry:lr,ExtrudeGeometry:ar,ExtrudeBufferGeometry:An,EdgesGeometry:zo,ConeGeometry:Uo,ConeBufferGeometry:Go,CylinderGeometry:cr,CylinderBufferGeometry:Jn,CircleGeometry:Vo,CircleBufferGeometry:la,BoxGeometry:ah,BoxBufferGeometry:rs});function ur(e){xe.call(this),this.type="ShadowMaterial",this.color=new ee(0),this.transparent=!0,this.setValues(e)}ur.prototype=Object.create(xe.prototype);ur.prototype.constructor=ur;ur.prototype.isShadowMaterial=!0;ur.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this};function $n(e){Rt.call(this,e),this.type="RawShaderMaterial"}$n.prototype=Object.create(Rt.prototype);$n.prototype.constructor=$n;$n.prototype.isRawShaderMaterial=!0;function Ln(e){xe.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new ee(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ee(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gr,this.normalScale=new U(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Ln.prototype=Object.create(xe.prototype);Ln.prototype.constructor=Ln;Ln.prototype.isMeshStandardMaterial=!0;Ln.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function hr(e){Ln.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new U(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(e)}hr.prototype=Object.create(Ln.prototype);hr.prototype.constructor=hr;hr.prototype.isMeshPhysicalMaterial=!0;hr.prototype.copy=function(e){return Ln.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=e.reflectivity,this.clearcoat=e.clearcoat,this.clearcoatRoughness=e.clearcoatRoughness,e.sheen?this.sheen=(this.sheen||new ee).copy(e.sheen):this.sheen=null,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.transparency=e.transparency,this};function _i(e){xe.call(this),this.type="MeshPhongMaterial",this.color=new ee(16777215),this.specular=new ee(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ee(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gr,this.normalScale=new U(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=es,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}_i.prototype=Object.create(xe.prototype);_i.prototype.constructor=_i;_i.prototype.isMeshPhongMaterial=!0;_i.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function fr(e){xe.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new ee(16777215),this.specular=new ee(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ee(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gr,this.normalScale=new U(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}fr.prototype=Object.create(xe.prototype);fr.prototype.constructor=fr;fr.prototype.isMeshToonMaterial=!0;fr.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function dr(e){xe.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gr,this.normalScale=new U(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}dr.prototype=Object.create(xe.prototype);dr.prototype.constructor=dr;dr.prototype.isMeshNormalMaterial=!0;dr.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function Kn(e){xe.call(this),this.type="MeshLambertMaterial",this.color=new ee(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new ee(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=es,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}Kn.prototype=Object.create(xe.prototype);Kn.prototype.constructor=Kn;Kn.prototype.isMeshLambertMaterial=!0;Kn.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function pr(e){xe.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new ee(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=gr,this.normalScale=new U(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(e)}pr.prototype=Object.create(xe.prototype);pr.prototype.constructor=pr;pr.prototype.isMeshMatcapMaterial=!0;pr.prototype.copy=function(e){return xe.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this};function mr(e){lt.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}mr.prototype=Object.create(lt.prototype);mr.prototype.constructor=mr;mr.prototype.isLineDashedMaterial=!0;mr.prototype.copy=function(e){return lt.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var Hg=Object.freeze({__proto__:null,ShadowMaterial:ur,SpriteMaterial:yi,RawShaderMaterial:$n,ShaderMaterial:Rt,PointsMaterial:xi,MeshPhysicalMaterial:hr,MeshStandardMaterial:Ln,MeshPhongMaterial:_i,MeshToonMaterial:fr,MeshNormalMaterial:dr,MeshLambertMaterial:Kn,MeshDepthMaterial:vi,MeshDistanceMaterial:gi,MeshBasicMaterial:tn,MeshMatcapMaterial:pr,LineDashedMaterial:mr,LineBasicMaterial:lt,Material:xe}),ot={arraySlice:function(e,t,n){return ot.isTypedArray(e)?new e.constructor(e.subarray(t,n!==void 0?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:typeof t.BYTES_PER_ELEMENT=="number"?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){function t(a,o){return e[a]-e[o]}for(var n=e.length,i=new Array(n),r=0;r!==n;++r)i[r]=r;return i.sort(t),i},sortedArray:function(e,t,n){for(var i=e.length,r=new e.constructor(i),a=0,o=0;o!==i;++a)for(var s=n[a]*t,l=0;l!==t;++l)r[o++]=e[s+l];return r},flattenJSON:function(e,t,n,i){for(var r=1,a=e[0];a!==void 0&&a[i]===void 0;)a=e[r++];if(a!==void 0){var o=a[i];if(o!==void 0)if(Array.isArray(o))do o=a[i],o!==void 0&&(t.push(a.time),n.push.apply(n,o)),a=e[r++];while(a!==void 0);else if(o.toArray!==void 0)do o=a[i],o!==void 0&&(t.push(a.time),o.toArray(n,n.length)),a=e[r++];while(a!==void 0);else do o=a[i],o!==void 0&&(t.push(a.time),n.push(o)),a=e[r++];while(a!==void 0)}},subclip:function(e,t,n,i,r){r=r||30;var a=e.clone();a.name=t;for(var o=[],s=0;s<a.tracks.length;++s){for(var l=a.tracks[s],c=l.getValueSize(),u=[],h=[],f=0;f<l.times.length;++f){var d=l.times[f]*r;if(!(d<n||d>=i)){u.push(l.times[f]);for(var p=0;p<c;++p)h.push(l.values[f*c+p])}}u.length!==0&&(l.times=ot.convertArray(u,l.times.constructor),l.values=ot.convertArray(h,l.values.constructor),o.push(l))}a.tracks=o;for(var m=1/0,s=0;s<a.tracks.length;++s)m>a.tracks[s].times[0]&&(m=a.tracks[s].times[0]);for(var s=0;s<a.tracks.length;++s)a.tracks[s].shift(-1*m);return a.resetDuration(),a}};function Vt(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n}Object.assign(Vt.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,i=t[n],r=t[n-1];e:{t:{var a;n:{i:if(!(e<i)){for(var o=n+2;;){if(i===void 0){if(e<r)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,r)}if(n===o)break;if(r=i,i=t[++n],e<i)break t}a=t.length;break n}if(!(e>=r)){var s=t[1];e<s&&(n=2,r=s);for(var o=n-2;;){if(r===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(n===o)break;if(i=r,r=t[--n-1],e>=r)break t}a=n,n=0;break n}break e}for(;n<a;){var l=n+a>>>1;e<t[l]?a=l:n=l+1}if(i=t[n],r=t[n-1],r===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,i);if(i===void 0)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,r,e)}this._cachedIndex=n,this.intervalChanged_(n,r,i)}return this.interpolate_(n,r,e,i)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,r=e*i,a=0;a!==i;++a)t[a]=n[r+a];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Vt.prototype,{beforeStart_:Vt.prototype.copySampleValue_,afterEnd_:Vt.prototype.copySampleValue_});function sl(e,t,n,i){Vt.call(this,e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}sl.prototype=Object.assign(Object.create(Vt.prototype),{constructor:sl,DefaultSettings_:{endingStart:Ki,endingEnd:Ki},intervalChanged_:function(e,t,n){var i=this.parameterPositions,r=e-2,a=e+1,o=i[r],s=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case ji:r=e,o=2*t-n;break;case yo:r=i.length-2,o=t+i[r]-i[r+1];break;default:r=e,o=n}if(s===void 0)switch(this.getSettings_().endingEnd){case ji:a=e,s=2*n-t;break;case yo:a=1,s=n+i[1]-i[0];break;default:a=e-1,s=t}var l=(n-t)*.5,c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=r*c,this._offsetNext=a*c},interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-t)/(i-t),p=d*d,m=p*d,v=-h*m+2*h*p-h*d,y=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*d+1,x=(-1-f)*m+(1.5+f)*p+.5*d,w=f*m-f*p,S=0;S!==o;++S)r[S]=v*a[c+S]+y*a[l+S]+x*a[s+S]+w*a[u+S];return r}});function Ho(e,t,n,i){Vt.call(this,e,t,n,i)}Ho.prototype=Object.assign(Object.create(Vt.prototype),{constructor:Ho,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(i-t),u=1-c,h=0;h!==o;++h)r[h]=a[l+h]*u+a[s+h]*c;return r}});function ll(e,t,n,i){Vt.call(this,e,t,n,i)}ll.prototype=Object.assign(Object.create(Vt.prototype),{constructor:ll,interpolate_:function(e){return this.copySampleValue_(e-1)}});function Mt(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ot.convertArray(t,this.TimeBufferType),this.values=ot.convertArray(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}Object.assign(Mt,{toJSON:function(e){var t=e.constructor,n;if(t.toJSON!==void 0)n=t.toJSON(e);else{n={name:e.name,times:ot.convertArray(e.times,Array),values:ot.convertArray(e.values,Array)};var i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}});Object.assign(Mt.prototype,{constructor:Mt,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:co,InterpolantFactoryMethodDiscrete:function(e){return new ll(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Ho(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new sl(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var t;switch(e){case go:t=this.InterpolantFactoryMethodDiscrete;break;case co:t=this.InterpolantFactoryMethodLinear;break;case ss:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return go;case this.InterpolantFactoryMethodLinear:return co;case this.InterpolantFactoryMethodSmooth:return ss}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]+=e;return this},scale:function(e){if(e!==1)for(var t=this.times,n=0,i=t.length;n!==i;++n)t[n]*=e;return this},trim:function(e,t){for(var n=this.times,i=n.length,r=0,a=i-1;r!==i&&n[r]<e;)++r;for(;a!==-1&&n[a]>t;)--a;if(++a,r!==0||a!==i){r>=a&&(a=Math.max(a,1),r=a-1);var o=this.getValueSize();this.times=ot.arraySlice(n,r,a),this.values=ot.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,i=this.values,r=n.length;r===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var a=null,o=0;o!==r;o++){var s=n[o];if(typeof s=="number"&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(a!==null&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),e=!1;break}a=s}if(i!==void 0&&ot.isTypedArray(i))for(var o=0,l=i.length;o!==l;++o){var c=i[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e},optimize:function(){for(var e=ot.arraySlice(this.times),t=ot.arraySlice(this.values),n=this.getValueSize(),i=this.getInterpolation()===ss,r=1,a=e.length-1,o=1;o<a;++o){var s=!1,l=e[o],c=e[o+1];if(l!==c&&(o!==1||l!==l[0]))if(i)s=!0;else for(var u=o*n,h=u-n,f=u+n,d=0;d!==n;++d){var p=t[u+d];if(p!==t[h+d]||p!==t[f+d]){s=!0;break}}if(s){if(o!==r){e[r]=e[o];for(var m=o*n,v=r*n,d=0;d!==n;++d)t[v+d]=t[m+d]}++r}}if(a>0){e[r]=e[a];for(var m=a*n,v=r*n,d=0;d!==n;++d)t[v+d]=t[m+d];++r}return r!==e.length?(this.times=ot.arraySlice(e,0,r),this.values=ot.arraySlice(t,0,r*n)):(this.times=e,this.values=t),this},clone:function(){var e=ot.arraySlice(this.times,0),t=ot.arraySlice(this.values,0),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}});function cl(e,t,n){Mt.call(this,e,t,n)}cl.prototype=Object.assign(Object.create(Mt.prototype),{constructor:cl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:go,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function ul(e,t,n,i){Mt.call(this,e,t,n,i)}ul.prototype=Object.assign(Object.create(Mt.prototype),{constructor:ul,ValueTypeName:"color"});function ca(e,t,n,i){Mt.call(this,e,t,n,i)}ca.prototype=Object.assign(Object.create(Mt.prototype),{constructor:ca,ValueTypeName:"number"});function hl(e,t,n,i){Vt.call(this,e,t,n,i)}hl.prototype=Object.assign(Object.create(Vt.prototype),{constructor:hl,interpolate_:function(e,t,n,i){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=e*o,l=(n-t)/(i-t),c=s+o;s!==c;s+=4)Pt.slerpFlat(r,0,a,s-o,a,s,l);return r}});function Wo(e,t,n,i){Mt.call(this,e,t,n,i)}Wo.prototype=Object.assign(Object.create(Mt.prototype),{constructor:Wo,ValueTypeName:"quaternion",DefaultInterpolation:co,InterpolantFactoryMethodLinear:function(e){return new hl(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0});function fl(e,t,n,i){Mt.call(this,e,t,n,i)}fl.prototype=Object.assign(Object.create(Mt.prototype),{constructor:fl,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:go,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0});function ua(e,t,n,i){Mt.call(this,e,t,n,i)}ua.prototype=Object.assign(Object.create(Mt.prototype),{constructor:ua,ValueTypeName:"vector"});function en(e,t,n){this.name=e,this.tracks=n,this.duration=t!==void 0?t:-1,this.uuid=Le.generateUUID(),this.duration<0&&this.resetDuration()}function Wg(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ca;case"vector":case"vector2":case"vector3":case"vector4":return ua;case"color":return ul;case"quaternion":return Wo;case"bool":case"boolean":return cl;case"string":return fl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function jg(e){if(e.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=Wg(e.type);if(e.times===void 0){var n=[],i=[];ot.flattenJSON(e.keys,n,i,"value"),e.times=n,e.values=i}return t.parse!==void 0?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}Object.assign(en,{parse:function(e){for(var t=[],n=e.tracks,i=1/(e.fps||1),r=0,a=n.length;r!==a;++r)t.push(jg(n[r]).scale(i));return new en(e.name,e.duration,t)},toJSON:function(e){for(var t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid},r=0,a=n.length;r!==a;++r)t.push(Mt.toJSON(n[r]));return i},CreateFromMorphTargetSequence:function(e,t,n,i){for(var r=t.length,a=[],o=0;o<r;o++){var s=[],l=[];s.push((o+r-1)%r,o,(o+1)%r),l.push(0,1,0);var c=ot.getKeyframeOrder(s);s=ot.sortedArray(s,1,c),l=ot.sortedArray(l,1,c),!i&&s[0]===0&&(s.push(r),l.push(l[0])),a.push(new ca(".morphTargetInfluences["+t[o].name+"]",s,l).scale(1/n))}return new en(e,-1,a)},findByName:function(e,t){var n=e;if(!Array.isArray(e)){var i=e;n=i.geometry&&i.geometry.animations||i.animations}for(var r=0;r<n.length;r++)if(n[r].name===t)return n[r];return null},CreateClipsFromMorphTargetSequences:function(e,t,n){for(var i={},r=/^([\w-]*?)([\d]+)$/,a=0,o=e.length;a<o;a++){var s=e[a],l=s.name.match(r);if(l&&l.length>1){var c=l[1],u=i[c];u||(i[c]=u=[]),u.push(s)}}var h=[];for(var c in i)h.push(en.CreateFromMorphTargetSequence(c,i[c],t,n));return h},parseAnimation:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(w,S,b,A,C){if(b.length!==0){var T=[],I=[];ot.flattenJSON(b,T,I,A),T.length!==0&&C.push(new w(S,T,I))}},i=[],r=e.name||"default",a=e.length||-1,o=e.fps||30,s=e.hierarchy||[],l=0;l<s.length;l++){var c=s[l].keys;if(!(!c||c.length===0))if(c[0].morphTargets){for(var u={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var f=0;f<c[h].morphTargets.length;f++)u[c[h].morphTargets[f]]=-1;for(var d in u){for(var p=[],m=[],f=0;f!==c[h].morphTargets.length;++f){var v=c[h];p.push(v.time),m.push(v.morphTarget===d?1:0)}i.push(new ca(".morphTargetInfluence["+d+"]",p,m))}a=u.length*(o||1)}else{var y=".bones["+t[l].name+"]";n(ua,y+".position",c,"pos",i),n(Wo,y+".quaternion",c,"rot",i),n(ua,y+".scale",c,"scl",i)}}if(i.length===0)return null;var x=new en(r,a,i);return x}});Object.assign(en.prototype,{resetDuration:function(){for(var e=this.tracks,t=0,n=0,i=e.length;n!==i;++n){var r=this.tracks[n];t=Math.max(t,r.times[r.times.length-1])}return this.duration=t,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new en(this.name,this.duration,e)}});var vr={enabled:!1,files:{},add:function(e,t){this.enabled!==!1&&(this.files[e]=t)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function wh(e,t,n){var i=this,r=!1,a=0,o=0,s=void 0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(c){o++,r===!1&&i.onStart!==void 0&&i.onStart(c,a,o),r=!0},this.itemEnd=function(c){a++,i.onProgress!==void 0&&i.onProgress(c,a,o),a===o&&(r=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(c){i.onError!==void 0&&i.onError(c)},this.resolveURL=function(c){return s?s(c):c},this.setURLModifier=function(c){return s=c,this},this.addHandler=function(c,u){return l.push(c,u),this},this.removeHandler=function(c){var u=l.indexOf(c);return u!==-1&&l.splice(u,2),this},this.getHandler=function(c){for(var u=0,h=l.length;u<h;u+=2){var f=l[u],d=l[u+1];if(f.global&&(f.lastIndex=0),f.test(c))return d}return null}}var qg=new wh;function Ve(e){this.manager=e!==void 0?e:qg,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Ve.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var $t={};function fn(e){Ve.call(this,e)}fn.prototype=Object.assign(Object.create(Ve.prototype),{constructor:fn,load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=vr.get(e);if(a!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;if($t[e]!==void 0){$t[e].push({onLoad:t,onProgress:n,onError:i});return}var o=/^data:(.*?)(;base64)?,(.*)$/,s=e.match(o);if(s){var l=s[1],c=!!s[2],u=s[3];u=decodeURIComponent(u),c&&(u=atob(u));try{var h,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":for(var d=new Uint8Array(u.length),p=0;p<u.length;p++)d[p]=u.charCodeAt(p);f==="blob"?h=new Blob([d.buffer],{type:l}):h=d.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(u,l);break;case"json":h=JSON.parse(u);break;default:h=u;break}setTimeout(function(){t&&t(h),r.manager.itemEnd(e)},0)}catch(x){setTimeout(function(){i&&i(x),r.manager.itemError(e),r.manager.itemEnd(e)},0)}}else{$t[e]=[],$t[e].push({onLoad:t,onProgress:n,onError:i});var v=new XMLHttpRequest;v.open("GET",e,!0),v.addEventListener("load",function(x){var w=this.response,S=$t[e];if(delete $t[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),vr.add(e,w);for(var b=0,A=S.length;b<A;b++){var C=S[b];C.onLoad&&C.onLoad(w)}r.manager.itemEnd(e)}else{for(var b=0,A=S.length;b<A;b++){var C=S[b];C.onError&&C.onError(x)}r.manager.itemError(e),r.manager.itemEnd(e)}},!1),v.addEventListener("progress",function(x){for(var w=$t[e],S=0,b=w.length;S<b;S++){var A=w[S];A.onProgress&&A.onProgress(x)}},!1),v.addEventListener("error",function(x){var w=$t[e];delete $t[e];for(var S=0,b=w.length;S<b;S++){var A=w[S];A.onError&&A.onError(x)}r.manager.itemError(e),r.manager.itemEnd(e)},!1),v.addEventListener("abort",function(x){var w=$t[e];delete $t[e];for(var S=0,b=w.length;S<b;S++){var A=w[S];A.onError&&A.onError(x)}r.manager.itemError(e),r.manager.itemEnd(e)},!1),this.responseType!==void 0&&(v.responseType=this.responseType),this.withCredentials!==void 0&&(v.withCredentials=this.withCredentials),v.overrideMimeType&&v.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(var y in this.requestHeader)v.setRequestHeader(y,this.requestHeader[y]);v.send(null)}return r.manager.itemStart(e),v},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});function ru(e){Ve.call(this,e)}ru.prototype=Object.assign(Object.create(Ve.prototype),{constructor:ru,load:function(e,t,n,i){var r=this,a=new fn(r.manager);a.setPath(r.path),a.load(e,function(o){t(r.parse(JSON.parse(o)))},n,i)},parse:function(e){for(var t=[],n=0;n<e.length;n++){var i=en.parse(e[n]);t.push(i)}return t}});function au(e){Ve.call(this,e)}au.prototype=Object.assign(Object.create(Ve.prototype),{constructor:au,load:function(e,t,n,i){var r=this,a=[],o=new Yr;o.image=a;var s=new fn(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer");function l(f){s.load(e[f],function(d){var p=r.parse(d,!0);a[f]={width:p.width,height:p.height,format:p.format,mipmaps:p.mipmaps},c+=1,c===6&&(p.mipmapCount===1&&(o.minFilter=gt),o.format=p.format,o.needsUpdate=!0,t&&t(o))},n,i)}if(Array.isArray(e))for(var c=0,u=0,h=e.length;u<h;++u)l(u);else s.load(e,function(f){var d=r.parse(f,!0);if(d.isCubemap)for(var p=d.mipmaps.length/d.mipmapCount,m=0;m<p;m++){a[m]={mipmaps:[]};for(var v=0;v<d.mipmapCount;v++)a[m].mipmaps.push(d.mipmaps[m*d.mipmapCount+v]),a[m].format=d.format,a[m].width=d.width,a[m].height=d.height}else o.image.width=d.width,o.image.height=d.height,o.mipmaps=d.mipmaps;d.mipmapCount===1&&(o.minFilter=gt),o.format=d.format,o.needsUpdate=!0,t&&t(o)},n,i);return o}});function ou(e){Ve.call(this,e)}ou.prototype=Object.assign(Object.create(Ve.prototype),{constructor:ou,load:function(e,t,n,i){var r=this,a=new tr,o=new fn(this.manager);return o.setResponseType("arraybuffer"),o.setPath(this.path),o.load(e,function(s){var l=r.parse(s);l&&(l.image!==void 0?a.image=l.image:l.data!==void 0&&(a.image.width=l.width,a.image.height=l.height,a.image.data=l.data),a.wrapS=l.wrapS!==void 0?l.wrapS:Ct,a.wrapT=l.wrapT!==void 0?l.wrapT:Ct,a.magFilter=l.magFilter!==void 0?l.magFilter:gt,a.minFilter=l.minFilter!==void 0?l.minFilter:gt,a.anisotropy=l.anisotropy!==void 0?l.anisotropy:1,l.format!==void 0&&(a.format=l.format),l.type!==void 0&&(a.type=l.type),l.mipmaps!==void 0&&(a.mipmaps=l.mipmaps,a.minFilter=ts),l.mipmapCount===1&&(a.minFilter=gt),a.needsUpdate=!0,t&&t(a,l))},n,i),a}});function ha(e){Ve.call(this,e)}ha.prototype=Object.assign(Object.create(Ve.prototype),{constructor:ha,load:function(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=vr.get(e);if(a!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),vr.add(e,this),t&&t(this),r.manager.itemEnd(e)}function l(c){o.removeEventListener("load",s,!1),o.removeEventListener("error",l,!1),i&&i(c),r.manager.itemError(e),r.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",l,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(e),o.src=e,o}});function dl(e){Ve.call(this,e)}dl.prototype=Object.assign(Object.create(Ve.prototype),{constructor:dl,load:function(e,t,n,i){var r=new Yn,a=new ha(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(c){a.load(e[c],function(u){r.images[c]=u,o++,o===6&&(r.needsUpdate=!0,t&&t(r))},void 0,i)}for(var l=0;l<e.length;++l)s(l);return r}});function pl(e){Ve.call(this,e)}pl.prototype=Object.assign(Object.create(Ve.prototype),{constructor:pl,load:function(e,t,n,i){var r=new Je,a=new ha(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){r.image=o;var s=e.search(/\.jpe?g($|\?)/i)>0||e.search(/^data\:image\/jpeg/)===0;r.format=s?mi:hn,r.needsUpdate=!0,t!==void 0&&t(r)},n,i),r}});function fe(){this.type="Curve",this.arcLengthDivisions=200}Object.assign(fe.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(e){e===void 0&&(e=5);for(var t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t=[],n,i=this.getPoint(0),r,a=0;for(t.push(0),r=1;r<=e;r++)n=this.getPoint(r/e),a+=n.distanceTo(i),t.push(a),i=n;return this.cacheArcLengths=t,t},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n=this.getLengths(),i=0,r=n.length,a;t?a=t:a=e*n[r-1];for(var o=0,s=r-1,l;o<=s;)if(i=Math.floor(o+(s-o)/2),l=n[i]-a,l<0)o=i+1;else if(l>0)s=i-1;else{s=i;break}if(i=s,n[i]===a)return i/(r-1);var c=n[i],u=n[i+1],h=u-c,f=(a-c)/h,d=(i+f)/(r-1);return d},getTangent:function(e){var t=1e-4,n=e-t,i=e+t;n<0&&(n=0),i>1&&(i=1);var r=this.getPoint(n),a=this.getPoint(i),o=a.clone().sub(r);return o.normalize()},getTangentAt:function(e){var t=this.getUtoTmapping(e);return this.getTangent(t)},computeFrenetFrames:function(e,t){var n=new M,i=[],r=[],a=[],o=new M,s=new Re,l,c,u;for(l=0;l<=e;l++)c=l/e,i[l]=this.getTangentAt(c),i[l].normalize();r[0]=new M,a[0]=new M;var h=Number.MAX_VALUE,f=Math.abs(i[0].x),d=Math.abs(i[0].y),p=Math.abs(i[0].z);for(f<=h&&(h=f,n.set(1,0,0)),d<=h&&(h=d,n.set(0,1,0)),p<=h&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),r[0].crossVectors(i[0],o),a[0].crossVectors(i[0],r[0]),l=1;l<=e;l++)r[l]=r[l-1].clone(),a[l]=a[l-1].clone(),o.crossVectors(i[l-1],i[l]),o.length()>Number.EPSILON&&(o.normalize(),u=Math.acos(Le.clamp(i[l-1].dot(i[l]),-1,1)),r[l].applyMatrix4(s.makeRotationAxis(o,u))),a[l].crossVectors(i[l],r[l]);if(t===!0)for(u=Math.acos(Le.clamp(r[0].dot(r[e]),-1,1)),u/=e,i[0].dot(o.crossVectors(r[0],r[e]))>0&&(u=-u),l=1;l<=e;l++)r[l].applyMatrix4(s.makeRotationAxis(i[l],u*l)),a[l].crossVectors(i[l],r[l]);return{tangents:i,normals:r,binormals:a}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});function jt(e,t,n,i,r,a,o,s){fe.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=t||0,this.xRadius=n||1,this.yRadius=i||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}jt.prototype=Object.create(fe.prototype);jt.prototype.constructor=jt;jt.prototype.isEllipseCurve=!0;jt.prototype.getPoint=function(e,t){for(var n=t||new U,i=Math.PI*2,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=i;for(;r>i;)r-=i;r<Number.EPSILON&&(a?r=0:r=i),this.aClockwise===!0&&!a&&(r===i?r=-i:r=r-i);var o=this.aStartAngle+e*r,s=this.aX+this.xRadius*Math.cos(o),l=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){var c=Math.cos(this.aRotation),u=Math.sin(this.aRotation),h=s-this.aX,f=l-this.aY;s=h*c-f*u+this.aX,l=h*u+f*c+this.aY}return n.set(s,l)};jt.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};jt.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e};jt.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this};function fa(e,t,n,i,r,a){jt.call(this,e,t,n,n,i,r,a),this.type="ArcCurve"}fa.prototype=Object.create(jt.prototype);fa.prototype.constructor=fa;fa.prototype.isArcCurve=!0;function Xl(){var e=0,t=0,n=0,i=0;function r(a,o,s,l){e=a,t=s,n=-3*a+3*o-2*s-l,i=2*a-2*o+s+l}return{initCatmullRom:function(a,o,s,l,c){r(o,s,c*(s-a),c*(l-o))},initNonuniformCatmullRom:function(a,o,s,l,c,u,h){var f=(o-a)/c-(s-a)/(c+u)+(s-o)/u,d=(s-o)/u-(l-o)/(u+h)+(l-s)/h;f*=u,d*=u,r(o,s,f,d)},calc:function(a){var o=a*a,s=o*a;return e+t*a+n*o+i*s}}}var Qa=new M,Ps=new Xl,Is=new Xl,Ds=new Xl;function zt(e,t,n,i){fe.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=t||!1,this.curveType=n||"centripetal",this.tension=i||.5}zt.prototype=Object.create(fe.prototype);zt.prototype.constructor=zt;zt.prototype.isCatmullRomCurve3=!0;zt.prototype.getPoint=function(e,t){var n=t||new M,i=this.points,r=i.length,a=(r-(this.closed?0:1))*e,o=Math.floor(a),s=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/r)+1)*r:s===0&&o===r-1&&(o=r-2,s=1);var l,c,u,h;if(this.closed||o>0?l=i[(o-1)%r]:(Qa.subVectors(i[0],i[1]).add(i[0]),l=Qa),c=i[o%r],u=i[(o+1)%r],this.closed||o+2<r?h=i[(o+2)%r]:(Qa.subVectors(i[r-1],i[r-2]).add(i[r-1]),h=Qa),this.curveType==="centripetal"||this.curveType==="chordal"){var f=this.curveType==="chordal"?.5:.25,d=Math.pow(l.distanceToSquared(c),f),p=Math.pow(c.distanceToSquared(u),f),m=Math.pow(u.distanceToSquared(h),f);p<1e-4&&(p=1),d<1e-4&&(d=p),m<1e-4&&(m=p),Ps.initNonuniformCatmullRom(l.x,c.x,u.x,h.x,d,p,m),Is.initNonuniformCatmullRom(l.y,c.y,u.y,h.y,d,p,m),Ds.initNonuniformCatmullRom(l.z,c.z,u.z,h.z,d,p,m)}else this.curveType==="catmullrom"&&(Ps.initCatmullRom(l.x,c.x,u.x,h.x,this.tension),Is.initCatmullRom(l.y,c.y,u.y,h.y,this.tension),Ds.initCatmullRom(l.z,c.z,u.z,h.z,this.tension));return n.set(Ps.calc(s),Is.calc(s),Ds.calc(s)),n};zt.prototype.copy=function(e){fe.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};zt.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e};zt.prototype.fromJSON=function(e){fe.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new M().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this};function su(e,t,n,i,r){var a=(i-t)*.5,o=(r-n)*.5,s=e*e,l=e*s;return(2*n-2*i+a+o)*l+(-3*n+3*i-2*a-o)*s+a*e+n}function Xg(e,t){var n=1-e;return n*n*t}function Yg(e,t){return 2*(1-e)*e*t}function Zg(e,t){return e*e*t}function Fr(e,t,n,i){return Xg(e,t)+Yg(e,n)+Zg(e,i)}function Jg(e,t){var n=1-e;return n*n*n*t}function $g(e,t){var n=1-e;return 3*n*n*e*t}function Kg(e,t){return 3*(1-e)*e*e*t}function Qg(e,t){return e*e*e*t}function Br(e,t,n,i,r){return Jg(e,t)+$g(e,n)+Kg(e,i)+Qg(e,r)}function dn(e,t,n,i){fe.call(this),this.type="CubicBezierCurve",this.v0=e||new U,this.v1=t||new U,this.v2=n||new U,this.v3=i||new U}dn.prototype=Object.create(fe.prototype);dn.prototype.constructor=dn;dn.prototype.isCubicBezierCurve=!0;dn.prototype.getPoint=function(e,t){var n=t||new U,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Br(e,i.x,r.x,a.x,o.x),Br(e,i.y,r.y,a.y,o.y)),n};dn.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this};dn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e};dn.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Cn(e,t,n,i){fe.call(this),this.type="CubicBezierCurve3",this.v0=e||new M,this.v1=t||new M,this.v2=n||new M,this.v3=i||new M}Cn.prototype=Object.create(fe.prototype);Cn.prototype.constructor=Cn;Cn.prototype.isCubicBezierCurve3=!0;Cn.prototype.getPoint=function(e,t){var n=t||new M,i=this.v0,r=this.v1,a=this.v2,o=this.v3;return n.set(Br(e,i.x,r.x,a.x,o.x),Br(e,i.y,r.y,a.y,o.y),Br(e,i.z,r.z,a.z,o.z)),n};Cn.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this};Cn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e};Cn.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this};function Ut(e,t){fe.call(this),this.type="LineCurve",this.v1=e||new U,this.v2=t||new U}Ut.prototype=Object.create(fe.prototype);Ut.prototype.constructor=Ut;Ut.prototype.isLineCurve=!0;Ut.prototype.getPoint=function(e,t){var n=t||new U;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n};Ut.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};Ut.prototype.getTangent=function(){var e=this.v2.clone().sub(this.v1);return e.normalize()};Ut.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this};Ut.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e};Ut.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function pn(e,t){fe.call(this),this.type="LineCurve3",this.v1=e||new M,this.v2=t||new M}pn.prototype=Object.create(fe.prototype);pn.prototype.constructor=pn;pn.prototype.isLineCurve3=!0;pn.prototype.getPoint=function(e,t){var n=t||new M;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n};pn.prototype.getPointAt=function(e,t){return this.getPoint(e,t)};pn.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this};pn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e};pn.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function mn(e,t,n){fe.call(this),this.type="QuadraticBezierCurve",this.v0=e||new U,this.v1=t||new U,this.v2=n||new U}mn.prototype=Object.create(fe.prototype);mn.prototype.constructor=mn;mn.prototype.isQuadraticBezierCurve=!0;mn.prototype.getPoint=function(e,t){var n=t||new U,i=this.v0,r=this.v1,a=this.v2;return n.set(Fr(e,i.x,r.x,a.x),Fr(e,i.y,r.y,a.y)),n};mn.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this};mn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e};mn.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function Rn(e,t,n){fe.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new M,this.v1=t||new M,this.v2=n||new M}Rn.prototype=Object.create(fe.prototype);Rn.prototype.constructor=Rn;Rn.prototype.isQuadraticBezierCurve3=!0;Rn.prototype.getPoint=function(e,t){var n=t||new M,i=this.v0,r=this.v1,a=this.v2;return n.set(Fr(e,i.x,r.x,a.x),Fr(e,i.y,r.y,a.y),Fr(e,i.z,r.z,a.z)),n};Rn.prototype.copy=function(e){return fe.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this};Rn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e};Rn.prototype.fromJSON=function(e){return fe.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this};function vn(e){fe.call(this),this.type="SplineCurve",this.points=e||[]}vn.prototype=Object.create(fe.prototype);vn.prototype.constructor=vn;vn.prototype.isSplineCurve=!0;vn.prototype.getPoint=function(e,t){var n=t||new U,i=this.points,r=(i.length-1)*e,a=Math.floor(r),o=r-a,s=i[a===0?a:a-1],l=i[a],c=i[a>i.length-2?i.length-1:a+1],u=i[a>i.length-3?i.length-1:a+2];return n.set(su(o,s.x,l.x,c.x,u.x),su(o,s.y,l.y,c.y,u.y)),n};vn.prototype.copy=function(e){fe.prototype.copy.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(i.clone())}return this};vn.prototype.toJSON=function(){var e=fe.prototype.toJSON.call(this);e.points=[];for(var t=0,n=this.points.length;t<n;t++){var i=this.points[t];e.points.push(i.toArray())}return e};vn.prototype.fromJSON=function(e){fe.prototype.fromJSON.call(this,e),this.points=[];for(var t=0,n=e.points.length;t<n;t++){var i=e.points[t];this.points.push(new U().fromArray(i))}return this};var ml=Object.freeze({__proto__:null,ArcCurve:fa,CatmullRomCurve3:zt,CubicBezierCurve:dn,CubicBezierCurve3:Cn,EllipseCurve:jt,LineCurve:Ut,LineCurve3:pn,QuadraticBezierCurve:mn,QuadraticBezierCurve3:Rn,SplineCurve:vn});function Vn(){fe.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}Vn.prototype=Object.assign(Object.create(fe.prototype),{constructor:Vn,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new Ut(t,e))},getPoint:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var r=n[i]-t,a=this.curves[i],o=a.getLength(),s=o===0?0:1-r/o;return a.getPointAt(s)}i++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t},getPoints:function(e){e=e||12;for(var t=[],n,i=0,r=this.curves;i<r.length;i++)for(var a=r[i],o=a&&a.isEllipseCurve?e*2:a&&(a.isLineCurve||a.isLineCurve3)?1:a&&a.isSplineCurve?e*a.points.length:e,s=a.getPoints(o),l=0;l<s.length;l++){var c=s[l];n&&n.equals(c)||(t.push(c),n=c)}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t},copy:function(e){fe.prototype.copy.call(this,e),this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this},toJSON:function(){var e=fe.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,n=this.curves.length;t<n;t++){var i=this.curves[t];e.curves.push(i.toJSON())}return e},fromJSON:function(e){fe.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,n=e.curves.length;t<n;t++){var i=e.curves[t];this.curves.push(new ml[i.type]().fromJSON(i))}return this}});function ln(e){Vn.call(this),this.type="Path",this.currentPoint=new U,e&&this.setFromPoints(e)}ln.prototype=Object.assign(Object.create(Vn.prototype),{constructor:ln,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this},moveTo:function(e,t){return this.currentPoint.set(e,t),this},lineTo:function(e,t){var n=new Ut(this.currentPoint.clone(),new U(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this},quadraticCurveTo:function(e,t,n,i){var r=new mn(this.currentPoint.clone(),new U(e,t),new U(n,i));return this.curves.push(r),this.currentPoint.set(n,i),this},bezierCurveTo:function(e,t,n,i,r,a){var o=new dn(this.currentPoint.clone(),new U(e,t),new U(n,i),new U(r,a));return this.curves.push(o),this.currentPoint.set(r,a),this},splineThru:function(e){var t=[this.currentPoint.clone()].concat(e),n=new vn(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,t,n,i,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,i,r,a),this},absarc:function(e,t,n,i,r,a){return this.absellipse(e,t,n,n,i,r,a),this},ellipse:function(e,t,n,i,r,a,o,s){var l=this.currentPoint.x,c=this.currentPoint.y;return this.absellipse(e+l,t+c,n,i,r,a,o,s),this},absellipse:function(e,t,n,i,r,a,o,s){var l=new jt(e,t,n,i,r,a,o,s);if(this.curves.length>0){var c=l.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(l);var u=l.getPoint(1);return this.currentPoint.copy(u),this},copy:function(e){return Vn.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=Vn.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return Vn.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}});function pi(e){ln.call(this,e),this.uuid=Le.generateUUID(),this.type="Shape",this.holes=[]}pi.prototype=Object.assign(Object.create(ln.prototype),{constructor:pi,getPointsHoles:function(e){for(var t=[],n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){ln.prototype.copy.call(this,e),this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(i.clone())}return this},toJSON:function(){var e=ln.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,n=this.holes.length;t<n;t++){var i=this.holes[t];e.holes.push(i.toJSON())}return e},fromJSON:function(e){ln.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,n=e.holes.length;t<n;t++){var i=e.holes[t];this.holes.push(new ln().fromJSON(i))}return this}});function Qe(e,t){Q.call(this),this.type="Light",this.color=new ee(e),this.intensity=t!==void 0?t:1,this.receiveShadow=void 0}Qe.prototype=Object.assign(Object.create(Q.prototype),{constructor:Qe,isLight:!0,copy:function(e){return Q.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var t=Q.prototype.toJSON.call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}});function vl(e,t,n){Qe.call(this,e,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Q.DefaultUp),this.updateMatrix(),this.groundColor=new ee(t)}vl.prototype=Object.assign(Object.create(Qe.prototype),{constructor:vl,isHemisphereLight:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}});function Pn(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new U(512,512),this.map=null,this.mapPass=null,this.matrix=new Re,this._frustum=new Sa,this._frameExtents=new U(1,1),this._viewportCount=1,this._viewports=[new Ze(0,0,1,1)]}Object.assign(Pn.prototype,{_projScreenMatrix:new Re,_lightPositionWorld:new M,_lookTarget:new M,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var t=this.camera,n=this.matrix,i=this._projScreenMatrix,r=this._lookTarget,a=this._lightPositionWorld;a.setFromMatrixPosition(e.matrixWorld),t.position.copy(a),r.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(r),t.updateMatrixWorld(),i.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(i),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}});function gl(){Pn.call(this,new ut(50,1,.5,500))}gl.prototype=Object.assign(Object.create(Pn.prototype),{constructor:gl,isSpotLightShadow:!0,updateMatrices:function(e){var t=this.camera,n=Le.RAD2DEG*2*e.angle,i=this.mapSize.width/this.mapSize.height,r=e.distance||t.far;(n!==t.fov||i!==t.aspect||r!==t.far)&&(t.fov=n,t.aspect=i,t.far=r,t.updateProjectionMatrix()),Pn.prototype.updateMatrices.call(this,e)}});function yl(e,t,n,i,r,a){Qe.call(this,e,t),this.type="SpotLight",this.position.copy(Q.DefaultUp),this.updateMatrix(),this.target=new Q,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(o){this.intensity=o/Math.PI}}),this.distance=n!==void 0?n:0,this.angle=i!==void 0?i:Math.PI/3,this.penumbra=r!==void 0?r:0,this.decay=a!==void 0?a:1,this.shadow=new gl}yl.prototype=Object.assign(Object.create(Qe.prototype),{constructor:yl,isSpotLight:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function xl(){Pn.call(this,new ut(90,1,.5,500)),this._frameExtents=new U(4,2),this._viewportCount=6,this._viewports=[new Ze(2,1,1,1),new Ze(0,1,1,1),new Ze(3,1,1,1),new Ze(1,1,1,1),new Ze(3,0,1,1),new Ze(1,0,1,1)],this._cubeDirections=[new M(1,0,0),new M(-1,0,0),new M(0,0,1),new M(0,0,-1),new M(0,1,0),new M(0,-1,0)],this._cubeUps=[new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,1,0),new M(0,0,1),new M(0,0,-1)]}xl.prototype=Object.assign(Object.create(Pn.prototype),{constructor:xl,isPointLightShadow:!0,updateMatrices:function(e,t){t===void 0&&(t=0);var n=this.camera,i=this.matrix,r=this._lightPositionWorld,a=this._lookTarget,o=this._projScreenMatrix;r.setFromMatrixPosition(e.matrixWorld),n.position.copy(r),a.copy(n.position),a.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(a),n.updateMatrixWorld(),i.makeTranslation(-r.x,-r.y,-r.z),o.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(o)}});function _l(e,t,n,i){Qe.call(this,e,t),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return this.intensity*4*Math.PI},set:function(r){this.intensity=r/(4*Math.PI)}}),this.distance=n!==void 0?n:0,this.decay=i!==void 0?i:1,this.shadow=new xl}_l.prototype=Object.assign(Object.create(Qe.prototype),{constructor:_l,isPointLight:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}});function da(e,t,n,i,r,a){Tn.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=t!==void 0?t:1,this.top=n!==void 0?n:1,this.bottom=i!==void 0?i:-1,this.near=r!==void 0?r:.1,this.far=a!==void 0?a:2e3,this.updateProjectionMatrix()}da.prototype=Object.assign(Object.create(Tn.prototype),{constructor:da,isOrthographicCamera:!0,copy:function(e,t){return Tn.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,i,r,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2,r=n-e,a=n+e,o=i+t,s=i-t;if(this.view!==null&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;r+=l*this.view.offsetX,a=r+l*this.view.width,o-=c*this.view.offsetY,s=o-c*this.view.height}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=Q.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}});function wl(){Pn.call(this,new da(-5,5,5,-5,.5,500))}wl.prototype=Object.assign(Object.create(Pn.prototype),{constructor:wl,isDirectionalLightShadow:!0,updateMatrices:function(e){Pn.prototype.updateMatrices.call(this,e)}});function bl(e,t){Qe.call(this,e,t),this.type="DirectionalLight",this.position.copy(Q.DefaultUp),this.updateMatrix(),this.target=new Q,this.shadow=new wl}bl.prototype=Object.assign(Object.create(Qe.prototype),{constructor:bl,isDirectionalLight:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});function jo(e,t){Qe.call(this,e,t),this.type="AmbientLight",this.castShadow=void 0}jo.prototype=Object.assign(Object.create(Qe.prototype),{constructor:jo,isAmbientLight:!0});function Ml(e,t,n,i){Qe.call(this,e,t),this.type="RectAreaLight",this.width=n!==void 0?n:10,this.height=i!==void 0?i:10}Ml.prototype=Object.assign(Object.create(Qe.prototype),{constructor:Ml,isRectAreaLight:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var t=Qe.prototype.toJSON.call(this,e);return t.object.width=this.width,t.object.height=this.height,t}});function Sl(e){Ve.call(this,e),this.textures={}}Sl.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Sl,load:function(e,t,n,i){var r=this,a=new fn(r.manager);a.setPath(r.path),a.load(e,function(o){t(r.parse(JSON.parse(o)))},n,i)},parse:function(e){var t=this.textures;function n(l){return t[l]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",l),t[l]}var i=new Hg[e.type];if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=new ee().setHex(e.sheen)),e.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular.setHex(e.specular),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.vertexColors!==void 0&&(i.vertexColors=e.vertexColors),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==1&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(i.skinning=e.skinning),e.morphTargets!==void 0&&(i.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(i.morphNormals=e.morphNormals),e.dithering!==void 0&&(i.dithering=e.dithering),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.uniforms!==void 0)for(var r in e.uniforms){var a=e.uniforms[r];switch(i.uniforms[r]={},a.type){case"t":i.uniforms[r].value=n(a.value);break;case"c":i.uniforms[r].value=new ee().setHex(a.value);break;case"v2":i.uniforms[r].value=new U().fromArray(a.value);break;case"v3":i.uniforms[r].value=new M().fromArray(a.value);break;case"v4":i.uniforms[r].value=new Ze().fromArray(a.value);break;case"m3":i.uniforms[r].value=new bt().fromArray(a.value);case"m4":i.uniforms[r].value=new Re().fromArray(a.value);break;default:i.uniforms[r].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var o in e.extensions)i.extensions[o]=e.extensions[o];if(e.shading!==void 0&&(i.flatShading=e.shading===1),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap),i.transparent=!0),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){var s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new U().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new U().fromArray(e.clearcoatNormalScale)),i},setTextures:function(e){return this.textures=e,this}});var bh={decodeText:function(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);for(var t="",n=0,i=e.length;n<i;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch{return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return t===-1?"./":e.substr(0,t+1)}};function El(){ne.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}El.prototype=Object.assign(Object.create(ne.prototype),{constructor:El,isInstancedBufferGeometry:!0,copy:function(e){return ne.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=ne.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}});function Tl(e,t,n,i){typeof n=="number"&&(i=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),_e.call(this,e,t,n),this.meshPerAttribute=i||1}Tl.prototype=Object.assign(Object.create(_e.prototype),{constructor:Tl,isInstancedBufferAttribute:!0,copy:function(e){return _e.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=_e.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});function Al(e){Ve.call(this,e)}Al.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Al,load:function(e,t,n,i){var r=this,a=new fn(r.manager);a.setPath(r.path),a.load(e,function(o){t(r.parse(JSON.parse(o)))},n,i)},parse:function(e){var t=e.isInstancedBufferGeometry?new El:new ne,n=e.data.index;if(n!==void 0){var i=new Os[n.type](n.array);t.setIndex(new _e(i,1))}var r=e.data.attributes;for(var a in r){var o=r[a],i=new Os[o.type](o.array),s=o.isInstancedBufferAttribute?Tl:_e,l=new s(i,o.itemSize,o.normalized);o.name!==void 0&&(l.name=o.name),t.setAttribute(a,l)}var c=e.data.morphAttributes;if(c)for(var a in c){for(var u=c[a],h=[],f=0,d=u.length;f<d;f++){var o=u[f],i=new Os[o.type](o.array),l=new _e(i,o.itemSize,o.normalized);o.name!==void 0&&(l.name=o.name),h.push(l)}t.morphAttributes[a]=h}var p=e.data.morphTargetsRelative;p&&(t.morphTargetsRelative=!0);var m=e.data.groups||e.data.drawcalls||e.data.offsets;if(m!==void 0)for(var f=0,v=m.length;f!==v;++f){var y=m[f];t.addGroup(y.start,y.count,y.materialIndex)}var x=e.data.boundingSphere;if(x!==void 0){var w=new M;x.center!==void 0&&w.fromArray(x.center),t.boundingSphere=new ei(w,x.radius)}return e.name&&(t.name=e.name),e.userData&&(t.userData=e.userData),t}});var Os={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ll(e){Ve.call(this,e)}Ll.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Ll,load:function(e,t,n,i){var r=this,a=this.path===""?bh.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;var o=new fn(r.manager);o.setPath(this.path),o.load(e,function(s){var l=null;try{l=JSON.parse(s)}catch(u){i!==void 0&&i(u),console.error("THREE:ObjectLoader: Can't parse "+e+".",u.message);return}var c=l.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+e);return}r.parse(l,t)},n,i)},parse:function(e,t){var n=this.parseShape(e.shapes),i=this.parseGeometries(e.geometries,n),r=this.parseImages(e.images,function(){t!==void 0&&t(s)}),a=this.parseTextures(e.textures,r),o=this.parseMaterials(e.materials,a),s=this.parseObject(e.object,i,o);return e.animations&&(s.animations=this.parseAnimations(e.animations)),(e.images===void 0||e.images.length===0)&&t!==void 0&&t(s),s},parseShape:function(e){var t={};if(e!==void 0)for(var n=0,i=e.length;n<i;n++){var r=new pi().fromJSON(e[n]);t[r.uuid]=r}return t},parseGeometries:function(e,t){var n={};if(e!==void 0)for(var i=new Al,r=0,a=e.length;r<a;r++){var o,s=e[r];switch(s.type){case"PlaneGeometry":case"PlaneBufferGeometry":o=new Tt[s.type](s.width,s.height,s.widthSegments,s.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":o=new Tt[s.type](s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":o=new Tt[s.type](s.radius,s.segments,s.thetaStart,s.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":o=new Tt[s.type](s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":o=new Tt[s.type](s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":o=new Tt[s.type](s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":o=new Tt[s.type](s.radius,s.detail);break;case"RingGeometry":case"RingBufferGeometry":o=new Tt[s.type](s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":o=new Tt[s.type](s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":o=new Tt[s.type](s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q);break;case"TubeGeometry":case"TubeBufferGeometry":o=new Tt[s.type](new ml[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed);break;case"LatheGeometry":case"LatheBufferGeometry":o=new Tt[s.type](s.points,s.segments,s.phiStart,s.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":o=new Tt[s.type](s.vertices,s.indices,s.radius,s.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var h=[],l=0,c=s.shapes.length;l<c;l++){var u=t[s.shapes[l]];h.push(u)}o=new Tt[s.type](h,s.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(var h=[],l=0,c=s.shapes.length;l<c;l++){var u=t[s.shapes[l]];h.push(u)}var f=s.options.extrudePath;f!==void 0&&(s.options.extrudePath=new ml[f.type]().fromJSON(f)),o=new Tt[s.type](h,s.options);break;case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(s);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var d=new THREE.LegacyJSONLoader;o=d.parse(s,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+s.type+'"');continue}o.uuid=s.uuid,s.name!==void 0&&(o.name=s.name),o.isBufferGeometry===!0&&s.userData!==void 0&&(o.userData=s.userData),n[s.uuid]=o}return n},parseMaterials:function(e,t){var n={},i={};if(e!==void 0){var r=new Sl;r.setTextures(t);for(var a=0,o=e.length;a<o;a++){var s=e[a];if(s.type==="MultiMaterial"){for(var l=[],c=0;c<s.materials.length;c++){var u=s.materials[c];n[u.uuid]===void 0&&(n[u.uuid]=r.parse(u)),l.push(n[u.uuid])}i[s.uuid]=l}else n[s.uuid]===void 0&&(n[s.uuid]=r.parse(s)),i[s.uuid]=n[s.uuid]}}return i},parseAnimations:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],r=en.parse(i);i.uuid!==void 0&&(r.uuid=i.uuid),t.push(r)}return t},parseImages:function(e,t){var n=this,i={};function r(m){return n.manager.itemStart(m),o.load(m,function(){n.manager.itemEnd(m)},void 0,function(){n.manager.itemError(m),n.manager.itemEnd(m)})}if(e!==void 0&&e.length>0){var a=new wh(t),o=new ha(a);o.setCrossOrigin(this.crossOrigin);for(var s=0,l=e.length;s<l;s++){var c=e[s],u=c.url;if(Array.isArray(u)){i[c.uuid]=[];for(var h=0,f=u.length;h<f;h++){var d=u[h],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(d)?d:n.resourcePath+d;i[c.uuid].push(r(p))}}else{var p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:n.resourcePath+c.url;i[c.uuid]=r(p)}}}return i},parseTextures:function(e,t){function n(l,c){return typeof l=="number"?l:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",l),c[l])}var i={};if(e!==void 0)for(var r=0,a=e.length;r<a;r++){var o=e[r];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s;Array.isArray(t[o.image])?s=new Yn(t[o.image]):s=new Je(t[o.image]),s.needsUpdate=!0,s.uuid=o.uuid,o.name!==void 0&&(s.name=o.name),o.mapping!==void 0&&(s.mapping=n(o.mapping,ey)),o.offset!==void 0&&s.offset.fromArray(o.offset),o.repeat!==void 0&&s.repeat.fromArray(o.repeat),o.center!==void 0&&s.center.fromArray(o.center),o.rotation!==void 0&&(s.rotation=o.rotation),o.wrap!==void 0&&(s.wrapS=n(o.wrap[0],lu),s.wrapT=n(o.wrap[1],lu)),o.format!==void 0&&(s.format=o.format),o.type!==void 0&&(s.type=o.type),o.encoding!==void 0&&(s.encoding=o.encoding),o.minFilter!==void 0&&(s.minFilter=n(o.minFilter,cu)),o.magFilter!==void 0&&(s.magFilter=n(o.magFilter,cu)),o.anisotropy!==void 0&&(s.anisotropy=o.anisotropy),o.flipY!==void 0&&(s.flipY=o.flipY),o.premultiplyAlpha!==void 0&&(s.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(s.unpackAlignment=o.unpackAlignment),i[o.uuid]=s}return i},parseObject:function(e,t,n){var i;function r(v){return t[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",v),t[v]}function a(v){if(v!==void 0){if(Array.isArray(v)){for(var y=[],x=0,w=v.length;x<w;x++){var S=v[x];n[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),y.push(n[S])}return y}return n[v]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",v),n[v]}}switch(e.type){case"Scene":i=new En,e.background!==void 0&&Number.isInteger(e.background)&&(i.background=new ee(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?i.fog=new Ks(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(i.fog=new $s(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":i=new ut(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(i.focus=e.focus),e.zoom!==void 0&&(i.zoom=e.zoom),e.filmGauge!==void 0&&(i.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(i.filmOffset=e.filmOffset),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"OrthographicCamera":i=new da(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(i.zoom=e.zoom),e.view!==void 0&&(i.view=Object.assign({},e.view));break;case"AmbientLight":i=new jo(e.color,e.intensity);break;case"DirectionalLight":i=new bl(e.color,e.intensity);break;case"PointLight":i=new _l(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":i=new Ml(e.color,e.intensity,e.width,e.height);break;case"SpotLight":i=new yl(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":i=new vl(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=r(e.geometry),s=a(e.material);o.bones&&o.bones.length>0?i=new bo(o,s):i=new et(o,s);break;case"InstancedMesh":var o=r(e.geometry),s=a(e.material),l=e.count,c=e.instanceMatrix;i=new tl(o,s,l),i.instanceMatrix=new _e(new Float32Array(c.array),16);break;case"LOD":i=new wo;break;case"Line":i=new Wt(r(e.geometry),a(e.material),e.mode);break;case"LineLoop":i=new nl(r(e.geometry),a(e.material));break;case"LineSegments":i=new ft(r(e.geometry),a(e.material));break;case"PointCloud":case"Points":i=new rl(r(e.geometry),a(e.material));break;case"Sprite":i=new Qs(a(e.material));break;case"Group":i=new Xr;break;default:i=new Q}if(i.uuid=e.uuid,e.name!==void 0&&(i.name=e.name),e.matrix!==void 0?(i.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(i.matrixAutoUpdate=e.matrixAutoUpdate),i.matrixAutoUpdate&&i.matrix.decompose(i.position,i.quaternion,i.scale)):(e.position!==void 0&&i.position.fromArray(e.position),e.rotation!==void 0&&i.rotation.fromArray(e.rotation),e.quaternion!==void 0&&i.quaternion.fromArray(e.quaternion),e.scale!==void 0&&i.scale.fromArray(e.scale)),e.castShadow!==void 0&&(i.castShadow=e.castShadow),e.receiveShadow!==void 0&&(i.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(i.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(i.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&i.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(i.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(i.visible=e.visible),e.frustumCulled!==void 0&&(i.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(i.renderOrder=e.renderOrder),e.userData!==void 0&&(i.userData=e.userData),e.layers!==void 0&&(i.layers.mask=e.layers),e.children!==void 0)for(var u=e.children,h=0;h<u.length;h++)i.add(this.parseObject(u[h],t,n));if(e.type==="LOD"){e.autoUpdate!==void 0&&(i.autoUpdate=e.autoUpdate);for(var f=e.levels,d=0;d<f.length;d++){var p=f[d],m=i.getObjectByProperty("uuid",p.object);m!==void 0&&i.addLevel(m,p.distance)}}return i}});var ey={UVMapping:kl,CubeReflectionMapping:zl,CubeRefractionMapping:Ul,EquirectangularReflectionMapping:qu,EquirectangularRefractionMapping:Gl,SphericalReflectionMapping:Xu,CubeUVReflectionMapping:Ma,CubeUVRefractionMapping:Vl},lu={RepeatWrapping:fo,ClampToEdgeWrapping:Ct,MirroredRepeatWrapping:po},cu={NearestFilter:ht,NearestMipmapNearestFilter:Us,NearestMipmapLinearFilter:Gs,LinearFilter:gt,LinearMipmapNearestFilter:Yu,LinearMipmapLinearFilter:ts};function uu(e){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ve.call(this,e),this.options=void 0}uu.prototype=Object.assign(Object.create(Ve.prototype),{constructor:uu,setOptions:function(t){return this.options=t,this},load:function(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var r=this,a=vr.get(e);if(a!==void 0)return r.manager.itemStart(e),setTimeout(function(){t&&t(a),r.manager.itemEnd(e)},0),a;fetch(e).then(function(o){return o.blob()}).then(function(o){return r.options===void 0?createImageBitmap(o):createImageBitmap(o,r.options)}).then(function(o){vr.add(e,o),t&&t(o),r.manager.itemEnd(e)}).catch(function(o){i&&i(o),r.manager.itemError(e),r.manager.itemEnd(e)}),r.manager.itemStart(e)}});function Mh(){this.type="ShapePath",this.color=new ee,this.subPaths=[],this.currentPath=null}Object.assign(Mh.prototype,{moveTo:function(e,t){return this.currentPath=new ln,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this},lineTo:function(e,t){return this.currentPath.lineTo(e,t),this},quadraticCurveTo:function(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this},bezierCurveTo:function(e,t,n,i,r,a){return this.currentPath.bezierCurveTo(e,t,n,i,r,a),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,t){function n(k){for(var V=[],te=0,$=k.length;te<$;te++){var X=k[te],Y=new pi;Y.curves=X.curves,V.push(Y)}return V}function i(k,V){for(var te=V.length,$=!1,X=te-1,Y=0;Y<te;X=Y++){var ie=V[X],Ue=V[Y],ze=Ue.x-ie.x,Be=Ue.y-ie.y;if(Math.abs(Be)>Number.EPSILON){if(Be<0&&(ie=V[Y],ze=-ze,Ue=V[X],Be=-Be),k.y<ie.y||k.y>Ue.y)continue;if(k.y===ie.y){if(k.x===ie.x)return!0}else{var Me=Be*(k.x-ie.x)-ze*(k.y-ie.y);if(Me===0)return!0;if(Me<0)continue;$=!$}}else{if(k.y!==ie.y)continue;if(Ue.x<=k.x&&k.x<=ie.x||ie.x<=k.x&&k.x<=Ue.x)return!0}}return $}var r=jn.isClockWise,a=this.subPaths;if(a.length===0)return[];if(t===!0)return n(a);var o,s,l,c=[];if(a.length===1)return s=a[0],l=new pi,l.curves=s.curves,c.push(l),c;var u=!r(a[0].getPoints());u=e?!u:u;var h=[],f=[],d=[],p=0,m;f[p]=void 0,d[p]=[];for(var v=0,y=a.length;v<y;v++)s=a[v],m=s.getPoints(),o=r(m),o=e?!o:o,o?(!u&&f[p]&&p++,f[p]={s:new pi,p:m},f[p].s.curves=s.curves,u&&p++,d[p]=[]):d[p].push({h:s,p:m[0]});if(!f[0])return n(a);if(f.length>1){for(var x=!1,w=[],S=0,b=f.length;S<b;S++)h[S]=[];for(var S=0,b=f.length;S<b;S++)for(var A=d[S],C=0;C<A.length;C++){for(var T=A[C],I=!0,D=0;D<f.length;D++)i(T.p,f[D].p)&&(S!==D&&w.push({froms:S,tos:D,hole:C}),I?(I=!1,h[D].push(T)):x=!0);I&&h[S].push(T)}w.length>0&&(x||(d=h))}for(var B,v=0,O=f.length;v<O;v++){l=f[v].s,c.push(l),B=d[v];for(var F=0,N=B.length;F<N;F++)l.holes.push(B[F].h)}return c}});function Sh(e){this.type="Font",this.data=e}Object.assign(Sh.prototype,{isFont:!0,generateShapes:function(e,t){t===void 0&&(t=100);for(var n=[],i=ty(e,t,this.data),r=0,a=i.length;r<a;r++)Array.prototype.push.apply(n,i[r].toShapes());return n}});function ty(e,t,n){for(var i=Array.from?Array.from(e):String(e).split(""),r=t/n.resolution,a=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*r,o=[],s=0,l=0,c=0;c<i.length;c++){var u=i[c];if(u===`
`)s=0,l-=a;else{var h=ny(u,r,s,l,n);s+=h.offsetX,o.push(h.path)}}return o}function ny(e,t,n,i,r){var a=r.glyphs[e]||r.glyphs["?"];if(!a){console.error('THREE.Font: character "'+e+'" does not exists in font family '+r.familyName+".");return}var o=new Mh,s,l,c,u,h,f,d,p;if(a.o)for(var m=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,y=m.length;v<y;){var x=m[v++];switch(x){case"m":s=m[v++]*t+n,l=m[v++]*t+i,o.moveTo(s,l);break;case"l":s=m[v++]*t+n,l=m[v++]*t+i,o.lineTo(s,l);break;case"q":c=m[v++]*t+n,u=m[v++]*t+i,h=m[v++]*t+n,f=m[v++]*t+i,o.quadraticCurveTo(h,f,c,u);break;case"b":c=m[v++]*t+n,u=m[v++]*t+i,h=m[v++]*t+n,f=m[v++]*t+i,d=m[v++]*t+n,p=m[v++]*t+i,o.bezierCurveTo(h,f,d,p,c,u);break}}return{offsetX:a.ha*t,path:o}}function hu(e){Ve.call(this,e)}hu.prototype=Object.assign(Object.create(Ve.prototype),{constructor:hu,load:function(e,t,n,i){var r=this,a=new fn(this.manager);a.setPath(this.path),a.load(e,function(o){var s;try{s=JSON.parse(o)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),s=JSON.parse(o.substring(65,o.length-2))}var l=r.parse(s);t&&t(l)},n,i)},parse:function(e){return new Sh(e)}});var eo,Eh={getContext:function(){return eo===void 0&&(eo=new(window.AudioContext||window.webkitAudioContext)),eo},setContext:function(e){eo=e}};function Cl(e){Ve.call(this,e)}Cl.prototype=Object.assign(Object.create(Ve.prototype),{constructor:Cl,load:function(e,t,n,i){var r=new fn(this.manager);r.setResponseType("arraybuffer"),r.setPath(this.path),r.load(e,function(a){var o=a.slice(0),s=Eh.getContext();s.decodeAudioData(o,function(l){t(l)})},n,i)}});function Yl(){this.coefficients=[];for(var e=0;e<9;e++)this.coefficients.push(new M)}Object.assign(Yl.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,t){var n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScale(a[1],.488603*i),t.addScale(a[2],.488603*r),t.addScale(a[3],.488603*n),t.addScale(a[4],1.092548*(n*i)),t.addScale(a[5],1.092548*(i*r)),t.addScale(a[6],.315392*(3*r*r-1)),t.addScale(a[7],1.092548*(n*r)),t.addScale(a[8],.546274*(n*n-i*i)),t},getIrradianceAt:function(e,t){var n=e.x,i=e.y,r=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScale(a[1],2*.511664*i),t.addScale(a[2],2*.511664*r),t.addScale(a[3],2*.511664*n),t.addScale(a[4],2*.429043*n*i),t.addScale(a[5],2*.429043*i*r),t.addScale(a[6],.743125*r*r-.247708),t.addScale(a[7],2*.429043*n*r),t.addScale(a[8],.429043*(n*n-i*i)),t},add:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this},scale:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this},lerp:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this},equals:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,t){t===void 0&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this},toArray:function(e,t){e===void 0&&(e=[]),t===void 0&&(t=0);for(var n=this.coefficients,i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}});Object.assign(Yl,{getBasisAt:function(e,t){var n=e.x,i=e.y,r=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*r,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*r,t[6]=.315392*(3*r*r-1),t[7]=1.092548*n*r,t[8]=.546274*(n*n-i*i)}});function un(e,t){Qe.call(this,void 0,t),this.sh=e!==void 0?e:new Yl}un.prototype=Object.assign(Object.create(Qe.prototype),{constructor:un,isLightProbe:!0,copy:function(e){return Qe.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){var t=Qe.prototype.toJSON.call(this,e);return t}});function fu(e,t,n){un.call(this,void 0,n);var i=new ee().set(e),r=new ee().set(t),a=new M(i.r,i.g,i.b),o=new M(r.r,r.g,r.b),s=Math.sqrt(Math.PI),l=s*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(o).multiplyScalar(s),this.sh.coefficients[1].copy(a).sub(o).multiplyScalar(l)}fu.prototype=Object.assign(Object.create(un.prototype),{constructor:fu,isHemisphereLightProbe:!0,copy:function(e){return un.prototype.copy.call(this,e),this},toJSON:function(e){var t=un.prototype.toJSON.call(this,e);return t}});function du(e,t){un.call(this,void 0,t);var n=new ee().set(e);this.sh.coefficients[0].set(n.r,n.g,n.b).multiplyScalar(2*Math.sqrt(Math.PI))}du.prototype=Object.assign(Object.create(un.prototype),{constructor:du,isAmbientLightProbe:!0,copy:function(e){return un.prototype.copy.call(this,e),this},toJSON:function(e){var t=un.prototype.toJSON.call(this,e);return t}});var pu=new Re,mu=new Re;function iy(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new ut,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new ut,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(iy.prototype,{update:function(e){var t=this._cache,n=t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep;if(n){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var i=e.projectionMatrix.clone(),r=t.eyeSep/2,a=r*t.near/t.focus,o=t.near*Math.tan(Le.DEG2RAD*t.fov*.5)/t.zoom,s,l;mu.elements[12]=-r,pu.elements[12]=r,s=-o*t.aspect+a,l=o*t.aspect+a,i.elements[0]=2*t.near/(l-s),i.elements[8]=(l+s)/(l-s),this.cameraL.projectionMatrix.copy(i),s=-o*t.aspect-a,l=o*t.aspect-a,i.elements[0]=2*t.near/(l-s),i.elements[8]=(l+s)/(l-s),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(mu),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(pu)}});function Zl(e){this.autoStart=e!==void 0?e:!0,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(Zl.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=(typeof performance>"u"?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}});var li=new M,vu=new Pt,ry=new M,ci=new M;function gu(){Q.call(this),this.type="AudioListener",this.context=Eh.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Zl}gu.prototype=Object.assign(Object.create(Q.prototype),{constructor:gu,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){Q.prototype.updateMatrixWorld.call(this,e);var t=this.context.listener,n=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(li,vu,ry),ci.set(0,0,-1).applyQuaternion(vu),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(li.x,i),t.positionY.linearRampToValueAtTime(li.y,i),t.positionZ.linearRampToValueAtTime(li.z,i),t.forwardX.linearRampToValueAtTime(ci.x,i),t.forwardY.linearRampToValueAtTime(ci.y,i),t.forwardZ.linearRampToValueAtTime(ci.z,i),t.upX.linearRampToValueAtTime(n.x,i),t.upY.linearRampToValueAtTime(n.y,i),t.upZ.linearRampToValueAtTime(n.z,i)}else t.setPosition(li.x,li.y,li.z),t.setOrientation(ci.x,ci.y,ci.z,n.x,n.y,n.z)}});function pa(e){Q.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}pa.prototype=Object.assign(Object.create(Q.prototype),{constructor:pa,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var ui=new M,yu=new Pt,ay=new M,hi=new M;function xu(e){pa.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}xu.prototype=Object.assign(Object.create(pa.prototype),{constructor:xu,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this},updateMatrixWorld:function(e){if(Q.prototype.updateMatrixWorld.call(this,e),!(this.hasPlaybackControl===!0&&this.isPlaying===!1)){this.matrixWorld.decompose(ui,yu,ay),hi.set(0,0,1).applyQuaternion(yu);var t=this.panner;if(t.positionX){var n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(ui.x,n),t.positionY.linearRampToValueAtTime(ui.y,n),t.positionZ.linearRampToValueAtTime(ui.z,n),t.orientationX.linearRampToValueAtTime(hi.x,n),t.orientationY.linearRampToValueAtTime(hi.y,n),t.orientationZ.linearRampToValueAtTime(hi.z,n)}else t.setPosition(ui.x,ui.y,ui.z),t.setOrientation(hi.x,hi.y,hi.z)}}});function Th(e,t){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t!==void 0?t:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}Object.assign(Th.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}});function Ah(e,t,n){this.binding=e,this.valueSize=n;var i=Float64Array,r;switch(t){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(n*4),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}Object.assign(Ah.prototype,{accumulate:function(e,t){var n=this.buffer,i=this.valueSize,r=e*i+i,a=this.cumulativeWeight;if(a===0){for(var o=0;o!==i;++o)n[r+o]=n[o];a=t}else{a+=t;var s=t/a;this._mixBufferRegion(n,r,0,s,i)}this.cumulativeWeight=a},apply:function(e){var t=this.valueSize,n=this.buffer,i=e*t+t,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=t*3;this._mixBufferRegion(n,i,o,1-r,t)}for(var s=t,l=t+t;s!==l;++s)if(n[s]!==n[s+t]){a.setValue(n,i);break}},saveOriginalState:function(){var e=this.binding,t=this.buffer,n=this.valueSize,i=n*3;e.getValue(t,i);for(var r=n,a=i;r!==a;++r)t[r]=t[i+r%n];this.cumulativeWeight=0},restoreOriginalState:function(){var e=this.valueSize*3;this.binding.setValue(this.buffer,e)},_select:function(e,t,n,i,r){if(i>=.5)for(var a=0;a!==r;++a)e[t+a]=e[n+a]},_slerp:function(e,t,n,i){Pt.slerpFlat(e,t,e,t,e,n,i)},_lerp:function(e,t,n,i,r){for(var a=1-i,o=0;o!==r;++o){var s=t+o;e[s]=e[s]*a+e[n+o]*i}}});var Jl="\\[\\]\\.:\\/",oy=new RegExp("["+Jl+"]","g"),$l="[^"+Jl+"]",sy="[^"+Jl.replace("\\.","")+"]",ly=/((?:WC+[\/:])*)/.source.replace("WC",$l),cy=/(WCOD+)?/.source.replace("WCOD",sy),uy=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",$l),hy=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",$l),fy=new RegExp("^"+ly+cy+uy+hy+"$"),dy=["material","materials","bones"];function Lh(e,t,n){var i=n||Lt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}Object.assign(Lh.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,i=this._targetGroup.nCachedObjects_,r=n.length;i!==r;++i)n[i].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}});function Lt(e,t,n){this.path=t,this.parsedPath=n||Lt.parseTrackName(t),this.node=Lt.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(Lt,{Composite:Lh,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Lt.Composite(e,t,n):new Lt(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(oy,"")},parseTrackName:function(e){var t=fy.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var r=n.nodeName.substring(i+1);dy.indexOf(r)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=r)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||t===""||t==="root"||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){var i=function(a){for(var o=0;o<a.length;o++){var s=a[o];if(s.name===t||s.uuid===t)return s;var l=i(s.children);if(l)return l}return null},r=i(e.children);if(r)return r}return null}});Object.assign(Lt.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,n){t[n]=this.node[this.propertyName]},function(t,n){for(var i=this.resolvedProperty,r=0,a=i.length;r!==a;++r)t[n++]=i[r]},function(t,n){t[n]=this.resolvedProperty[this.propertyIndex]},function(t,n){this.resolvedProperty.toArray(t,n)}],SetterByBindingTypeAndVersioning:[[function(t,n){this.targetObject[this.propertyName]=t[n]},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){for(var i=this.resolvedProperty,r=0,a=i.length;r!==a;++r)i[r]=t[n++]},function(t,n){for(var i=this.resolvedProperty,r=0,a=i.length;r!==a;++r)i[r]=t[n++];this.targetObject.needsUpdate=!0},function(t,n){for(var i=this.resolvedProperty,r=0,a=i.length;r!==a;++r)i[r]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty[this.propertyIndex]=t[n]},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,n){this.resolvedProperty.fromArray(t,n)},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0},function(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,n){this.bind(),this.getValue(t,n)},setValue:function(t,n){this.bind(),this.setValue(t,n)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,i=t.propertyName,r=t.propertyIndex;if(e||(e=Lt.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(n){var a=t.objectIndex;switch(n){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===a){a=o;break}break;default:if(e[n]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(a!==void 0){if(e[a]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[a]}}var s=e[i];if(s===void 0){var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+i+" but it wasn't found.",e);return}var c=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?c=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(r!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}for(var o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(e.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!e.geometry.morphTargets){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);return}for(var o=0;o<this.node.geometry.morphTargets.length;o++)if(e.geometry.morphTargets[o].name===r){r=o;break}}}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else s.fromArray!==void 0&&s.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=i;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}});//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(Lt.prototype,{_getValue_unbound:Lt.prototype.getValue,_setValue_unbound:Lt.prototype.setValue});function py(){this.uuid=Le.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var t=0,n=arguments.length;t!==n;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var i=this;this.stats={objects:{get total(){return i._objects.length},get inUse(){return this.total-i.nCachedObjects_}},get bindingsPerObject(){return i._bindings.length}}}Object.assign(py.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,l=void 0,c=0,u=arguments.length;c!==u;++c){var h=arguments[c],f=h.uuid,d=i[f];if(d===void 0){d=t++,i[f]=d,e.push(h);for(var p=0,m=s;p!==m;++p)o[p].push(new Lt(h,r[p],a[p]))}else if(d<n){l=e[d];var v=--n,y=e[v];i[y.uuid]=d,e[d]=y,i[f]=v,e[v]=h;for(var p=0,m=s;p!==m;++p){var x=o[p],w=x[v],S=x[d];x[d]=w,S===void 0&&(S=new Lt(h,r[p],a[p])),x[v]=S}}else e[d]!==l&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var e=this._objects,t=this.nCachedObjects_,n=this._indicesByUUID,i=this._bindings,r=i.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],l=s.uuid,c=n[l];if(c!==void 0&&c>=t){var u=t++,h=e[u];n[h.uuid]=c,e[c]=h,n[l]=u,e[u]=s;for(var f=0,d=r;f!==d;++f){var p=i[f],m=p[u],v=p[c];p[c]=m,p[u]=v}}}this.nCachedObjects_=t},uncache:function(){for(var e=this._objects,t=e.length,n=this.nCachedObjects_,i=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var l=arguments[o],c=l.uuid,u=i[c];if(u!==void 0)if(delete i[c],u<n){var h=--n,f=e[h],d=--t,p=e[d];i[f.uuid]=u,e[u]=f,i[p.uuid]=h,e[h]=p,e.pop();for(var m=0,v=a;m!==v;++m){var y=r[m],x=y[h],w=y[d];y[u]=x,y[h]=w,y.pop()}}else{var d=--t,p=e[d];i[p.uuid]=u,e[u]=p,e.pop();for(var m=0,v=a;m!==v;++m){var y=r[m];y[u]=y[d],y.pop()}}}this.nCachedObjects_=n},subscribe_:function(e,t){var n=this._bindingsIndicesByPath,i=n[e],r=this._bindings;if(i!==void 0)return r[i];var a=this._paths,o=this._parsedPaths,s=this._objects,l=s.length,c=this.nCachedObjects_,u=new Array(l);i=r.length,n[e]=i,a.push(e),o.push(t),r.push(u);for(var h=c,f=s.length;h!==f;++h){var d=s[h];u[h]=new Lt(d,e,t)}return u},unsubscribe_:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){var i=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o],l=e[o];t[l]=n,a[n]=s,a.pop(),r[n]=r[o],r.pop(),i[n]=i[o],i.pop()}}});function Ch(e,t,n){this._mixer=e,this._clip=t,this._localRoot=n||null;for(var i=t.tracks,r=i.length,a=new Array(r),o={endingStart:Ki,endingEnd:Ki},s=0;s!==r;++s){var l=i[s].createInterpolant(null);a[s]=l,l.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ud,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(Ch.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,t){return this.loop=e,this.repetitions=t,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var i=this._clip.duration,r=e._clip.duration,a=r/i,o=i/r;e.warp(1,a,t),this.warp(o,1,t)}return this},crossFadeTo:function(e,t,n){return e.crossFadeFrom(this,t,n)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,t,n){var i=this._mixer,r=i.time,a=this._timeScaleInterpolant,o=this.timeScale;a===null&&(a=i._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,l=a.sampleValues;return s[0]=r,s[1]=r+n,l[0]=e/o,l[1]=t/o,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}var r=this._startTime;if(r!==null){var a=(e-r)*n;if(a<0||n===0)return;this._startTime=null,t=n*a}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0)for(var l=this._interpolants,c=this._propertyBindings,u=0,h=l.length;u!==h;++u)l[u].evaluate(o),c[u].accumulate(i,s)},_updateWeight:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(n!==null){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t},_updateTimeScale:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(n!==null){var i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t},_updateTime:function(e){var t=this.time+e,n=this._clip.duration,i=this.loop,r=this._loopCount,a=i===hd;if(e===0)return r===-1?t:a&&(r&1)===1?n-t:t;if(i===cd){r===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(t>=n)t=n;else if(t<0)t=0;else{this.time=t;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(r===-1&&(e>=0?(r=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),t>=n||t<0){var o=Math.floor(t/n);t-=n*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,t=e>0?n:0,this.time=t,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(s===1){var l=e<0;this._setEndings(l,!l,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this.time=t,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=t;if(a&&(r&1)===1)return n-t}return t},_setEndings:function(e,t,n){var i=this._interpolantSettings;n?(i.endingStart=ji,i.endingEnd=ji):(e?i.endingStart=this.zeroSlopeAtStart?ji:Ki:i.endingStart=yo,t?i.endingEnd=this.zeroSlopeAtEnd?ji:Ki:i.endingEnd=yo)},_scheduleFading:function(e,t,n){var i=this._mixer,r=i.time,a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=t,o[1]=r+e,s[1]=n,this}});function _u(e){this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_u.prototype=Object.assign(Object.create(In.prototype),{constructor:_u,_bindAction:function(e,t){var n=e._localRoot||this._root,i=e._clip.tracks,r=i.length,a=e._propertyBindings,o=e._interpolants,s=n.uuid,l=this._bindingsByRootAndName,c=l[s];c===void 0&&(c={},l[s]=c);for(var u=0;u!==r;++u){var h=i[u],f=h.name,d=c[f];if(d!==void 0)a[u]=d;else{if(d=a[u],d!==void 0){d._cacheIndex===null&&(++d.referenceCount,this._addInactiveBinding(d,s,f));continue}var p=t&&t._propertyBindings[u].binding.parsedPath;d=new Ah(Lt.create(n,f,p),h.ValueTypeName,h.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,f),a[u]=d}o[u].resultBuffer=d.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,i=this._actionsByClip[n];this._bindAction(e,i&&i.knownActions[0]),this._addInactiveAction(e,n,t)}for(var r=e._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];--r.useCount===0&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var t=e._cacheIndex;return t!==null&&t<this._nActiveActions},_addInactiveAction:function(e,t,n){var i=this._actions,r=this._actionsByClip,a=r[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,r[t]=a;else{var o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e},_removeInactiveAction:function(e){var t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;var r=e._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,l=s[s.length-1],c=e._byClipCacheIndex;l._byClipCacheIndex=c,s[c]=l,s.pop(),e._byClipCacheIndex=null;var u=o.actionByRoot,h=(e._localRoot||this._root).uuid;delete u[h],s.length===0&&delete a[r],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var t=e._propertyBindings,n=0,i=t.length;n!==i;++n){var r=t[n];--r.referenceCount===0&&this._removeInactiveBinding(r)}},_lendAction:function(e){var t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackAction:function(e){var t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_addInactiveBinding:function(e,t,n){var i=this._bindingsByRootAndName,r=i[t],a=this._bindings;r===void 0&&(r={},i[t]=r),r[n]=e,e._cacheIndex=a.length,a.push(e)},_removeInactiveBinding:function(e){var t=this._bindings,n=e.binding,i=n.rootNode.uuid,r=n.path,a=this._bindingsByRootAndName,o=a[i],s=t[t.length-1],l=e._cacheIndex;s._cacheIndex=l,t[l]=s,t.pop(),delete o[r],Object.keys(o).length===0&&delete a[i]},_lendBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_takeBackBinding:function(e){var t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,r=t[i];e._cacheIndex=i,t[i]=e,r._cacheIndex=n,t[n]=r},_lendControlInterpolant:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return n===void 0&&(n=new Ho(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=t,e[t]=n),n},_takeBackControlInterpolant:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,r=t[i];e.__cacheIndex=i,t[i]=e,r.__cacheIndex=n,t[n]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,t){var n=t||this._root,i=n.uuid,r=typeof e=="string"?en.findByName(n,e):e,a=r!==null?r.uuid:e,o=this._actionsByClip[a],s=null;if(o!==void 0){var l=o.actionByRoot[i];if(l!==void 0)return l;s=o.knownActions[0],r===null&&(r=s._clip)}if(r===null)return null;var c=new Ch(this,r,t);return this._bindAction(c,s),this._addInactiveAction(c,a,i),c},existingAction:function(e,t){var n=t||this._root,i=n.uuid,r=typeof e=="string"?en.findByName(n,e):e,a=r?r.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null},stopAllAction:function(){var e=this._actions,t=this._nActiveActions,n=this._bindings,i=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==t;++r)e[r].reset();for(var r=0;r!==i;++r)n[r].useCount=0;return this},update:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,i=this.time+=e,r=Math.sign(e),a=this._accuIndex^=1,o=0;o!==n;++o){var s=t[o];s._update(i,e,r,a)}for(var l=this._bindings,c=this._nActiveBindings,o=0;o!==c;++o)l[o].apply(a);return this},setTime:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var t=this._actions,n=e.uuid,i=this._actionsByClip,r=i[n];if(r!==void 0){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var l=a[o];this._deactivateAction(l);var c=l._cacheIndex,u=t[t.length-1];l._cacheIndex=null,l._byClipCacheIndex=null,u._cacheIndex=c,t[c]=u,t.pop(),this._removeInactiveBindingsForAction(l)}delete i[n]}},uncacheRoot:function(e){var t=e.uuid,n=this._actionsByClip;for(var i in n){var r=n[i].actionByRoot,a=r[t];a!==void 0&&(this._deactivateAction(a),this._removeInactiveAction(a))}var o=this._bindingsByRootAndName,s=o[t];if(s!==void 0)for(var l in s){var c=s[l];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(e,t){var n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}});function Rl(e){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}Rl.prototype.clone=function(){return new Rl(this.value.clone===void 0?this.value:this.value.clone())};function wu(e,t,n){Zn.call(this,e,t),this.meshPerAttribute=n||1}wu.prototype=Object.assign(Object.create(Zn.prototype),{constructor:wu,isInstancedInterleavedBuffer:!0,copy:function(e){return Zn.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}});function my(e,t,n,i){this.ray=new xr(e,t),this.near=n||0,this.far=i||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function bu(e,t){return e.distance-t.distance}function Pl(e,t,n,i){if(e.visible!==!1&&(e.raycast(t,n),i===!0))for(var r=e.children,a=0,o=r.length;a<o;a++)Pl(r[a],t,n,!0)}Object.assign(my.prototype,{linePrecision:1,set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,t,n){var i=n||[];return Pl(e,this,i,t),i.sort(bu),i},intersectObjects:function(e,t,n){var i=n||[];if(Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var r=0,a=e.length;r<a;r++)Pl(e[r],this,i,t);return i.sort(bu),i}});function vy(e,t,n){return this.radius=e!==void 0?e:1,this.phi=t!==void 0?t:0,this.theta=n!==void 0?n:0,this}Object.assign(vy.prototype,{set:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Le.clamp(t/this.radius,-1,1))),this}});function gy(e,t,n){return this.radius=e!==void 0?e:1,this.theta=t!==void 0?t:0,this.y=n!==void 0?n:0,this}Object.assign(gy.prototype,{set:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}});var Mu=new U;function Rh(e,t){this.min=e!==void 0?e:new U(1/0,1/0),this.max=t!==void 0?t:new U(-1/0,-1/0)}Object.assign(Rh.prototype,{set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=Mu.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new U),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new U),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new U),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,t){return t===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new U),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){var t=Mu.copy(e).clamp(this.min,this.max);return t.sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Su=new M,to=new M;function Ph(e,t){this.start=e!==void 0?e:new M,this.end=t!==void 0?t:new M}Object.assign(Ph.prototype,{set:function(e,t){return this.start.copy(e),this.end.copy(t),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new M),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new M),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,t){return t===void 0&&(console.warn("THREE.Line3: .at() target is now required"),t=new M),this.delta(t).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,t){Su.subVectors(e,this.start),to.subVectors(this.end,this.start);var n=to.dot(to),i=to.dot(Su),r=i/n;return t&&(r=Le.clamp(r,0,1)),r},closestPointToPoint:function(e,t,n){var i=this.closestPointToPointParameter(e,t);return n===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new M),this.delta(n).multiplyScalar(i).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});function qo(e){Q.call(this),this.material=e,this.render=function(){}}qo.prototype=Object.create(Q.prototype);qo.prototype.constructor=qo;qo.prototype.isImmediateRenderObject=!0;var Eu=new M;function ma(e,t){Q.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t;for(var n=new ne,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1,o=32;r<o;r++,a++){var s=r/o*Math.PI*2,l=a/o*Math.PI*2;i.push(Math.cos(s),Math.sin(s),1,Math.cos(l),Math.sin(l),1)}n.setAttribute("position",new K(i,3));var c=new lt({fog:!1});this.cone=new ft(n,c),this.add(this.cone),this.update()}ma.prototype=Object.create(Q.prototype);ma.prototype.constructor=ma;ma.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()};ma.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Eu.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Eu),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Bn=new M,no=new Re,Ns=new Re;function Ih(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,Ih(e.children[n]));return t}function va(e){for(var t=Ih(e),n=new ne,i=[],r=[],a=new ee(0,0,1),o=new ee(0,1,0),s=0;s<t.length;s++){var l=t[s];l.parent&&l.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}n.setAttribute("position",new K(i,3)),n.setAttribute("color",new K(r,3));var c=new lt({vertexColors:ba,depthTest:!1,depthWrite:!1,transparent:!0});ft.call(this,n,c),this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}va.prototype=Object.create(ft.prototype);va.prototype.constructor=va;va.prototype.updateMatrixWorld=function(e){var t=this.bones,n=this.geometry,i=n.getAttribute("position");Ns.getInverse(this.root.matrixWorld);for(var r=0,a=0;r<t.length;r++){var o=t[r];o.parent&&o.parent.isBone&&(no.multiplyMatrices(Ns,o.matrixWorld),Bn.setFromMatrixPosition(no),i.setXYZ(a,Bn.x,Bn.y,Bn.z),no.multiplyMatrices(Ns,o.parent.matrixWorld),Bn.setFromMatrixPosition(no),i.setXYZ(a+1,Bn.x,Bn.y,Bn.z),a+=2)}n.getAttribute("position").needsUpdate=!0,Q.prototype.updateMatrixWorld.call(this,e)};function ga(e,t,n){this.light=e,this.light.updateMatrixWorld(),this.color=n;var i=new or(t,4,2),r=new tn({wireframe:!0,fog:!1});et.call(this,i,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}ga.prototype=Object.create(et.prototype);ga.prototype.constructor=ga;ga.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()};ga.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var yy=new M,Tu=new ee,Au=new ee;function ya(e,t,n){Q.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var i=new ir(t);i.rotateY(Math.PI*.5),this.material=new tn({wireframe:!0,fog:!1}),this.color===void 0&&(this.material.vertexColors=ba);var r=i.getAttribute("position"),a=new Float32Array(r.count*3);i.setAttribute("color",new _e(a,3)),this.add(new et(i,this.material)),this.update()}ya.prototype=Object.create(Q.prototype);ya.prototype.constructor=ya;ya.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()};ya.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");Tu.copy(this.light.color),Au.copy(this.light.groundColor);for(var n=0,i=t.count;n<i;n++){var r=n<i/2?Tu:Au;t.setXYZ(n,r.r,r.g,r.b)}t.needsUpdate=!0}e.lookAt(yy.setFromMatrixPosition(this.light.matrixWorld).negate())};function Il(e,t,n,i){e=e||10,t=t||10,n=new ee(n!==void 0?n:4473924),i=new ee(i!==void 0?i:8947848);for(var r=t/2,a=e/t,o=e/2,s=[],l=[],c=0,u=0,h=-o;c<=t;c++,h+=a){s.push(-o,0,h,o,0,h),s.push(h,0,-o,h,0,o);var f=c===r?n:i;f.toArray(l,u),u+=3,f.toArray(l,u),u+=3,f.toArray(l,u),u+=3,f.toArray(l,u),u+=3}var d=new ne;d.setAttribute("position",new K(s,3)),d.setAttribute("color",new K(l,3));var p=new lt({vertexColors:ba});ft.call(this,d,p)}Il.prototype=Object.assign(Object.create(ft.prototype),{constructor:Il,copy:function(e){return ft.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}});function Dl(e,t,n,i,r,a){e=e||10,t=t||16,n=n||8,i=i||64,r=new ee(r!==void 0?r:4473924),a=new ee(a!==void 0?a:8947848);var o=[],s=[],l,c,u,h,f,d,p;for(h=0;h<=t;h++)u=h/t*(Math.PI*2),l=Math.sin(u)*e,c=Math.cos(u)*e,o.push(0,0,0),o.push(l,0,c),p=h&1?r:a,s.push(p.r,p.g,p.b),s.push(p.r,p.g,p.b);for(h=0;h<=n;h++)for(p=h&1?r:a,d=e-e/n*h,f=0;f<i;f++)u=f/i*(Math.PI*2),l=Math.sin(u)*d,c=Math.cos(u)*d,o.push(l,0,c),s.push(p.r,p.g,p.b),u=(f+1)/i*(Math.PI*2),l=Math.sin(u)*d,c=Math.cos(u)*d,o.push(l,0,c),s.push(p.r,p.g,p.b);var m=new ne;m.setAttribute("position",new K(o,3)),m.setAttribute("color",new K(s,3));var v=new lt({vertexColors:ba});ft.call(this,m,v)}Dl.prototype=Object.create(ft.prototype);Dl.prototype.constructor=Dl;var Lu=new M,io=new M,Cu=new M;function xa(e,t,n){Q.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,t===void 0&&(t=1);var i=new ne;i.setAttribute("position",new K([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));var r=new lt({fog:!1});this.lightPlane=new Wt(i,r),this.add(this.lightPlane),i=new ne,i.setAttribute("position",new K([0,0,0,0,0,1],3)),this.targetLine=new Wt(i,r),this.add(this.targetLine),this.update()}xa.prototype=Object.create(Q.prototype);xa.prototype.constructor=xa;xa.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()};xa.prototype.update=function(){Lu.setFromMatrixPosition(this.light.matrixWorld),io.setFromMatrixPosition(this.light.target.matrixWorld),Cu.subVectors(io,Lu),this.lightPlane.lookAt(io),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(io),this.targetLine.scale.z=Cu.length()};var ro=new M,it=new Tn;function Xo(e){var t=new ne,n=new lt({color:16777215,vertexColors:of}),i=[],r=[],a={},o=new ee(16755200),s=new ee(16711680),l=new ee(43775),c=new ee(16777215),u=new ee(3355443);h("n1","n2",o),h("n2","n4",o),h("n4","n3",o),h("n3","n1",o),h("f1","f2",o),h("f2","f4",o),h("f4","f3",o),h("f3","f1",o),h("n1","f1",o),h("n2","f2",o),h("n3","f3",o),h("n4","f4",o),h("p","n1",s),h("p","n2",s),h("p","n3",s),h("p","n4",s),h("u1","u2",l),h("u2","u3",l),h("u3","u1",l),h("c","t",c),h("p","c",u),h("cn1","cn2",u),h("cn3","cn4",u),h("cf1","cf2",u),h("cf3","cf4",u);function h(d,p,m){f(d,m),f(p,m)}function f(d,p){i.push(0,0,0),r.push(p.r,p.g,p.b),a[d]===void 0&&(a[d]=[]),a[d].push(i.length/3-1)}t.setAttribute("position",new K(i,3)),t.setAttribute("color",new K(r,3)),ft.call(this,t,n),this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}Xo.prototype=Object.create(ft.prototype);Xo.prototype.constructor=Xo;Xo.prototype.update=function(){var e=this.geometry,t=this.pointMap,n=1,i=1;it.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),at("c",t,e,it,0,0,-1),at("t",t,e,it,0,0,1),at("n1",t,e,it,-n,-i,-1),at("n2",t,e,it,n,-i,-1),at("n3",t,e,it,-n,i,-1),at("n4",t,e,it,n,i,-1),at("f1",t,e,it,-n,-i,1),at("f2",t,e,it,n,-i,1),at("f3",t,e,it,-n,i,1),at("f4",t,e,it,n,i,1),at("u1",t,e,it,n*.7,i*1.1,-1),at("u2",t,e,it,-n*.7,i*1.1,-1),at("u3",t,e,it,0,i*2,-1),at("cf1",t,e,it,-n,0,1),at("cf2",t,e,it,n,0,1),at("cf3",t,e,it,0,-i,1),at("cf4",t,e,it,0,i,1),at("cn1",t,e,it,-n,0,-1),at("cn2",t,e,it,n,0,-1),at("cn3",t,e,it,0,-i,-1),at("cn4",t,e,it,0,i,-1),e.getAttribute("position").needsUpdate=!0};function at(e,t,n,i,r,a,o){ro.set(r,a,o).unproject(i);var s=t[e];if(s!==void 0)for(var l=n.getAttribute("position"),c=0,u=s.length;c<u;c++)l.setXYZ(s[c],ro.x,ro.y,ro.z)}var ao=new yn;function wi(e,t){this.object=e,t===void 0&&(t=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),r=new ne;r.setIndex(new _e(n,1)),r.setAttribute("position",new _e(i,3)),ft.call(this,r,new lt({color:t})),this.matrixAutoUpdate=!1,this.update()}wi.prototype=Object.create(ft.prototype);wi.prototype.constructor=wi;wi.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&ao.setFromObject(this.object),!ao.isEmpty()){var t=ao.min,n=ao.max,i=this.geometry.attributes.position,r=i.array;r[0]=n.x,r[1]=n.y,r[2]=n.z,r[3]=t.x,r[4]=n.y,r[5]=n.z,r[6]=t.x,r[7]=t.y,r[8]=n.z,r[9]=n.x,r[10]=t.y,r[11]=n.z,r[12]=n.x,r[13]=n.y,r[14]=t.z,r[15]=t.x,r[16]=n.y,r[17]=t.z,r[18]=t.x,r[19]=t.y,r[20]=t.z,r[21]=n.x,r[22]=t.y,r[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}};wi.prototype.setFromObject=function(e){return this.object=e,this.update(),this};wi.prototype.copy=function(e){return ft.prototype.copy.call(this,e),this.object=e.object,this};wi.prototype.clone=function(){return new this.constructor().copy(this)};function Yo(e,t){this.type="Box3Helper",this.box=e,t=t||16776960;var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],r=new ne;r.setIndex(new _e(n,1)),r.setAttribute("position",new K(i,3)),ft.call(this,r,new lt({color:t})),this.geometry.computeBoundingSphere()}Yo.prototype=Object.create(ft.prototype);Yo.prototype.constructor=Yo;Yo.prototype.updateMatrixWorld=function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Q.prototype.updateMatrixWorld.call(this,e))};function Zo(e,t,n){this.type="PlaneHelper",this.plane=e,this.size=t===void 0?1:t;var i=n!==void 0?n:16776960,r=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],a=new ne;a.setAttribute("position",new K(r,3)),a.computeBoundingSphere(),Wt.call(this,a,new lt({color:i}));var o=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],s=new ne;s.setAttribute("position",new K(o,3)),s.computeBoundingSphere(),this.add(new et(s,new tn({color:i,opacity:.2,transparent:!0,depthWrite:!1})))}Zo.prototype=Object.create(Wt.prototype);Zo.prototype.constructor=Zo;Zo.prototype.updateMatrixWorld=function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?mt:wa,this.lookAt(this.plane.normal),Q.prototype.updateMatrixWorld.call(this,e)};var Ru=new M,oo,Fs;function Qn(e,t,n,i,r,a){Q.call(this),e===void 0&&(e=new M(0,0,1)),t===void 0&&(t=new M(0,0,0)),n===void 0&&(n=1),i===void 0&&(i=16776960),r===void 0&&(r=.2*n),a===void 0&&(a=.2*r),oo===void 0&&(oo=new ne,oo.setAttribute("position",new K([0,0,0,0,1,0],3)),Fs=new Jn(0,.5,1,5,1),Fs.translate(0,-.5,0)),this.position.copy(t),this.line=new Wt(oo,new lt({color:i})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new et(Fs,new tn({color:i})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,r,a)}Qn.prototype=Object.create(Q.prototype);Qn.prototype.constructor=Qn;Qn.prototype.setDirection=function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Ru.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(Ru,t)}};Qn.prototype.setLength=function(e,t,n){t===void 0&&(t=.2*e),n===void 0&&(n=.2*t),this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()};Qn.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)};Qn.prototype.copy=function(e){return Q.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this};Qn.prototype.clone=function(){return new this.constructor().copy(this)};function Ol(e){e=e||1;var t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new ne;i.setAttribute("position",new K(t,3)),i.setAttribute("color",new K(n,3));var r=new lt({vertexColors:ba});ft.call(this,i,r)}Ol.prototype=Object.create(ft.prototype);Ol.prototype.constructor=Ol;var $i=4,qn=8,cn=Math.pow(2,qn),Dh=[.125,.215,.35,.446,.526,.582],Oh=qn-$i+1+Dh.length,Wi=20,gn={[Ft]:0,[Wl]:1,[jl]:2,[$u]:3,[Ku]:4,[Qu]:5,[Ju]:6},Kl=new da,Jo=by(Wi),zn=null,Un=null,{_lodPlanes:_a,_sizeLods:Pu,_sigmas:so}=xy(),$o=null,Ye=null,Nl=null,fi=(1+Math.sqrt(5))/2,Vi=1/fi,Iu=[new M(1,1,1),new M(-1,1,1),new M(1,1,-1),new M(-1,1,-1),new M(0,fi,Vi),new M(0,fi,-Vi),new M(Vi,0,fi),new M(-Vi,0,fi),new M(fi,Vi,0),new M(-fi,Vi,0)];function Du(e){Ye=e,Fl(Jo)}Du.prototype={constructor:Du,fromScene:function(e,t=0,n=.1,i=100){Nl=Ye.getRenderTarget();var r=Ou();return _y(e,n,i,r),t>0&&Nh(r,0,0,t),Bu(r),Nu(r),r},fromEquirectangular:function(e){return e.magFilter=ht,e.minFilter=ht,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){Nl=Ye.getRenderTarget();var t=Ou(e);return wy(e,t),Bu(t),Nu(t),t},compileCubemapShader:function(){Un==null&&(Un=Bh(),Fl(Un))},compileEquirectangularShader:function(){zn==null&&(zn=Fh(),Fl(zn))},dispose:function(){Jo.dispose(),Un!=null&&Un.dispose(),zn!=null&&zn.dispose();for(var e=0;e<_a.length;e++)_a[e].dispose()}};function xy(){for(var e=[],t=[],n=[],i=qn,r=0;r<Oh;r++){var a=Math.pow(2,i);t.push(a);var o=1/a;r>qn-$i?o=Dh[r-qn+$i-1]:r==0&&(o=0),n.push(o);for(var s=1/(a-1),l=-s/2,c=1+s/2,u=[l,l,c,l,c,c,l,l,c,c,l,c],h=6,f=6,d=3,p=2,m=1,v=new Float32Array(d*f*h),y=new Float32Array(p*f*h),x=new Float32Array(m*f*h),w=0;w<h;w++){var S=w%3*2/3-1,b=w>2?0:-1,A=[S,b,0,S+2/3,b,0,S+2/3,b+1,0,S,b,0,S+2/3,b+1,0,S,b+1,0];v.set(A,d*f*w),y.set(u,p*f*w);var C=[w,w,w,w,w,w];x.set(C,m*f*w)}var T=new ne;T.setAttribute("position",new _e(v,d)),T.setAttribute("uv",new _e(y,p)),T.setAttribute("faceIndex",new _e(x,m)),e.push(T),i>$i&&i--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function Ou(e){var t={magFilter:ht,minFilter:ht,generateMipmaps:!1,type:e?e.type:ns,format:e?e.format:Gf,encoding:e?e.encoding:jl,depthBuffer:!1,stencilBuffer:!1},n=Fu(t);return n.depthBuffer=!e,$o=Fu(t),n}function Nu(e){$o.dispose(),Ye.setRenderTarget(Nl),e.scissorTest=!1,e.setSize(e.width,e.height)}function _y(e,t,n,i){var r=90,a=1,o=new ut(r,a,t,n),s=[1,1,1,1,-1,1],l=[1,1,-1,-1,-1,1],c=Ye.outputEncoding,u=Ye.toneMapping,h=Ye.toneMappingExposure,f=Ye.getClearColor(),d=Ye.getClearAlpha();Ye.toneMapping=Bl,Ye.toneMappingExposure=1,Ye.outputEncoding=Ft,e.scale.z*=-1;var p=e.background;if(p&&p.isColor){p.convertSRGBToLinear();var m=Math.max(p.r,p.g,p.b),v=Math.min(Math.max(Math.ceil(Math.log2(m)),-128),127);p=p.multiplyScalar(Math.pow(2,-v));var y=(v+128)/255;Ye.setClearColor(p,y),e.background=null}for(var x=0;x<6;x++){var w=x%3;w==0?(o.up.set(0,s[x],0),o.lookAt(l[x],0,0)):w==1?(o.up.set(0,0,s[x]),o.lookAt(0,l[x],0)):(o.up.set(0,s[x],0),o.lookAt(0,0,l[x])),Ql(i,w*cn,x>2?cn:0,cn,cn),Ye.setRenderTarget(i),Ye.render(e,o)}Ye.toneMapping=u,Ye.toneMappingExposure=h,Ye.outputEncoding=c,Ye.setClearColor(f,d),e.scale.z*=-1}function wy(e,t){var n=new En;e.isCubeTexture?Un==null&&(Un=Bh()):zn==null&&(zn=Fh());var i=e.isCubeTexture?Un:zn;n.add(new et(_a[0],i));var r=i.uniforms;r.envMap.value=e,e.isCubeTexture||r.texelSize.value.set(1/e.image.width,1/e.image.height),r.inputEncoding.value=gn[e.encoding],r.outputEncoding.value=gn[e.encoding],Ql(t,0,0,3*cn,2*cn),Ye.setRenderTarget(t),Ye.render(n,Kl)}function Fl(e){var t=new En;t.add(new et(_a[0],e)),Ye.compile(t,Kl)}function Fu(e){var t=new At(3*cn,3*cn,e);return t.texture.mapping=Ma,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function Ql(e,t,n,i,r){e.viewport.set(t,n,i,r),e.scissor.set(t,n,i,r)}function Bu(e){var t=Ye.autoClear;Ye.autoClear=!1;for(var n=1;n<Oh;n++){var i=Math.sqrt(so[n]*so[n]-so[n-1]*so[n-1]),r=Iu[(n-1)%Iu.length];Nh(e,n-1,n,i,r)}Ye.autoClear=t}function Nh(e,t,n,i,r){ku(e,$o,t,n,i,"latitudinal",r),ku($o,e,n,n,i,"longitudinal",r)}function ku(e,t,n,i,r,a,o){a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var s=3,l=new En;l.add(new et(_a[i],Jo));var c=Jo.uniforms,u=Pu[n]-1,h=isFinite(r)?Math.PI/(2*u):2*Math.PI/(2*Wi-1),f=r/h,d=isFinite(r)?1+Math.floor(s*f):Wi;d>Wi&&console.warn(`sigmaRadians, ${r}, is too large and will clip, as it requested ${d} samples when the maximum is set to ${Wi}`);for(var p=[],m=0,v=0;v<Wi;++v){var w=v/f,y=Math.exp(-w*w/2);p.push(y),v==0?m+=y:v<d&&(m+=2*y)}for(var v=0;v<p.length;v++)p[v]=p[v]/m;c.envMap.value=e.texture,c.samples.value=d,c.weights.value=p,c.latitudinal.value=a==="latitudinal",o&&(c.poleAxis.value=o),c.dTheta.value=h,c.mipInt.value=qn-n,c.inputEncoding.value=gn[e.texture.encoding],c.outputEncoding.value=gn[e.texture.encoding];var x=Pu[i],w=3*Math.max(0,cn-2*x),S=(i===0?0:2*cn)+2*x*(i>qn-$i?i-qn+$i:0);Ql(t,w,S,3*x,2*x),Ye.setRenderTarget(t),Ye.render(l,Kl)}function by(e){var t=new Float32Array(e),n=new M(0,1,0),i=new $n({defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:gn[Ft]},outputEncoding:{value:gn[Ft]}},vertexShader:ec(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

${tc()}

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

void main() {
	gl_FragColor = vec4(0.0);
	for (int i = 0; i < n; i++) {
		if (i >= samples)
			break;
		for (int dir = -1; dir < 2; dir += 2) {
			if (i == 0 && dir == 1)
				continue;
			vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
			if (all(equal(axis, vec3(0.0))))
				axis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);
			axis = normalize(axis);
			float theta = dTheta * float(dir * i);
			float cosTheta = cos(theta);
			// Rodrigues' axis-angle rotation
			vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross(axis, vOutputDirection) * sin(theta)
					+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
			gl_FragColor.rgb +=
					weights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);
		}
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Hn,depthTest:!1,depthWrite:!1});return i.type="SphericalGaussianBlur",i}function Fh(){var e=new U(1,1),t=new $n({uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:gn[Ft]},outputEncoding:{value:gn[Ft]}},vertexShader:ec(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

${tc()}

#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv;
	uv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;
	uv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Hn,depthTest:!1,depthWrite:!1});return t.type="EquirectangularToCubeUV",t}function Bh(){var e=new $n({uniforms:{envMap:{value:null},inputEncoding:{value:gn[Ft]},outputEncoding:{value:gn[Ft]}},vertexShader:ec(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

${tc()}

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:Hn,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function ec(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx;
		direction.z *= -1.0;
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.z *= -1.0;
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.x *= -1.0;
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.y *= -1.0;
	} else if (face == 5.0) {
		direction.xz *= -1.0;
	}
	return direction;
}
void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function tc(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}fe.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(fe.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e};Object.assign(Vn.prototype,{createPointsGeometry:function(e){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getPoints(e);return this.createGeometry(t)},createSpacedPointsGeometry:function(e){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var t=this.getSpacedPoints(e);return this.createGeometry(t)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var t=new we,n=0,i=e.length;n<i;n++){var r=e[n];t.vertices.push(new M(r.x,r.y,r.z||0))}return t}});Object.assign(ln.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}});Object.create(zt.prototype);Object.create(zt.prototype);function kh(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),zt.call(this,e),this.type="catmullrom"}kh.prototype=Object.create(zt.prototype);Object.assign(kh.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}});Il.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")};va.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};Object.assign(Ve.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),bh.extractUrlBase(e)}});Ve.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};Object.assign(Ll.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}});Object.assign(Rh.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}});Object.assign(yn.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}});Sa.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)};Ph.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)};Object.assign(Le,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Le.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Le.ceilPowerOfTwo(e)}});Object.assign(bt.prototype,{flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}});Object.assign(Re.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new M().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,t,n,i,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,i,n,r,a)}});sn.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)};Pt.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)};Object.assign(xr.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}});Object.assign(xt.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}});Object.assign(xt,{barycoordFromPoint:function(e,t,n,i,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),xt.getBarycoord(e,t,n,i,r)},normal:function(e,t,n,i){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),xt.getNormal(e,t,n,i)}});Object.assign(pi.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ar(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new sr(this,e)}});Object.assign(U.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(M.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(Ze.prototype,{fromAttribute:function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}});Object.assign(we.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}});Object.assign(Q.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}});Object.defineProperties(Q.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}});Object.assign(et.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}});Object.defineProperties(et.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),fd},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}});Object.defineProperties(wo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}});Object.defineProperty(el.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}});bo.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")};Object.defineProperty(fe.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}});ut.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),t!==void 0&&(this.filmGauge=t),this.setFocalLength(e)};Object.defineProperties(Qe.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}});Object.defineProperties(_e.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ur},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ur)}}});Object.assign(_e.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?Ur:is),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(ne.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(t&&t.isBufferAttribute)&&!(t&&t.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new _e(arguments[1],arguments[2]))):e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t)},addDrawCall:function(e,t,n){n!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}});Object.defineProperties(ne.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}});Object.defineProperties(Zn.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Ur},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}});Object.assign(Zn.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?Ur:is),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}});Object.assign(An.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}});Object.defineProperties(Rl.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}});Object.defineProperties(xe.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new ee}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===Vu}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}});Object.defineProperties(_i.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}});Object.defineProperties(Rt.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}});Object.assign(ql.prototype,{clearTarget:function(e,t,n,i){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,i)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}});Object.defineProperties(ql.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?Wl:Ft}}});Object.defineProperties(dh.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});Object.defineProperties(At.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}});Object.defineProperties(pa.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this,n=new Cl;return n.load(e,function(i){t.setBuffer(i)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}});Th.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()};Hr.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)};Xn.crossOrigin=void 0;Xn.loadTexture=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new pl;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a};Xn.loadTextureCube=function(e,t,n,i){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new dl;r.setCrossOrigin(this.crossOrigin);var a=r.load(e,n,void 0,i);return t&&(a.mapping=t),a};Xn.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")};Xn.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:tf}}));const My={mounted(){var e,t,n,i,r,a,o,s,l,c,u,h,f,d;p(),m();async function p(){o=new Zl,n=new ql({alpha:!0}),n.setClearColor(0,.1),n.setSize(window.innerWidth,window.innerHeight),t=new En;var x=new jo(16777215);for(t.add(x),e=new ut(75,window.innerWidth/window.innerHeight,1,1e4),e.position.z=1e3,t.add(e),i=new ah(200,200,200),r=new Kn({color:16305034,wireframe:!1}),a=new et(i,r),s=0,l=Xn.loadTexture("images/smoke.png"),c=new Kn({color:16305034,opacity:.15,map:l,transparent:!0}),u=new Wr(300,300),h=[],f=0;f<150;f++){var w=new et(u,c);w.position.set(Math.random()*500-250,Math.random()*500-250,Math.random()*1e3-100),w.rotation.z=Math.random()*360,t.add(w),h.push(w)}document.getElementById("smoke").appendChild(n.domElement)}function m(){d=o.getDelta(),requestAnimationFrame(m),v(),y()}function v(){for(var x=h.length;x--;)h[x].rotation.z+=d*.2}function y(){a.rotation.x+=.005,a.rotation.y+=.01,s+=.01,a.position.z=100+Math.sin(s)*500,n.render(t,e)}}},Sy={id:"home"},Ey=Ko('<div id="hero"></div><div class="container tagline"><h2 class="banner">software engineering manager at ny public radio</h2><h2 class="banner">co-founder at equal time</h2></div><a href="#what" tabindex="0" class="scroll-down" aria-label="scroll down past hero image"></a><div id="smoke"></div>',4),Ty=[Ey];function Ay(e,t,n,i,r,a){return Ke(),st("section",Sy,Ty)}const Ly=nn(My,[["render",Ay]]);const Cy={name:"Card",props:{title:{type:String,default:""},image:{type:String,default:""},description:{type:String,default:""}},computed:{hasImage(){return!!this.$props.image}}},Ry={class:"card"},Py=["src","alt"],Iy=["innerHTML"];function Dy(e,t,n,i,r,a){return Ke(),st("div",Ry,[Te("figure",null,[a.hasImage?(Ke(),st("img",{key:0,src:n.image,alt:n.title,class:kn({"mb-4":a.hasImage})},null,10,Py)):Gn("",!0),Te("figcaption",null,Bs(n.title),1)]),Te("p",{innerHTML:n.description,class:kn({"ml-3 lg:mr-5":!a.hasImage})},null,10,Iy)])}const zh=nn(Cy,[["render",Dy]]);const Oy={},Ny={id:"what"},Fy={class:"container pt-4 pb-6 lg:py-8"},By=Te("h2",{class:"mb-6"},"I build creative websites from top to bottom.",-1),ky={class:"grid"},zy={class:"col col col-12 lg:col-6 mb-6"},Uy={class:"col col-12 lg:col-6 mb-6"},Gy={class:"col col-12 lg:col-6 mb-6"},Vy={class:"col col-12 lg:col-6 mb-6"};function Hy(e,t){const n=zh;return Ke(),st("section",Ny,[Te("div",Fy,[By,Te("div",ky,[Te("div",zy,[vt(n,{class:"lg:pr-3",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584805653/kimlarocca/portfolio/design_lkttxc.jpg",title:"design",description:"I like to think of myself as an 'ultra stack' developer (yes, I made that up). I design award winning, tech driven websites with modern trends in mind."})]),Te("div",Uy,[vt(n,{class:"lg:pl-3",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584805653/kimlarocca/portfolio/develop_nzzwpu.jpg",title:"develop",description:"Until 'ultra stack' becomes a thing, I'm just an artsy full stack developer who likes to create beautiful responsive websites and is comfortable working on both the frontend and the backend."})]),Te("div",Gy,[vt(n,{class:"lg:pr-3",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584805653/kimlarocca/portfolio/test_wvh7wq.jpg",title:"test",description:"Between end-to-end testing, unit testing, automation, and good old-fashioned eyeballs on real devices, my websites are about as close to perfect as you can get."})]),Te("div",Vy,[vt(n,{class:"lg:pl-3",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584805653/kimlarocca/portfolio/deploy_pfrsq9.jpg",title:"deploy",description:"Need DevOps? Whether it's building servers or setting up continuous integration, I'll create and maintain your application environments wherever they may be."})])])])])}const Wy=nn(Oy,[["render",Hy]]),jy=Qh({name:"Head",inheritAttrs:!1,setup:(e,t)=>()=>{var n,i;return(i=(n=t.slots).default)==null?void 0:i.call(n)}}),qy={props:{size:{type:String,default:"1rem"}}};function Xy(e,t,n,i,r,a){return Ke(),st("div",{style:zu("padding-bottom: "+n.size)},null,4)}const nc=nn(qy,[["render",Xy]]);const Yy={data(){return{portfolioItemShow:!1}},props:{title:{type:String,default:""},image:{type:String,default:""},description:{type:String,default:""},backgroundImage:{type:String,default:""},vimeo:{type:String,default:""}}},Zy={class:"banner"},Jy=Te("div",{class:"grid-x grid-margin-x grid-margin-y"},[Te("div",{class:"cell"})],-1),$y={key:0,class:"portfolio-item-details"},Ky={class:"container"},Qy={class:"mb-6"},e0={key:0,class:"mb-6",style:{padding:"56.25% 0 0 0",position:"relative"}},t0=["src"],n0=["src","alt"],i0=["innerHTML"];function r0(e,t,n,i,r,a){const o=ef("Script"),s=jy,l=nc;return Ke(),st("div",{onClick:t[3]||(t[3]=c=>r.portfolioItemShow=!0),onKeypress:[t[4]||(t[4]=pt(c=>r.portfolioItemShow=!0,["enter"])),t[5]||(t[5]=pt(Qt(c=>r.portfolioItemShow=!0,["prevent"]),["space"]))],tabindex:"0",class:"portfolio-item",style:zu({backgroundImage:`url('${n.backgroundImage}')`})},[vt(s,null,{default:uo(()=>[n.vimeo!==""?(Ke(),ho(o,{key:0,src:"https://player.vimeo.com/api/player.js"})):Gn("",!0)]),_:1}),Te("div",null,[Te("h2",Zy,Bs(n.title),1)]),Jy,vt(ks,{name:"slide-fade"},{default:uo(()=>[r.portfolioItemShow?(Ke(),st("div",$y,[vt(l,{size:"3rem"}),Te("div",Ky,[Te("div",{tabindex:"0",onClick:t[0]||(t[0]=Qt(c=>r.portfolioItemShow=!r.portfolioItemShow,["stop"])),onKeypress:[t[1]||(t[1]=pt(Qt(c=>r.portfolioItemShow=!r.portfolioItemShow,["stop"]),["enter"])),t[2]||(t[2]=pt(Qt(c=>r.portfolioItemShow=!r.portfolioItemShow,["stop","prevent"]),["space"]))],class:"portfolio-item-close"}," X ",32),Te("h3",Qy,Bs(n.title),1),n.vimeo!==""?(Ke(),st("div",e0,[Te("iframe",{src:n.vimeo,frameborder:"0",allow:"autoplay; fullscreen; picture-in-picture; clipboard-write",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%"},title:"Kim LaRocca | Portfolio Video"},null,8,t0)])):Gn("",!0),n.image?(Ke(),st("img",{key:1,src:n.image,alt:n.title+" screenshot",class:"mb-6"},null,8,n0)):Gn("",!0),Te("p",{innerHTML:n.description,class:"mb-6"},null,8,i0)])])):Gn("",!0)]),_:1})],36)}const a0=nn(Yy,[["render",r0]]),o0=[{name:"WNYC App",vimeo:"https://player.vimeo.com/video/954865796?h=4f21ecaf93&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1717000096/kimlarocca/portfolio/WNYC-App-Thumbnail_tveknp.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1716999879/kimlarocca/portfolio/WNYC-App_vmfbs4.jpg",category:"media",description:"Kim led the NY Public Radio digital team in building a cutting edge app for WNYC using Vue, Nuxt, Capacitor and Supabase. WNYC 93.9 FM and AM 820 are New York's flagship public radio stations, broadcasting the finest programs from NPR, American Public Media, Public Radio Exchange and the BBC World Service, as well as a wide range of award-winning local programming. Learn more or download the app at <a href='https://www.wnyc.org/mobile/' target='_blank'>https://www.wnyc.org/mobile/</a>!"},{name:"Equal Time",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1673032774/kimlarocca/portfolio/equal-time-thumbnail_fjtinh.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1673117201/kimlarocca/portfolio/Large_Zoom_Screenshot_zsdfag.jpg",category:"tech",description:"Equal Time's mission is to make meetings more inclusive and effective. Kim co-founded this startup and is the acting CTO. She drives all aspects of Engineering, Design and Product, building web apps with data visualization dashboards, chrome extensions and Zoom apps. In addition, she assists with fundraising and recruiting. The websites and Zoom App were built with a Vue frontend and Node.js backend, Supabase, and Azure for hosting and DevOps. Check out Equal Time online at <a href='https://www.equaltime.io/' target='_blank'>https://www.equaltime.io</a>!"},{name:"Black Lives Matter",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1637969272/kimlarocca/portfolio/showcase-blm_cover_gr810p.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1637969272/kimlarocca/portfolio/showcase-blm_of3vxq.jpg",category:"tech",description:"Kim volunteers with Black Lives Matter and creates websites pro bono for local chapters. Shown here is the website for the Morristown, NJ chapter. This project included the design, frontend development using Vue.js, CMS setup and integration using Storyblok, as well as DevOps with Media Temple and CircleCi."},{name:"Radiolab",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1673033543/kimlarocca/portfolio/radiolab-thumbnail_yiyiku.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1673033432/kimlarocca/portfolio/radolab_rvqqhj.jpg",category:"media",description:"Radiolab is a popular podcast that asks deep questions and uses investigative journalism to get the answers. Kim led the NY Public Radio digital team in the development of a new website for Radiolab, built with Nuxt 3, Vue 3, and Algolia for search. Check it out online at <a href='https://radiolab.org' target='_blank'>https://radiolab.org</a>!"},{name:"Gothamist",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1637971865/kimlarocca/portfolio/gothamist_dpchcq.png",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1673464356/kimlarocca/portfolio/gothamist_njzcjo.jpg",category:"media",description:"Kim led the NY Public Radio digital team in migrating the Gothamist website from Ember to Vue 3 & Nuxt 3 which resulted in 80% faster page speeds and a 45% increase in average session duration. Nuxt did a case study on this project! Check out the Gothamist website at <a href='https://gothamist.com' target='_blank'>https://gothamist.com</a>."},{name:"Cuetip",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1716913353/kimlarocca/portfolio/Cuetip_yuc0wo.jpg",vimeo:"https://player.vimeo.com/video/951177304?h=0bb4df2df4&amp;badge=0&amp;autopause=0&amp;player_id=0&amp;app_id=58479",category:"tech",description:"Cuetip is a Tech and Data provider of premium technology and services to the entire supply chain in the cannabis space. Kim is the acting CTO and leads all aspects of Engineering, Design and Product, building web apps with data visualization dashboards. The websites built with Vue/Nuxt, Supabase, and Digital Ocean for hosting and DevOps. Check out Cuetip online at <a href='https://www.cuetip.com/' target='_blank'>https://www.cuetip.com</a>!"},{name:'Toys"R"Us Product Engine',image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/tru_rapq1d.jpg",url:"https://www.kimlarocca.com/images/showcase-toys.jpg",category:"ecommerce",description:`The Toys"R"Us Product Engine was a responsive web application featuring dynamic filtering which had an 18.6% increase in conversion rate and did over 5.2MM in revenue, an increase of over 3MM from the previous year's landing page.`},{name:"San Francisco Symphony",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/sanfran_usdfzm.jpg",url:"https://www.kimlarocca.com/images/showcase-sanfran.jpg",category:"ecommerce",description:"The San Francisco Symphony project included frontend development using Vue.js to build out a complete component library as well as Algolia integration for their new, interactive events calendar."},{name:"WNYC Radio",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1637972133/kimlarocca/portfolio/wnyc_nks1yf.png",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1637969874/kimlarocca/portfolio/wnyc-showcase_fe7dbq.png",category:"media",description:"Kim led the NY Public Radio digital team in building a cutting edge online radio experience for WNYC using Vue & Nuxt. Nuxt did a case study on this project! Listen to WNYC online at <a href='https://wnyc.org/radio' target='_blank'>https://wnyc.org/radio</a>."},{name:'Babies"R"Us Happy Places',image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/bru_xxkcos.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1584736171/kimlarocca/portfolio/showcase-babies_bcvaor.jpg",category:"ecommerce",description:"Happy Places, a responsive e-commerce Micro-Destination, featured an interactive parallax experience with CSS animations, full screen image sliders, responsive tooltips and light boxes."},{name:"Wyndham Worldwide",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/wyndham_ar9ybf.jpg",url:"https://www.kimlarocca.com/images/showcase-wyndham.jpg",category:"tech",description:"Real-time data visualization app built with Vue and Firebase for Wyndham Worldwide's revenue management department. Features an interactive chart and filtering system."},{name:"Eleven Eleven",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/11xi_gownmg.jpg",url:"https://www.kimlarocca.com/images/showcase-elevenXi.jpg",category:"small-business",description:"Eleven Eleven is a lifestyle cannabis company located in Southern Oregon. Frontend web development using Vue.js featuring a custom marijuana filtering system."},{name:"Elpis Pharmaceuticals",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/elpis_fcz9r6.jpg",url:"https://www.kimlarocca.com/images/showcase-elpis.jpg",category:"healthcare",description:"Elpis Pharmaceuticals completely re-branded their business including logo design, web design and other printed materials. The website features an animated hero and was developed complete with a custom CMS. Devops were included in this project as well (AWS servers and continuous integration pipelines)."},{name:"VBrick",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/vbrick_gdtrau.jpg",url:"https://www.kimlarocca.com/images/showcase-vbrick.jpg",category:"tech",description:"Frontend and backend development for the new VBrick website. The new site was built with Wordpress and features custom react gutenberg components."},{name:'Toys"R"Us Great Deals Store',image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/tru2_l4sszw.jpg",url:"https://www.kimlarocca.com/images/showcase-toys-deals.jpg",category:"ecommerce",description:"This mobile friendly web store launched on the ToysRUs and BabiesRUs website on 10/9/15. It was powered by a custom web application built to improve cross functional efficiency that reduced the digital department headcount by 2 FTEs. In addition to internal time savings, the Great Deals Store generated over 30MM during the first few months it went live."},{name:"Luye Pharmaceuticals",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/luye_nzubri.jpg",url:"https://www.kimlarocca.com/images/showcase-luye.jpg",category:"healthcare",description:"The Luye Pharmaceuticals website features a cutting edge design to match its cutting edge technology, and the website was developed with a custom CMS. Devops were included in this project as well (AWS servers and continuous integration pipelines)."},{name:"TeamLogic IT",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/teamlogic_pluei0.jpg",url:"https://www.kimlarocca.com/images/showcase-teamlogic.jpg",category:"tech",description:"Frontend web development for the TeamLogic redesign. A complete component library was built with Vue, as well as custom, dynamic filtering systems for the careers and resources pages (also built with Vue)."},{name:"Real Estate",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/realestate_w768ko.jpg",url:"https://www.kimlarocca.com/images/showcase-realestate.jpg",category:"real-estate",description:"Responsive websites for realtors and brokers, with a custom CMS for managing website content, listings and photos. Dev ops were included in this project as all of the real estate websites are hosted and maintained as well."},{name:"S&A Solutions",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/sasolutions_iegjot.jpg",url:"https://www.kimlarocca.com/images/showcase-sa.jpg",category:"small-business",description:"S&A Solutions' website fully automates its staffing business. Built using Laravel and mysql, job seekers can search for and apply for jobs. Employers can log in, post jobs, and view applicants. S&A staff members can manage all aspects of the site including job seekers, employers, and users as well as generate reports. Devops were included in this project as well (AWS servers and continuous integration pipelines)."},{name:"Slate It",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/slateit_qqnqif.jpg",url:"https://www.kimlarocca.com/images/showcase-slateit.jpg",category:"ecommerce",description:"Web-based software for gyms, fitness centers & dance studios custom built using PHP, mySQL and the PayPal API. Devops were included in this project as well (MediaTemple servers)."},{name:"Vasculogic",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736146/kimlarocca/portfolio/vasculogic_ryfds8.jpg",url:"https://www.kimlarocca.com/images/showcase-vasculogic.jpg",category:"healthcare",description:"Responsive website featuring moving geometric backgrounds, full-width video backgrounds, and a mobile-friendly multi-level push menu. Logo and other presentation materials were designed as well. Devops were included in this project (MediaTemple servers)."},{name:"Abbvie iOS App",image:"https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584736145/kimlarocca/portfolio/abbvie_er6c4p.jpg",url:"https://www.kimlarocca.com/images/showcase-abbvie.jpg",category:"healthcare",description:"iPad app for Abbvie Oncology. Displays drug information, clinical trials and videos so pharmaceutical sales reps have all the information they need when meeting with doctors."},{name:"Purdue University",image:"https://res.cloudinary.com/kimlarocca/image/upload/v1639847634/kimlarocca/portfolio/purdue_wwvvzh.jpg",url:"https://res.cloudinary.com/kimlarocca/image/upload/v1639847637/kimlarocca/portfolio/purdue-showcase_w5sjnk.png",category:"education",description:"Frontend development for Purdue University's online recruitment website, which was integrated with their Sitecore backend and CMS."}],s0={data(){return{portfolioItems:o0}}},l0={id:"work"},c0=Te("div",{class:"container black py-4 lg:py-8"},[Te("h2",{class:"mb-4 lg:mb-6"}," From thousand dollar websites to billion dollar websites, I've got you covered. ")],-1),u0={class:"portfolio"};function h0(e,t,n,i,r,a){const o=a0;return Ke(),st("section",l0,[c0,Te("div",u0,[(Ke(!0),st(Dr,null,Uu(r.portfolioItems,(s,l)=>(Ke(),ho(o,{key:l,backgroundImage:s.image,image:s.url,title:s.name,description:s.description,vimeo:s.vimeo},null,8,["backgroundImage","image","title","description","vimeo"]))),128))])])}const f0=nn(s0,[["render",h0]]);const d0={},p0={id:"who"},m0=Ko('<div class="dark-gray-bg white diagonal"><div class="container py-4 lg:py-8"><h2 class="white mb-7">Professional since 1999.</h2><div class="grid"><div class="col col-12 lg:col-5 mb-4"><figure><img src="https://res.cloudinary.com/kimlarocca/image/upload/f_auto/v1584805653/kimlarocca/portfolio/kim_nuoagb.jpg" alt="photo of kim playing bass guitar and singing"><figcaption>let&#39;s rock</figcaption></figure></div><div class="col col-12 lg:col-7 mb-4"><p class="mb-4"> I have been designing websites since my first geocities page back in the 1990s! It may or may not have been dedicated to Final Fantasy VII... but now I&#39;ve dated myself. </p><p class="mb-4"> I hold a Computer Science degree from Rutgers University as well as a degree in Italian. My first paying client was in 1999, and I still do work for her to this day. Since then, I&#39;ve worked on high profile websites for clients such as Intel, Pfizer, NBC, Merck, IBM, Bausch + Lomb, Novartis, AstraZeneca, Celgene, Visa, Intuitive Surgical, Roche, Toys&quot;R&quot;Us / Babies&quot;R&quot;Us, FAO Schwartz, Wharton, WQXR, WNYC, The Gothamist and more. </p><p class="mb-4"> When not working, you can find me rocking out with my cover band, playing dodgeball, reading crappy fantasy novels, or playing minecraft with my kids. </p><div class="text-center lg:text-left"><a class="button" target="_blank" rel="noopener noreferrer" href="https://www.linkedin.com/in/kimlarocca/"> view resume on linkedin </a></div></div></div></div></div>',1),v0=[m0];function g0(e,t){return Ke(),st("section",p0,v0)}const y0=nn(d0,[["render",g0]]);const x0={},_0={id:"reviews"},w0=Ko('<article><div class="bubble"> I have had the pleasure of working with Kim for the last year and a half. She is a perfectionist that will only deliver her best every time. As an SEO Content Manager I have worked closely with Kim on several projects. From implementing video on the site to optimizing Mobile to be responsive she is always there with efficient, streamlined solutions. Thinking out of the box is her specialty. I&#39;m grateful to have worked with her at ToysRUs as Kim would be a tremendous asset to any team! <small>- Toni Balaguer, SEO &amp; Content Manager</small></div><div class="bubble"> This is a killer website! I love it. Great job! <small>- Gail Doscher, client</small></div><div class="bubble"> Working with Kim made my time at New York Public Radio infinitely better! From introducing us to Vue.js so we could modernize our stack, taking the time to answer any technical questions or give advice on how to best write computed methods, she was always available without judgement. Kim also helped me a lot with building out my outside of work Vue projects when she didn&#39;t have to. Besides being an expert developer, she was also just a really fun and amazing person to work with and the team is better with her on her it. <small>- Seori Sachs, Developer</small></div><div class="bubble"> Thanks so much for your help with this. As always -- YOU&#39;RE AWESOME!!! <small>- Arlene Glasco, client</small></div><div class="bubble"> Kim is an absolute pleasure to work for. She is always on top of every project that everyone is working on, and I know if I ask her a question Ill get an answer. She is a great project manager not only in that she makes sure every project gets done as efficiently and as well as possible, but also that the people doing the projects are working on things that they enjoy doing! She&#39;s always pushing us to do our best and helping us move forward in our careers and in our skill levels. Kim is a great boss - probably my favorite boss I&#39;ve ever had :) <small>- Mariam Garibov, Developer</small></div><div class="bubble"> I&#39;ve worked closely with Kim on a daily basis on two projects so far - the WNYC.org/radio player redesign and re-platform, and on the Gothamist.com re-platform. She was the lead engineer and direct manager for at least one other team member also contributing to these efforts, and I was the project manager. <br><br> When Kim first arrived, she was faced right away with some management and collaboration challenges she needed to address. I saw her carefully gather data to address these concerns tactfully and honestly, first searching for data to back up the discussion points she was working on. I also saw her observe quietly the early retrospective meetings so she could get an accurate understanding of other peoples&#39; current struggles and triumphs. She&#39;s been very fair, and she&#39;s still good at deferring to other opinions when needed, allowing others the space to speak to new areas of responsibility and deepen their expertise. <br><br> Kim often provides vocal support for accessibility considerations on our web platforms; most recently, she was able to ensure all pages on the Gothamist site are navigable by screen readers. She&#39;s obsessed (in a positive and necessary way!) with optimizing the page speed and load times of Gothamist.com, and recently suggested we do research with our advertising partner to asynchronously advertisements there and save on our page speed indexes. Given a goal metric, Kim is dogged about pushing for it in every way she can think of. <br><br> Kim works with Product managers frequently to break down the implementation steps needed for features Product wants, and is good at speaking to the time and effort also needed to make an idea into reality. She&#39;s also very generous with her time for more junior engineers and interns who want to contribute to the Digital team&#39;s work. Moreover, she knows when it makes more sense to take a back seat and listen during discussions of systems she&#39;s less familiar with, which is a time saver and frequently makes my job much easier. <br><br> Kim is great at follow through and leads by example for team members. I think over the course of her work replatforming Gothamist.com to the Vue front end framework, I had upwards of 5 behavior fixes and very specific, complicated modifications to Home page behavior. She was polite and patient, even when I had to come back with more feedback about something she had just thought she finished. She asked good questions to clarify what I expected, and her determination to get it right paid off! <br><br> Since her arrival at NYPR, Kim&#39;s been able to pitch in on a variety of platforms, sites, and systems. She always has a can-do attitude, which is invaluable in situations where morale is tenuous (including the global pandemic we&#39;re all still navigating.) I&#39;m excited to see what ideas she has for our upcoming projects, and I&#39;m looking forward to continuing to work with her as we create a long-term vision for NYPR Digital! <small>- Hannah Warren, scrum master</small></div><div class="bubble"> Kim built a tool for the Great Deals Stores that is easy to use and has been an important asset to our team. Simply put, it is awesome! The Great Deals store is important for our company to showcase our best digital promotions for ToysRUs and BabiesRUs. Creating these stores were very time consuming until this new tool. We are now able to copy all our deals into spreadsheets that can easily be loaded into the system. We can generate test links that look exactly like the deal stores, and can manipulate the dates to see time specific deals fall in and out of the store  a feature that is very necessary for tracking our deals during season. The GDS tool has been great for our team, has prevented us from waking up at 6am every morning to check the deals and has fostered trust in our team that the stores will go live every week. <small>- David Falk, Manager, Digital Brand Marketing and Strategy</small></div><div class="bubble"> I reported to Kim during my time at iMedia Inc as a front-end developer. Prior to Kim joining, the front end team lacked structure and process, each developer using different tools to get the job done without receiving full requirements. Within a few weeks Kim won over everyone on the team and got us on track with a consistent process and framework in Vue.js. Even as a new hire she was not afraid to break the status quo and held developers as well as project managers accountable for following the process and ensuring work was broken up into consumable pieces. She led by example and wrote initial components, made an effort to check in daily, and offered code reviews at any time. Kim made our team feel confident in our work and our ability to deliver, increasing our productivity while lowering the stress level. It was a pleasure working with Kim, she is a true leader and would be an asset on any team! <small>- Mike Cammarato, Developer</small></div><div class="bubble"> I recently had a had glitch with my e-mail program and quite a few messages were lost. How fortunate I am to have the On-Line Lead Manager database, otherwise all those leads would have been permanently lost. I am grateful that my web site is hosted with Kim. <small>- Agi Anderson, client</small></div><div class="bubble"> Thanks for everything. I look forward to referring you lots and lots of business--your work is AWESOME! <small>- Carolyn MacEvoy, client</small></div><div class="bubble"> I am delighted with everything you have done. The Architectural Tours turned out great, in fact, the entire website is excellent. I am very pleased with it. <small>- Jan Hexamer-Gardner, client</small></div><div class="bubble"> The site is absolutely wonderful and has gone beyond my hopes. Thank you so much. With out you guys I would not be doing the business I am doing. It is worth every penny I paid for the site and some. You are so helpful ... Kim you have a great career ahead of you if you treat every customer the way you treat me. <small>- Jeff Fulgham, client</small></div><div class="bubble"> It didnt take long to see that Kim is one of those leaders that makes a meaningful and long lasting impact not only on the team she leads but on any project she works on. She is very knowledgeable and resourceful but what sets her apart from anyone else Ive worked with is her ability to lead by example, encourage and motivate her team to take any task at hand and use it to learn and improve their skill sets. The impression she leaves is that she is reliable and a valuable asset to any team or project she is involved with. <small>- Andres Arias, developer</small></div><div class="bubble"> WOW!!! You&#39;re the Super Best!!! Thank you so much for putting it together so quickly. If I had a winning race horse, I would name her KIM! <small>- Julia Meadows, client</small></div><div class="bubble"> Youre awesome  thank you for always being available!!! You are always so wonderful and helpful!!! <small>- Julie &amp; Ted Hummel, clients</small></div><div class="bubble"> You rarely come across standout talent like Kim. I have worked closely with Kim during her time at iMedia as Lead Web Developer. She came to the front end team where there wasnt any structure or process in place. With a couple of weeks, she quickly changed that around and had everyone follow a method for each project moving forward. She had helped complete projects on a timely matter and keeping the stress levels low. She also knowledgable and closely follows the new trends in the web development world. Apart from all the projects she works on, she held weekly lunch &amp; learn to show anyone interested in learning about VueJS. The best thing about Kim is her relaxed attitude and sense of humor coming to work a pleasure. She the best manager I ever had, and anyone who works with her is lucky. <small>- Luis Almonte, developer</small></div><div class="bubble"> As usual you are the best!!! I&#39;m very happy with my site, a lot of nice complements, thanks to you. <small>- Lenise Lowry, client</small></div><div class="bubble"> I will be delighted to give you an outstanding reference. The fact that you can maintain your patience and professionalism speaks well for you. I wont go into details while I expound on the variety of services you offer, your consistency and your dedication to support your client needs. <small>- Lucille Maddalena, client</small></div><div class="bubble"> I reported to Kim when we worked at iMedia. She is a rockstar in every sense of the word. Ive never worked with someone with a broader range of skills and abilities. Kim stays up to date with the very latest developer tools and trends; she shares her expertise with her teams and applies it to meeting and exceeding her clients expectations. Her confidence and her sense of humor are contagious and most welcome. <small>- Tom Hackett, digital production coordinator</small></div><div class="bubble"> I LOVE MY WEBSITE! You are so creative! Thank you for helping me. I&#39;m so glad I found your company. <small>- Nicole Perry, client</small></div><div class="bubble"> Exuberant, supportive and motivating. Those are the words that I would use to describe Kim and her role at W2O Group, where I have reported to her for over 2 years. <br><br> I&#39;ve watched Kim define her role as Senior Director of Development and give that title true meaning. I&#39;ve been privileged to witness her taking the time to instruct junior members on language constructs, code quality, navigating the workplace or any of a myriad other tasks, all of which she does with patience and grace, never too busy to help someone out. She has also proven herself adept and willing to jump on any task and get &#39;elbow deep&#39; into whatever project needs to get done, regardless of the time frame or effort involved. Often times, this willingness means coding herself, facilitating others or simply providing moral support. She has also proven an adept and capable manager, fighting for her team as a whole or individuals in particular, with conviction and the knowledge to defend them admirably. <br><br> Aside from her coding and managerial skills, Kim brings a cohesiveness and humanity to the office which is welcome and very much appreciated. She is always first with a smile and greeting and eager to generate camaraderie and promote team building during and after hours. <br><br> I&#39;m more than happy to recommend Kim, for any position and would consider it a pleasure to be able to work with her, in any capacity. <small>- Troy Larssen, Associate Director of Development</small></div><div class="bubble"> Thank you, thank you. By the way, the site looks great and the control panel looks pretty user friendly. <small>- Patty Johnson, client</small></div><div class="bubble"> Kim is an exemplary employee who is extremely dependable and hard working. She is a go- getter who will always get the job done on task and on-time. <small>- Katherine Jaucian, Digital Consultant</small></div><div class="bubble"> Kim has established an outstanding web design company with quite a large client base because of three major principles: 1) A thorough understanding of the industry sectors she designs for. 2) The creation of dynamic database driven sites, which allow for a rich user experience. 3) Real-time client help. <small>- Tim Maguire, Director of Corporate Development</small></div><div class="bubble"> This site is very user friendly and easy to navigate. I am very impressed. I love the quick turnaround. <small>- Rosalyn Blaylock, client</small></div><div class="bubble"> It [the website] looks great, thank you so much for your help, and how quick you respond to me!!! <small>- Ryan Bittinger, client</small></div><div class="bubble"> Good evening, Tony. I&#39;ve been meaning to take a moment to write you a letter. I&#39;m glad to say that I&#39;ve been busy and that is why I haven&#39;t sent this sooner. Kim LaRocca - - is absolutely INCREDIBLE!!! I couldn&#39;t be more pleased with the service I have received thus far. She has taken care of everything. I am amazed - there is not a time that I send her an e-mail that I do not receive an immediate, kind and informative response. Even in the evening! Does she not take time off??? Kudos - - - Also, I am very excited about my new website. I love the look and the feel of it. I didn&#39;t realize how boring the look of my other site was. That powder blue and beige... just let me say, the impact of my new site will no doubt grab more attention. I&#39;ll say it for you, &quot;you told me so&quot; - I should have switched months ago before it became an emergency situation. <small>- Sidney L. Walker, client</small></div><div class="bubble"> You&#39;re good, quick, and excellent! Thanks for your quick service! I&#39;ve had many complements on my site. I really like this so much more than Informedia. The picture slide show on the listings is really impressive. I am getting plenty of inquiries lately. Thanks again! <small>- Steve Mayo, client</small></div><div class="bubble"> Having worked in the consulting and project management fields I was expecting my transition into a traditional development role to be a very challenging process. Thanks to Kim, my move into software development was anything but difficult. As Director of Development for my team at W2O, Kim not only encouraged me but empowered me to really grow and sharpen my skills as a developer. Whether it was taking time to personally review my code and suggest how it can be improved, providing lunch and learns on how to use developer tools efficiently or encouraging our team to get certifications and be our tutor for them, Kim has always been there to push us to do our best. <br><br> Yet, it&#39;s not just development that Kim has helped me grow in. Having a background in project management and business development, Kim encouraged me to really look at my strengths beyond development and find a way to use them to bring value to the team. Kim has always been open to hearing out my ideas on how to better communicate and improve processes between different teams and then work various groups to execute them. In this way, Kim asks me to look beyond just my code to improve a project and grow beyond just being a good software engineer. <br><br> Simply put, if you are looking for someone who is more than just a great developer, but a great evangelist and leader, look no further than Kim Larocca. She is the person you can count on to lead, motivate, and make sure that your team not only makes it to the finish line of any technical project but truly grow on the way there. <small>- Geroge Ulloa, Developer</small></div><div class="bubble"> THE WEB SITE LOOKS AWESOME! In case I haven&#39;t told you... thanks for all your hard work! <small>- Trey Pierson, client</small></div><div class="bubble"> Kim: Thank you for all your help on this. If all were like you life would be a lot more enjoyable. <small>- Ron Teixeria, client</small></div><div class="bubble"> The tool Kim built to manage the Great Deals Stores has made my job much easier. I no longer have to manually process excel files, create test links to send out to other teams (they are now generated on the fly), and it automatically checks everything to make sure it will validate in our CMS. This has been a huge time saver for me! <small>- Vijay Soppa, Web Development Team / GDS Manager</small></div><div class="bubble"> I have closely worked with Kim for the last three years and have seen her deliver day in and day out. Kim has an affinity for solving business problems and pushing the boundaries on every project that she is assigned to. Kim was our Sr. Developer where she diligently managed and developed all of the modular and object-oriented frameworks utilized by the rest of the team. Kim&#39;s raw talent in development has allowed her to be the best developer of the team where she constantly perfected her craft. Simply put, Kim was my go-to-developer for many of the larger Toys&quot;R&quot; Us initiatives that needed to be developed in a time crunch. <br><br>The 2016 Big Book Toy Finder, for example, came down to the wire and it was only possible because of Kim&#39;s development efforts. Her tenacious mindset towards the project ensured that it launched on time while wearing many hats from the backend tool that ingested the data, to the front-end code that powered the web application. This experience generated more than 5.2M which surpassed everyone&#39;s expectations. <br><br> There are many great things I can say about Kim and her impeccable work ethic. She is a hard worker, team player, team builder, knowledgeable and overall a well-rounded developer. I highly recommend Kim as she is a rockstar!!! <small>- Jose Gonzalez, Sr. UX Designer</small></div></article>',1);function b0(e,t){const n=nc;return Ke(),st("div",_0,[w0,vt(n,{size:"100px"})])}const M0=nn(x0,[["render",b0]]),S0=[{name:"abbvie",url:"https://www.kimlarocca.com/images/logos/abbvie.jpg",category:"healthcare"},{name:"alcresta",url:"https://www.kimlarocca.com/images/logos/alcresta.jpg",category:"healthcare"},{name:"astrazeneca",url:"https://www.kimlarocca.com/images/logos/astrazeneca.jpg",category:"healthcare"},{name:"aventis",url:"https://www.kimlarocca.com/images/logos/aventis.jpg",category:"healthcare"},{name:"babies r us",url:"https://www.kimlarocca.com/images/logos/babies.jpg",category:"ecommerce"},{name:"bausch",url:"https://www.kimlarocca.com/images/logos/bausch.jpg",category:"healthcare"},{name:"bayer",url:"https://www.kimlarocca.com/images/logos/bayer.jpg",category:"healthcare"},{name:"blackthorn",url:"https://www.kimlarocca.com/images/logos/blackthorn.jpg",category:"healthcare"},{name:"bluebird",url:"https://www.kimlarocca.com/images/logos/bluebird.jpg",category:"healthcare"},{name:"celgene",url:"https://www.kimlarocca.com/images/logos/celgene.jpg",category:"healthcare"},{name:"dendreon",url:"https://www.kimlarocca.com/images/logos/dendreon.jpg",category:"healthcare"},{name:"dermira",url:"https://www.kimlarocca.com/images/logos/dermira.jpg",category:"healthcare"},{name:"easterseals",url:"https://www.kimlarocca.com/images/logos/easterseals.jpg",category:"healthcare"},{name:"elpis",url:"https://www.kimlarocca.com/images/logos/elpis.jpg",category:"healthcare"},{name:"emd",url:"https://www.kimlarocca.com/images/logos/emd.jpg",category:"healthcare"},{name:"fao",url:"https://www.kimlarocca.com/images/logos/fao.jpg",category:"ecommerce"},{name:"gothamist",url:"https://www.kimlarocca.com/images/logos/gothamist.png",category:"media"},{name:"ibm",url:"https://www.kimlarocca.com/images/logos/ibm.jpg",category:"tech"},{name:"incyte",url:"https://www.kimlarocca.com/images/logos/incyte.jpg",category:"healthcare"},{name:"intel",url:"https://www.kimlarocca.com/images/logos/intel.jpg",category:"tech"},{name:"intercept",url:"https://www.kimlarocca.com/images/logos/intercept.jpg",category:"healthcare"},{name:"intuitive",url:"https://www.kimlarocca.com/images/logos/intuitive.jpg",category:"healthcare"},{name:"ipsen",url:"https://www.kimlarocca.com/images/logos/ipsen.jpg",category:"healthcare"},{name:"kaplan",url:"https://www.kimlarocca.com/images/logos/kaplan.png",category:"education"},{name:"kowa",url:"https://www.kimlarocca.com/images/logos/kowa.jpg",category:"healthcare"},{name:"lupin",url:"https://www.kimlarocca.com/images/logos/lupin.jpg",category:"healthcare"},{name:"luye",url:"https://www.kimlarocca.com/images/logos/luye.jpg",category:"healthcare"},{name:"mentoring method",url:"https://www.kimlarocca.com/images/logos/mentoring-method.jpg",category:"education"},{name:"merck",url:"https://www.kimlarocca.com/images/logos/merck.jpg",category:"healthcare"},{name:"nbc",url:"https://www.kimlarocca.com/images/logos/nbc.png",category:"media"},{name:"new sounds",url:"https://www.kimlarocca.com/images/logos/new-sounds.png",category:"media"},{name:"nj public radio",url:"https://www.kimlarocca.com/images/logos/NJPR.png",category:"media"},{name:"novartis",url:"https://www.kimlarocca.com/images/logos/novartis.jpg",category:"healthcare"},{name:"npc",url:"https://www.kimlarocca.com/images/logos/npc.jpg",category:"healthcare"},{name:"ny public radio",url:"https://www.kimlarocca.com/images/logos/NYPR.png",category:"media"},{name:"purdue",url:"https://www.kimlarocca.com/images/logos/purdue.png",category:"education"},{name:"pfizer",url:"https://www.kimlarocca.com/images/logos/pfizer.jpg",category:"healthcare"},{name:"profusa",url:"https://www.kimlarocca.com/images/logos/profusa.jpg",category:"healthcare"},{name:"radiolab",url:"https://www.kimlarocca.com/images/logos/radiolab.png",category:"media"},{name:"rhythm",url:"https://www.kimlarocca.com/images/logos/rhythm.jpg",category:"healthcare"},{name:"roche",url:"https://www.kimlarocca.com/images/logos/roche.jpg",category:"healthcare"},{name:"rutgers",url:"https://www.kimlarocca.com/images/logos/rutgers.png",category:"education"},{name:"sanofi",url:"https://www.kimlarocca.com/images/logos/sanofi.jpg",category:"healthcare"},{name:"schering",url:"https://www.kimlarocca.com/images/logos/shcering.png",category:"healthcare"},{name:"siemens",url:"https://www.kimlarocca.com/images/logos/siemens.png",category:"tech"},{name:"slate it",url:"https://www.kimlarocca.com/images/logos/slateit.png",category:"ecommerce"},{name:"toys r us",url:"https://www.kimlarocca.com/images/logos/toys.png",category:"ecommerce"},{name:"visa",url:"https://www.kimlarocca.com/images/logos/visa.jpg",category:"ecommerce"},{name:"wharton",url:"https://www.kimlarocca.com/images/logos/wharton.jpg",category:"education"},{name:"wnyc",url:"https://www.kimlarocca.com/images/logos/wnyc.png",category:"media"},{name:"wqxr",url:"https://www.kimlarocca.com/images/logos/wqxr.png",category:"media"}];const E0={data(){return{logos:S0,logoCategory:"",showReviews:!1}},methods:{setCategory(e){e===this.logoCategory?this.logoCategory="":(this.logoCategory="",this.$nextTick(()=>{this.logoCategory=e}))}},computed:{filteredLogos(){return this.logoCategory===""?[]:this.logoCategory==="all"?this.logos:this.logos.filter(e=>e.category.toLowerCase().includes(this.logoCategory.toLowerCase()))}}},T0={id:"why"},A0={class:"container py-4 lg:py-8"},L0=Te("h2",{class:"mb-6"},"Why Me?",-1),C0=Te("h3",{class:"mb-4"},"Companies that have trusted me:",-1),R0={class:"mb-6"},P0={key:0,class:"grid logos"},I0=["src","alt"],D0=Te("h3",{class:"mb-4"},"Reviews:",-1),O0={class:"grid testimonials mb-4"},N0={class:"col col-12 lg:col-6 mb-4"},F0={class:"col col-12 lg:col-6 mb-4"},B0={class:"text-center"},k0=Te("a",{class:"button mx-3",href:"https://managerreadme.com/readme/kimlarocca",target:"_blank",rel:"noopener noreferrer"}," Manager Readme ",-1),z0={class:"bs_padding0"},U0={class:"container"};function G0(e,t,n,i,r,a){const o=zh,s=nc,l=M0;return Ke(),st("div",T0,[Te("section",null,[Te("div",A0,[L0,C0,Te("div",R0,[Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="all"}]),tabindex:"0",onClick:t[0]||(t[0]=c=>a.setCategory("all")),onKeypress:[t[1]||(t[1]=pt(c=>a.setCategory("all"),["enter"])),t[2]||(t[2]=pt(Qt(c=>a.setCategory("all"),["prevent"]),["space"]))]}," all ",34),Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="healthcare"}]),tabindex:"0",onClick:t[3]||(t[3]=c=>a.setCategory("healthcare")),onKeypress:[t[4]||(t[4]=pt(c=>a.setCategory("healthcare"),["enter"])),t[5]||(t[5]=pt(Qt(c=>a.setCategory("healthcare"),["prevent"]),["space"]))]},"healthcare",34),Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="ecommerce"}]),tabindex:"0",onClick:t[6]||(t[6]=c=>a.setCategory("ecommerce")),onKeypress:[t[7]||(t[7]=pt(c=>a.setCategory("ecommerce"),["enter"])),t[8]||(t[8]=pt(Qt(c=>a.setCategory("ecommerce"),["prevent"]),["space"]))]},"ecommerce",34),Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="tech"}]),tabindex:"0",onClick:t[9]||(t[9]=c=>a.setCategory("tech")),onKeypress:[t[10]||(t[10]=pt(c=>a.setCategory("tech"),["enter"])),t[11]||(t[11]=pt(Qt(c=>a.setCategory("tech"),["prevent"]),["space"]))]},"tech",34),Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="media"}]),tabindex:"0",onClick:t[12]||(t[12]=c=>a.setCategory("media")),onKeypress:[t[13]||(t[13]=pt(c=>a.setCategory("media"),["enter"])),t[14]||(t[14]=pt(Qt(c=>a.setCategory("media"),["prevent"]),["space"]))]},"media",34),Te("a",{class:kn(["button category bs_margin20 bs_marginRight1",{active:r.logoCategory==="education"}]),tabindex:"0",onClick:t[15]||(t[15]=c=>a.setCategory("education")),onKeypress:[t[16]||(t[16]=pt(c=>a.setCategory("education"),["enter"])),t[17]||(t[17]=pt(Qt(c=>a.setCategory("education"),["prevent"]),["space"]))]},"education",34)]),vt(ks,{name:"slide-fade"},{default:uo(()=>[r.logoCategory?(Ke(),st("div",P0,[(Ke(!0),st(Dr,null,Uu(a.filteredLogos,(c,u)=>(Ke(),st("div",{key:u,class:"col logo"},[Te("img",{src:c.url,alt:c.name+" logo"},null,8,I0)]))),128))])):Gn("",!0)]),_:1}),D0,Te("div",O0,[Te("div",N0,[vt(o,{class:"mb-4",title:"nate landau, cdo",description:"'Kim's sunny personality and good humor show through in all her interactions within and without the digital team. While she has only worked here for a few months, she has already made herself an indispensible team member who explains the way, leads by example, and listens to all voices.<br><br>Kim is a not only a great manager, but a fantastic engineer as well. In her brief time at NYPR, she has completed a significant amount of work that has meaningfully moved the ball forward for our projects and code bases. She sets an example of speed and precision with her work.'"})]),Te("div",F0,[vt(o,{class:"mb-4",title:"george ulloa, dev",description:`'As Director of Development for my team at W2O, Kim
                  not only encouraged me but empowered me to really grow and sharpen my skills as a
                  developer.<br><br>Simply put, if you are looking for someone who is more than just a great
                  developer, but a great evangelist and leader, look no further
                  than Kim LaRocca. She is the person you can count on to lead, motivate, and make sure
                  that your team not only makes it to the finish line of any technical project but truly grow
                  on the way there.'`})])]),Te("div",B0,[k0,Te("a",{class:"button mx-3",tabindex:"0",onClick:t[18]||(t[18]=c=>r.showReviews=!r.showReviews),onKeypress:[t[19]||(t[19]=pt(c=>r.showReviews=!r.showReviews,["enter"])),t[20]||(t[20]=pt(Qt(c=>r.showReviews=!r.showReviews,["prevent"]),["space"]))]},[r.showReviews?(Ke(),st(Dr,{key:1},[rc("hide reviews")],64)):(Ke(),st(Dr,{key:0},[rc("more reviews")],64))],32)]),r.showReviews?Gn("",!0):(Ke(),ho(s,{key:0,size:"100px"}))])]),Te("section",z0,[Te("div",U0,[vt(ks,{name:"slide-fade"},{default:uo(()=>[r.showReviews?(Ke(),ho(l,{key:0})):Gn("",!0)]),_:1})])])])}const V0=nn(E0,[["render",G0]]);const H0={mounted(){var e=document.getElementById("canvas"),t=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight;var n=[],i=30,r=function(){this.x=e.width*Math.random(),this.y=e.height*Math.random(),this.vx=-1,this.vy=Math.random()};r.prototype.Draw=function(s){s.beginPath(),s.fillStyle="rgba(255,255,255,0.15)",s.arc(this.x,this.y,3,0,3*Math.PI),s.fill()},r.prototype.Update=function(){this.x+=this.vx,this.y+=this.vy,this.x<0&&(this.x=e.width),(this.y<0||this.y>e.height)&&(this.vy=-this.vy)};function a(){t.clearRect(0,0,e.width,e.height);for(var s=0;s<i;s++)n[s].Update(),n[s].Draw(t);requestAnimationFrame(a)}for(var o=0;o<i;o++)n.push(new r);a()}},W0=Ko('<div class="container"><h2 class="mb-4">Contact Me</h2><div class="icon"><a href="mailto:kim@4siteusa.com" aria-label="email link"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><title>email</title><path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM8 8h16c0.286 0 0.563 0.061 0.817 0.177l-8.817 10.286-8.817-10.287c0.254-0.116 0.531-0.177 0.817-0.177zM6 22v-12c0-0.042 0.002-0.084 0.004-0.125l5.864 6.842-5.8 5.8c-0.045-0.167-0.069-0.34-0.069-0.517zM24 24h-16c-0.177 0-0.35-0.024-0.517-0.069l5.691-5.691 2.826 3.297 2.826-3.297 5.691 5.691c-0.167 0.045-0.34 0.069-0.517 0.069zM26 22c0 0.177-0.024 0.35-0.069 0.517l-5.8-5.8 5.865-6.842c0.003 0.041 0.004 0.083 0.004 0.125v12z"></path></svg></a></div><div class="icon"><a href="https://www.linkedin.com/in/kimlarocca/" rel="noopener noreferrer" target="_blank" aria-label="linkedin link"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><title>linkedin</title><path d="M29 0h-26c-1.65 0-3 1.35-3 3v26c0 1.65 1.35 3 3 3h26c1.65 0 3-1.35 3-3v-26c0-1.65-1.35-3-3-3zM12 26h-4v-14h4v14zM10 10c-1.106 0-2-0.894-2-2s0.894-2 2-2c1.106 0 2 0.894 2 2s-0.894 2-2 2zM26 26h-4v-8c0-1.106-0.894-2-2-2s-2 0.894-2 2v8h-4v-14h4v2.481c0.825-1.131 2.087-2.481 3.5-2.481 2.488 0 4.5 2.238 4.5 5v9z"></path></svg></a></div><div class="icon"><a href="https://github.com/kimlarocca" rel="noopener noreferrer" target="_blank" aria-label="github link"><svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><title>github</title><path d="M16 0.395c-8.836 0-16 7.163-16 16 0 7.069 4.585 13.067 10.942 15.182 0.8 0.148 1.094-0.347 1.094-0.77 0-0.381-0.015-1.642-0.022-2.979-4.452 0.968-5.391-1.888-5.391-1.888-0.728-1.849-1.776-2.341-1.776-2.341-1.452-0.993 0.11-0.973 0.11-0.973 1.606 0.113 2.452 1.649 2.452 1.649 1.427 2.446 3.743 1.739 4.656 1.33 0.143-1.034 0.558-1.74 1.016-2.14-3.554-0.404-7.29-1.777-7.29-7.907 0-1.747 0.625-3.174 1.649-4.295-0.166-0.403-0.714-2.030 0.155-4.234 0 0 1.344-0.43 4.401 1.64 1.276-0.355 2.645-0.532 4.005-0.539 1.359 0.006 2.729 0.184 4.008 0.539 3.054-2.070 4.395-1.64 4.395-1.64 0.871 2.204 0.323 3.831 0.157 4.234 1.026 1.12 1.647 2.548 1.647 4.295 0 6.145-3.743 7.498-7.306 7.895 0.574 0.497 1.085 1.47 1.085 2.963 0 2.141-0.019 3.864-0.019 4.391 0 0.426 0.288 0.925 1.099 0.768 6.354-2.118 10.933-8.113 10.933-15.18 0-8.837-7.164-16-16-16z"></path></svg></a></div></div><canvas id="canvas"></canvas>',2),j0=[W0];function q0(e,t,n,i,r,a){return Ke(),st("footer",null,j0)}const X0=nn(H0,[["render",q0]]),Y0={};function Z0(e,t){const n=Ly,i=Wy,r=f0,a=y0,o=V0,s=X0;return Ke(),st(Dr,null,[vt(n),vt(i),vt(r),vt(a),vt(o),vt(s)],64)}const $0=nn(Y0,[["render",Z0]]);export{$0 as default};
